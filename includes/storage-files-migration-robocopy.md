---
title: インクルード ファイル
description: インクルード ファイル
services: storage
author: fauhse
ms.service: storage
ms.topic: include
ms.date: 4/05/2021
ms.author: fauhse
ms.custom: include file
ms.openlocfilehash: 8b425646e9b416129d951cc78db3d05c26b0e6e8
ms.sourcegitcommit: e8b229b3ef22068c5e7cd294785532e144b7a45a
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/04/2021
ms.locfileid: "123484913"
---
```console
robocopy /MT:128 /R:1 /W:1 /B /MIR /IT /COPY:DATSO /DCOPY:DAT /NP /NFL /NDL /UNILOG:<FilePathAndName> <SourcePath> <Dest.Path> 
```

| Switch                | 説明 |
|-----------------------|---------|
| `/MT:n`               | Robocopy をマルチスレッドを実行できるようにします。 `n` の既定値は 8 です。 スレッドの最大数は 128 です。 最初の実行では、スレッド数を多くしてください。 スレッド数を多くすると、利用可能な帯域幅が飽和しやすくなります。 後続 `/MIR` の実行は、使用可能なコンピューティングと使用可能なネットワーク帯域幅の影響を徐々に受けます。 後続の実行では、スレッド数の値をプロセッサのコア数およびコアあたりのスレッド数とより厳密に一致させます。 実稼働サーバーに存在する可能性のある他のタスク用にコアを予約する必要があるかどうかを検討してください。 |
| `/R:n`                | 最初の試行でコピーに失敗したファイルの最大再試行回数です。 ファイルのコピーが完全に失敗するまでの再試行の最大数 (`n`) を指定することにより、RoboCopy 実行の速度を向上させることができます。 このスイッチは、RoboCopy がさらに実行されることが既に明らかである場合に動作します。 現在の実行でファイルのコピーが失敗した場合は、次の RoboCopy ジョブで再試行されます。 この方法を使用すると、使用中でまたはタイムアウトの問題が原因で失敗したファイルが、最終的にコピーされる可能性があります。 |
| `/W:n`                | 前の試行時に正常にコピーされなかったファイルのコピーを試行する前に、RoboCopy が待機する時間を指定します。 `n` は再試行の間の待機時間 (秒数) です。 `/W:n` は、多くの場合、`/R:n` と共に使用されます。 |
| `/B`                  | バックアップ アプリケーションが使用するのと同じモードで Robocopy を実行します。 このスイッチを使用すると、現在のユーザーがアクセス許可を持っていないファイルを、Robocopy によって移動できます。 |
| `/MIR`                | (ソースをターゲットにミラーリング。) RoboCopy でソースとターゲット間の差分のみをコピーします。 空のサブディレクトリがコピーされます。 変更された、またはターゲットに存在しない項目 (ファイルまたはフォルダー) がコピーされます。 ターゲットに存在する一方でソースには存在しない項目は、ターゲットから消去 (削除) されます。 このスイッチを使用する場合は、ソースとターゲットのフォルダー構造を正確に一致させます。 "*一致*" とは、正しいソースおよびフォルダー レベルから、コピー先の一致するフォルダー レベルにコピーすることを意味します。 その場合にのみ、"キャッチ アップ" コピーを正常に実行することができます。 ソースとターゲットが一致しない場合に `/MIR` を使用すると、大規模な削除と再コピーが行われます。 |
| `/IT`                 | 特定のミラー シナリオで、忠実性が維持されることを保証します。 </br>たとえば、Robocopy を 2 回実行する間に、ファイルで ACL の変更と属性の更新があった場合、非表示とマークされます。 `/IT` を使用しない場合、ACL の変更が Robocopy で見逃されて、ターゲットの場所に転送されない可能性があります。 |
|`/COPY:[copyflags]`    | ファイル コピーの忠実性。 既定値:`/COPY:DAT`。 コピー フラグ: `D` = データ、`A` = 属性 `T` = タイムスタンプ、`S` = セキュリティ = NTFS ACL `O` = 所有者情報、`U`= <u></u>監査情報。 監査情報を Azure ファイル共有に格納することはできません。 |
| `/DCOPY:[copyflags]`  | ディレクトリのコピーの忠実性。 既定値:`/DCOPY:DA`。 コピーフラグ: `D` = データ `A` = 属性、`T` = タイムスタンプ。 |
| `/NP`                 | 各ファイルとフォルダーのコピーの進行状況を表示しないよう指定します。 進行状況を表示すると、コピーのパフォーマンスが大幅に低下します。 |
| `/NFL`                | ファイル名をログに記録しないことを指定します。 コピーのパフォーマンスを向上させます。 |
| `/NDL`                | ディレクトリ名をログに記録しないことを指定します。 コピーのパフォーマンスを向上させます。 |
| `/UNILOG:<file name>` | 状態を Unicode 形式でログ ファイルに書き込みます。 (既存のログを上書きします)。 |
| `/L`                  | **テスト実行の場合のみ** </br> ファイルは一覧表示されるだけです。 コピーも削除もされず、タイム スタンプも付きません。 コンソール出力には `/TEE` とよく使用されます。 テスト結果を適切に文書化するには、サンプル スクリプトのフラグ (`/NP`、`/NFL`、`/NDL` など) の削除が必要になる場合があります。 |
| `/LFSM`               | **階層型ストレージを持つターゲット専用** </br>RoboCopy を "低空き領域モード" で動作するよう指定します。 このスイッチは、Robocopy が完了する前にローカル容量が不足する可能性がある、階層型ストレージを持つターゲットにのみ有効です。 これは、Azure File Sync のクラウドの階層化が有効なターゲットで使用するために特別に追加されました。 これは、Azure File Sync とは別に使用できます。このモードでは、ファイルのコピーによって宛先ボリュームの空き領域が "床" 値よりも小さくなるたびに、Robocopy が一時停止します。 この値は `/LFSM:n` のフラグ形式で指定できます。 パラメーター `n` は、ベース 2: `nKB`、`nMB`、または`nGB` で指定します。 明示的な床値を示さずに `/LFSM` を指定した場合、床は宛先ボリュームのサイズの 10% に設定されます。 低空き領域モードは、`/MT`、`/EFSRAW`、`/B` または `/ZB` では利用できません。 |
| `/Z`                  | **慎重に使用すること** </br>再起動モードでファイルをコピーします。 このスイッチは、ネットワーク環境が不安定な場合にのみ、使用することをお勧めします。 追加のログ記録が原因で、コピーのパフォーマンスが大幅に低下します。 |
| `/ZB`                 | **慎重に使用すること** </br>再起動モードが使用されます。 アクセスが拒否された場合、このオプションではバックアップ モードが使用されます。 このオプションでは、チェックポイント処理が原因で、コピーのパフォーマンスが大幅に低下します。 |

> [!IMPORTANT]
> 少なくとも 2021 年 8 月 26 日の [OS 更新プログラム KB5005103](https://support.microsoft.com/topic/august-26-2021-kb5005103-os-build-18363-1766-preview-4e23362c-5e43-4d8f-95e5-9fdade60605f) を備えた Windows Server 2019 を使用します。 特定の RoboCopy シナリオに対する重要な修正プログラムが含まれています。
