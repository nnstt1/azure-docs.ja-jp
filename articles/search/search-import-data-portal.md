---
title: Azure portal を使用して検索インデックスにデータをインポートする
titleSuffix: Azure Cognitive Search
description: インデックスの作成と読み込みに使用される Azure portal のデータのインポート ウィザードについて説明します。また、自然言語処理、翻訳、OCR、画像分析のための組み込みのスキルを使用して、必要に応じて AI エンリッチメントを呼び出すこともできます。
author: HeidiSteen
manager: nitinme
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 10/06/2021
ms.openlocfilehash: 9fe443422bac06ccb934a34799bc29be29c45cb5
ms.sourcegitcommit: 860f6821bff59caefc71b50810949ceed1431510
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/09/2021
ms.locfileid: "129714674"
---
# <a name="import-data-wizard-in-azure-cognitive-search"></a>Azure Cognitive Search のデータのインポート ウィザード

Azure portal の **データのインポート ウィザード** で、検索サービスでのインデックス作成や AI エンリッチメントに使用される複数のオブジェクトを作成します。 Azure Cognitive Search を初めて使用する場合、お客様にとって自由に使える最も強力な機能の 1 つとなるでしょう。 Azure Cognitive Search のほとんどの機能を実行できる、インデックスや強化パイプラインを最小限の労力で作成できます。

概念実証のテストにウィザードを使用する際、これをより効果的に使用できるように、この記事ではウィザードの内部動作について説明します。

この記事では、ステップ バイ ステップでは説明しません。 組み込みのサンプル データでウィザードを使用する方法については、[検索インデックスの作成に関するクイックスタート](search-get-started-portal.md)または[テキスト翻訳とエンティティ スキルセットの作成に関するクイックスタート](cognitive-search-quickstart-blob.md)を参照してください。

## <a name="starting-the-wizard"></a>ウィザードの開始

[Azure portal](https://portal.azure.com) でダッシュボードから検索サービス ページを開くか、サービスの一覧で[ご自分のサービスを見つけ](https://ms.portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Search%2FsearchServices)ます。 上部にあるサービスの概要ページで、 **[データのインポート]** をクリックします。

   :::image type="content" source="media/search-import-data-portal/import-data-cmd.png" alt-text="[データのインポート] コマンドのスクリーンショット" border="true":::

ウィザードがブラウザー ウィンドウで完全に展開され、作業するための領域が増えます。 いくつかのページでは、内容がかなり詰まっています。

**[Import data (データのインポート)]** は、Azure Cosmos DB、Azure SQL Database、SQL Managed Instance、Azure Blob Storage を含む、他の Azure サービスから起動することもできます。 サービスの概要ページの左側にあるナビゲーション ウィンドウで、 **[Add Azure Cognitive Search]\(Azure Cognitive Search の追加\)** を見つけます。

## <a name="objects-created-by-the-wizard"></a>ウィザードで作成されるオブジェクト

次の表のオブジェクトが出力されます。 オブジェクトが作成されたら、ポータルで JSON 定義を確認したり、コードから呼び出したりすることができます。

| Object | 説明 | 
|--------|-------------|
| [Indexer](/rest/api/searchservice/create-indexer)  | データ ソース、ターゲット インデックス、オプションのスキルセット、オプションのスケジュール、およびエラー処理と Base-64 エンコード用のオプションの構成設定を指定する構成オブジェクトです。 |
| [データ ソース](/rest/api/searchservice/create-data-source)  | ソース データに対する接続情報を資格情報を含めて保持します。 データ ソース オブジェクトは、インデクサーでのみ使用されます。 | 
| [Index](/rest/api/searchservice/create-index) | フルテキスト検索やその他のクエリに使用される物理データ構造です。 | 
| [スキルセット](/rest/api/searchservice/create-skillset) | 省略可能。 画像ファイルからの情報の分析と抽出を含む、コンテンツの操作、変換、および整形を行うための手順の完全なセットです。 非常に単純で限定されている構造の場合を除き、エンリッチメントを提供する Cognitive Services リソースへの参照が含まれます。 | 
| [ナレッジ ストア](knowledge-store-concept-intro.md) | 省略可能。 [AI エンリッチメント パイプライン](cognitive-search-concept-intro.md)からの出力を、独立した分析またはダウンストリーム処理用に Azure Storage テーブルと BLOB に保存します。 |

## <a name="benefits-and-limitations"></a>特典と制限

コードを記述する前に、このウィザードをプロトタイプ作成と概念実証テストに使用できます。 ウィザードでは、外部データ ソースに接続し、データをサンプリングして初期インデックスを作成します。次に、データを JSON ドキュメントとして Azure Cognitive Search のインデックスにインポートします。 

スキルセットを評価する場合、ウィザードですべての出力フィールド マッピングを処理し、使用可能なオブジェクトを作成するヘルパー関数を追加します。 解析モードを指定すると、テキストの分割が追加されます。 ウィザードで画像コンテンツとテキストの説明を再結合できるように、画像分析を選択すると、テキストの結合が追加されます。 ナレッジ ストア オプションを選択した場合に有効なプロジェクションをサポートする Shaper スキルが追加されました。 上記のすべてのタスクには学習曲線が付きます。 エンリッチメントを初めて使用する場合は、これらの手順を処理させる機能により、時間と労力を費やすことなく、スキルの価値を測定できます。

サンプリングはインデックス スキーマを推論するプロセスであり、これには制限がいくつかあります。 データ ソースが作成されると、ウィザードによってドキュメントのサンプルがランダムに選択され、データ ソースの一部である列が決定されます。 非常に大規模なデータ ソースの場合はこの処理に時間がかかる可能性があるため、すべてのファイルが読み取られるわけではありません。 ドキュメントが選択されると、フィールド名や種類などのソース メタデータを使用して、インデックス スキーマにフィールド コレクションが作成されます。 ソース データの複雑さに応じて、正確さを求めて初期スキーマを編集したり、完全を期すために拡張したりすることが必要になる場合があります。 インデックスの定義のページで、変更をインラインで行うことができます。

概して、ウィザードを使用する利点は明らかです。要件が満たされていれば、数分以内にクエリ可能なインデックスのプロトタイプを作成できます。 JSON ドキュメントとしてのデータのシリアル化など、インデックス作成の複雑な処理の一部は、ウィザードによって行われます。

このウィザードには、制限がないわけではありません。 制約は次のとおりです。

+ このウィザードでは、イテレーションと再利用はサポートされていません。 ウィザードをパススルーするたびに、新しいインデックス、スキルセット、およびインデクサー構成が作成されます。 ウィザード内で保持および再利用できるのは、データ ソースのみです。 他のオブジェクトを編集または調整するには、オブジェクトを削除してからやり直すか、REST API または .NET SDK を使用して構造体を変更します。

+ ソース コンテンツは、[サポートされているデータ ソース](search-indexer-overview.md#supported-data-sources)内にある必要があります。

+ サンプリングは、ソース データのあるサブセットについて行われます。 大規模なデータ ソースの場合、ウィザードでフィールドが見逃される可能性があります。 サンプリングが不十分な場合は、スキーマを拡張するか、推論されたデータ型を修正することが必要になる場合があります。

+ ポータルで公開されている AI エンリッチメントは、組み込みのスキルのサブセットに限定されています。 

+ ウィザードで作成できる[ナレッジ ストア](knowledge-store-concept-intro.md)は、いくつかの既定のプロジェクションに限定され、既定の名前付け規則が使用されます。 名前またはプロジェクションをカスタマイズする場合は、REST または SDK を使用してナレッジ ストアを作成する必要があります。

## <a name="workflow"></a>ワークフロー

このウィザードは、次の主な 4 つの手順で構成されています。

1. サポートされている Azure データ ソースに接続します。

1. ソース データのサンプリングによって推論されるインデックス スキーマを作成します。

1. 必要に応じて、内容と構造を抽出または生成する AI エンリッチメントを追加します。 ナレッジ ストアを作成するための入力は、この手順で収集されます。

1. ウィザードを実行して、オブジェクトの作成、データの読み込み、スケジュールやその他の構成オプションの設定を行います。

<a name="data-source-inputs"></a>

### <a name="data-source-configuration-in-the-wizard"></a>ウィザードでのデータ ソースの構成

**データのインポート** ウィザードは、Azure Cognitive Search インデクサーによって提供される内部ロジックを使用して外部の[サポートされるデータ ソース](search-indexer-overview.md#supported-data-sources)に接続します。Azure Cognitive Search インデクサーは、ソースのサンプリング、メタデータの読み取り、内容と構造を読み取るためのドキュメントの解読の機能を備え、その後の Azure Search へのインポートのために JSON として内容をシリアル化することもできます。

すべてのプレビュー データ ソースがウィザードで使用できることが保証されているわけではありません。 各データ ソースには、他の変更を下流に導入する可能性があるため、スキルセット定義やインデックス スキーマ推論など、ウィザードのすべてのエクスペリエンスを完全にサポートしている場合にのみ、データ ソースの一覧にプレビューのデータ ソースが追加されます。

インポート元として指定できるのは、単一のテーブル、データベース ビュー、または同等のデータ構造体のみですが、構造体には、階層または入れ子になったのサブ構造体を含めることができます。 詳細については、[複合型のモデル化の方法に関するページ](search-howto-complex-data-types.md)を参照してください。

### <a name="skillset-configuration-in-the-wizard"></a>ウィザードでのスキルセットの構成

データ ソースの種類によって特定の組み込みのスキルが使用可能かどうかが通知されるため、データ ソース定義の後にスキルセットの構成が行われます。 特に、Blob Storage からファイルのインデックスを作成する場合、これらのファイルの解析モードの選択によって、感情分析を使用できるかどうかが決まります。

選択したスキルがウィザードによって追加されますが、正常な結果を得るために必要なその他のスキルも追加されます。 たとえば、ナレッジ ストアを指定した場合、ウィザードによって、プロジェクション (または物理データ構造) をサポートするための Shaper スキルが追加されます。

スキルセットはオプションなので、AI エンリッチメントが不要な場合は、ページの下部にあるボタンを使用してスキップすることができます。

<a name="index-definition"></a>

### <a name="index-schema-configuration-in-the-wizard"></a>ウィザードでのインデックス スキーマの構成

ウィザードによってデータ ソースがサンプリングされ、フィールドとフィールドの種類が検出されます。 データ ソースによっては、メタデータのインデックスを作成するためのフィールドが用意されている場合もあります。

サンプリングは不正確な演習であるため、次の考慮事項についてインデックスを確認してください。

1. フィールドの一覧は正確ですか。 データ ソースにサンプリングで含められなかったフィールドがある場合、サンプリングされなかった新しいフィールドを手動で追加し、検索エクスペリエンスに値を追加しないものと、[フィルター式](search-query-odata-filter.md)にも[スコアリング プロファイル](index-add-scoring-profiles.md)にも使用されないものをすべて削除できます。

1. データ型は受信データに適していますか。 Azure Cognitive Search では、[Entity Data Model (EDM) データ型](/rest/api/searchservice/supported-data-types)がサポートされています。 Azure SQL データについては、同等の値を示している[マッピング表](search-howto-connecting-azure-sql-database-to-azure-search-using-indexers.md#TypeMapping)があります。 詳細な背景については、[フィールドのマッピングと変換](search-indexer-field-mappings.md)に関する記事をご覧ください。

1. "*キー*" として使用できるフィールドが 1 つありますか。 このフィールドは、Edm.string でなければならず、ドキュメントを一意に識別する必要があります。 リレーショナル データの場合は、主キーにマップされていることがあります。 BLOB の場合、`metadata-storage-path` であることがあります。 フィールドの値に空白またはダッシュが含まれている場合は、**インデクサーの作成** 手順の **[詳細オプション]** で **[Base-64 エンコード キー]** オプションを設定し、これらの文字の検証チェックを抑制する必要があります。

1. 属性を設定して、インデックスでのこのフィールドの使用方法を指定します。 

   インデックス内のフィールドの物理的な表現が属性によって決定されるため、この手順に時間をかけてください。 後で属性を変更するときには、プログラムで行う場合も、ほとんどの場合にインデックスを削除して再構築する必要があります。 **Searchable** や **Retrievable** などのコア属性では、[ストレージへの影響は無視できる程度](search-what-is-an-index.md#index-size)です。 フィルターを有効にして suggester を使用すると、ストレージの要件が増えます。 

   + **Searchable** では、全文検索が有効になります。 自由形式のクエリまたはクエリ式で使用されるすべてのフィールドに、この属性が必要です。 **Searchable** としてマークしたフィールドごとに、逆インデックスが作成されます。

   + **Retrievable** の場合、検索結果にフィールドが返されます。 検索結果にコンテンツを提供するすべてのフィールドに、この属性が必要です。 このフィールドを設定しても、インデックス サイズに大きな影響はありません。

   + **Filterable** は、フィルター式でフィールドを参照できるようにします。 **$filter** 式で使用されるすべてのフィールドに、この属性が必要です。 このフィルター式は完全一致用です。 テキスト文字列はそのまま残るため、逐語的なコンテンツに対応するには、追加のストレージが必要です。

   + **Facetable** は、ファセット ナビゲーションにフィールドを使用できるようにします。 **Filterable** としてもマークされているフィールドのみを、**Facetable** としてマークできます。

   + **Sortable** は、並べ替えでフィールドを使用できるようにします。 **$Orderby** 式で使用されるすべてのフィールドに、この属性が必要です。

1. [字句解析](search-lucene-query-architecture.md#stage-2-lexical-analysis)が必要ですか。 **Searchable** である Edm.string フィールドの場合、言語拡張インデックス作成とクエリの実行が必要な場合は、**アナライザー** を設定できます。 

   既定値は *標準 Lucene* ですが、不規則名詞や動詞形式の解決など、高度な字句処理のために Microsoft のアナライザーを使用する必要がある場合は、*Microsoft の英語* を選択できます。 ポータルでは、言語アナライザーのみを指定できます。 カスタム アナライザーや、キーワード、パターンなどの非言語アナライザーを使用する場合は、プログラムで実行する必要があります。 アナライザーの詳細については、[言語アナライザーの追加](search-language-support.md)に関する記事をご覧ください。

1. オートコンプリートまたは候補の結果の形式の先行入力機能が必要ですか。 **[Suggester]** チェックボックスを選択し、選択したフィールドで [先行入力クエリ候補とオートコンプリート](index-add-suggesters.md)を有効にします。 suggester は、インデックス内のトークン化された用語の数を増加させるため、より多くのストレージを消費します。

### <a name="indexer-configuration-in-the-wizard"></a>ウィザードでのインデクサーの構成

ウィザードの最後のページでは、インデクサーの構成に関するユーザー入力が収集されます。 [スケジュールを指定](search-howto-schedule-indexers.md)したり、データ ソースの種類によって異なるその他のオプションを設定したりできます。

作成されるまでインデクサーに表示されない、次の設定もウィザードによって内部的に実行されます。

+ データ ソースとインデックスの間の[フィールド マッピング](search-indexer-field-mappings.md)
+ スキルの出力とインデックスの間の[出力フィールド マッピング](cognitive-search-output-field-mapping.md)

## <a name="next-steps"></a>次のステップ

ウィザードの利点と制限事項を理解する最善の方法は、これを段階を追って実行することです。 次のクイックスタートでは、各ステップについて説明します。

> [!div class="nextstepaction"]
> [クイックスタート: Azure portal を使用して検索インデックスを作成する](search-get-started-portal.md)