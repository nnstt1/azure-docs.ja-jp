---
title: メディア ブループリント サンプルをデプロイする
description: ブループリント アーティファクト パラメーターの詳細を含むメディア ブループリント サンプルのデプロイ手順です。
ms.date: 09/08/2021
ms.topic: sample
ms.openlocfilehash: 63dd8c1e10e27ee7c03f2dc8131297489c7d966f
ms.sourcegitcommit: f6e2ea5571e35b9ed3a79a22485eba4d20ae36cc
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "128631971"
---
# <a name="deploy-the-media-blueprint-sample"></a>メディア ブループリント サンプルをデプロイする

メディア ブループリント サンプルをデプロイするには、次の手順を実行する必要があります。

> [!div class="checklist"]
> - サンプルから新しいブループリントを作成する
> - サンプルのコピーを **発行済み** としてマークする
> - ブループリントのコピーを既存のサブスクリプションに割り当てる

Azure サブスクリプションをお持ちでない場合は、開始する前に [無料アカウント](https://azure.microsoft.com/free) を作成してください。

## <a name="create-blueprint-from-sample"></a>サンプルからブループリントを作成する

最初に、サンプルをスターターとして使用して環境内に新しいブループリントを作成することにより、ブループリント サンプルを実装します。

1. **[すべてのサービス]** を選択し、左側のウィンドウで **[ポリシー]** を検索して選択します。 **[ポリシー]** ページで **[ブループリント]** を選択します。

1. 左側の **[はじめに]** ページで、 _[ブループリントの作成]_ の下にある **[作成]** ボタンを選択します。

1. **メディア** ブループリント サンプルを _[その他のサンプル]_ で検索し、 **[このサンプルを使用する]** を選択します。

1. ブループリント サンプルの _[基本]_ を入力します。

   - **[ブループリントの名前]** : ブループリント サンプルのコピーの名前を指定します。
   - **[定義の場所]** :省略記号を使用して、サンプルのコピーを保存する管理グループを選択します。

1. ページの上部にある _[アーティファクト]_ タブまたはページの下部にある **[次へ: アーティファクト]** を選択します。

1. ブループリント サンプルを構成するアーティファクトの一覧を確認します。 多くのアーティファクトには、後で定義するパラメーターがあります。 ブループリント サンプルの確認が完了したら、 **[下書きの保存]** を選択します。

## <a name="publish-the-sample-copy"></a>サンプルのコピーを発行する

環境でのブループリント サンプルのコピーの作成が完了しました。 これは **下書き** モードで作成されており、割り当ておよびデプロイの前に **発行** する必要があります。 ブループリント サンプルのコピーは、お使いの環境や必要性に応じてカスタマイズできますが、その変更が原因で標準を満たさなくなる場合もあります。

1. **[すべてのサービス]** を選択し、左側のウィンドウで **[ポリシー]** を検索して選択します。 **[ポリシー]** ページで **[ブループリント]** を選択します。

1. 左側の **[ブループリントの定義]** ページを選択します。 ブループリント サンプルのコピーを、フィルターを使用して検索し、選択します。

1. ページの上部にある **[ブループリントを発行する]** を選択します。 右側の新しいページで、ブループリント サンプルのコピーの **[バージョン]** を指定します。 このプロパティは、後で変更を加える場合に役立ちます。 **[変更に関するメモ]** に入力します (例: 「メディア ブループリント サンプルから発行する最初のバージョン」)。 次に、ページの下部にある **[発行]** を選択します。

## <a name="assign-the-sample-copy"></a>サンプルのコピーを割り当てる

正常に **発行** されたブループリント サンプルのコピーは、保存先の管理グループ内のサブスクリプションに割り当てることができます。 この手順では、ブループリント サンプルのコピーの各デプロイを一意にするためのパラメーターを指定します。

1. **[すべてのサービス]** を選択し、左側のウィンドウで **[ポリシー]** を検索して選択します。 **[ポリシー]** ページで **[ブループリント]** を選択します。

1. 左側の **[ブループリントの定義]** ページを選択します。 ブループリント サンプルのコピーを、フィルターを使用して検索し、選択します。

1. ブループリント定義ページの上部にある **[ブループリントの割り当て]** を選択します。

1. ブループリント割り当て用のパラメーター値を指定します。

   - 基本

     - **サブスクリプション**:ブループリント サンプルのコピーを保存した管理グループ内の 1 つ以上のサブスクリプションを選択します。 複数のサブスクリプションを選択すると、入力したパラメーターを使用して、それぞれに対して割り当てが作成されます。
     - **割り当て名**:名前は、ブループリントの名前に基づいてあらかじめ設定されています。
       必要に応じて変更することも、そのままにしておくこともできます。
     - **[場所]** :マネージド ID を作成するリージョンを選択します。 Azure Blueprint は、この管理対象 ID を使用して、割り当てられたブループリント内にすべての成果物をデプロイします。 詳細については、[Azure リソースの管理対象 ID の概要](../../../../active-directory/managed-identities-azure-resources/overview.md)に関するページをご覧ください。
     - **ブループリント定義ラベル**:ブループリント サンプルのコピーの **発行済み** バージョンを選択します。

   - ロックの割り当て

     お使いの環境のブループリントのロック設定を選択します。 詳細については、[ブループリント リソースのロック](../../concepts/resource-locking.md)に関するページを参照してください。

   - マネージド ID

     既定の _システム割り当て_ マネージド ID オプションはそのままにします。

   - アーティファクトのパラメーター

     このセクションで定義するパラメーターは、定義対象のアーティファクトに適用されます。 これらのパラメーターはブループリントの割り当て時に定義されるので、[動的パラメーター](../../concepts/parameters.md#dynamic-parameters)です。 アーティファクトのパラメーターとその説明を含む詳しい一覧については、「[アーティファクトのパラメーター表](#artifact-parameters-table)」を参照してください。

1. すべてのパラメーターの入力が完了したら、ページの下部にある **[割り当て]** を選択します。 ブループリントの割り当てが作成され、アーティファクトのデプロイが開始されます。 デプロイに要する時間は、約 1 時間です。 デプロイの状態を確認するには、ブループリントの割り当てを開きます。

> [!WARNING]
> Azure Blueprints サービスと、組み込まれているブループリント サンプルは、**無料** でご利用になれます。 Azure リソースは、[製品ごとに課金](https://azure.microsoft.com/pricing/)されます。 このブループリント サンプルでデプロイされるリソースの実行コストを見積もるには、[料金計算ツール](https://azure.microsoft.com/pricing/calculator/)を使用します。

## <a name="artifact-parameters-table"></a>アーティファクトのパラメーター表

以下の表は、ブループリント アーティファクトのパラメーターの一覧を示しています。

アーティファクト名|アーティファクトの種類|パラメーター名|説明|
|-|-|-|-|
|\[プレビュー\]:Linux VM への Log Analytics エージェントのデプロイ |ポリシー割り当て |Linux VM 用の Log Analytics ワークスペース |詳細については、「[Azure ポータルで Log Analytics ワークスペースを作成する](../../../../azure-monitor/logs/quick-create-workspace.md)」を参照してください。 |
|\[プレビュー\]:Linux VM への Log Analytics エージェントのデプロイ |ポリシー割り当て |省略可能:スコープに追加するため、サポートされている Linux OS を持つ VM イメージの一覧 |空の配列 (`[]`) を使用して、オプションのパラメーターがないことを示すことができます。 |
|\[プレビュー\]:Windows VM への Log Analytics エージェントのデプロイ |ポリシー割り当て |省略可能:スコープに追加するため、サポートされている Windows OS を持つ VM イメージの一覧 |空の配列 (`[]`) を使用して、オプションのパラメーターがないことを示すことができます。 |
|\[プレビュー\]:Windows VM への Log Analytics エージェントのデプロイ |ポリシー割り当て |Windows VM 用の Log Analytics ワークスペース |詳細については、「[Azure ポータルで Log Analytics ワークスペースを作成する](../../../../azure-monitor/logs/quick-create-workspace.md)」を参照してください。 |
|\[プレビュー\]:監査要求をサポートするため、メディア コントロールを監査し、特定の VM 拡張機能をデプロイします |ポリシー割り当て |VM で構成する必要がある Log Analytics ワークスペース ID |これは、VM で構成する必要がある Log Analytics ワークスペース ID (GUID) です。 |
|\[プレビュー\]:監査要求をサポートするため、メディア コントロールを監査し、特定の VM 拡張機能をデプロイします |ポリシー割り当て |診断ログを有効にする必要のあるリソースの種類の一覧 |診断ログ設定が無効になっていないかを監査するリソースの種類の一覧。 使用できる値は、[Azure Monitor 診断ログのスキーマ](../../../../azure-monitor/essentials/resource-logs-schema.md#service-specific-schemas)に関するページで確認できます。 |
|\[プレビュー\]:監査要求をサポートするため、メディア コントロールを監査し、特定の VM 拡張機能をデプロイします |ポリシー割り当て |管理者グループ |グループ。 例: `Administrator; myUser1; myUser2` |
|\[プレビュー\]:監査要求をサポートするため、メディア コントロールを監査し、特定の VM 拡張機能をデプロイします |ポリシー割り当て |Windows VM Administrators グループに含める必要があるユーザーの一覧 |ローカルの Administrators グループに含める必要があるメンバーのセミコロン区切りリスト。 例: `Administrator; myUser1; myUser2` |
|ストレージ アカウントに対する Advanced Threat Protection のデプロイ |ポリシー割り当て |結果 |ポリシーの効果の詳細については、「[Azure Policy の効果について](../../../policy/concepts/effects.md)」を参照してください。 |
|SQL サーバーでの監査のデプロイ |ポリシー割り当て |保存期間の日数を示す値 (0 は無制限の保存期間を示します) |保存日数 (省略可能: 指定しない場合には _180_ 日間) |
|SQL サーバーでの監査のデプロイ |ポリシー割り当て |SQL サーバー監査のためのストレージ アカウントのリソース グループ名 |監査によって、Azure Storage アカウントの監査ログにデータベース イベントが書き込まれます (ストレージ アカウントは、SQL Server が作成された各リージョンに作成され、そのリージョン内のすべてのサーバーによって共有されます)。 重要 - 監査を適切に実施するために、リソース グループまたはストレージ アカウントを削除したり、名前を変更したりしないでください。 |
|ネットワーク セキュリティ グループの診断設定のデプロイ |ポリシー割り当て |ネットワーク セキュリティ グループの診断用のストレージ アカウント プレフィックス |このプレフィックスがネットワーク セキュリティ グループの場所と組み合わされて、作成されるストレージ アカウント名となります。 |
|ネットワーク セキュリティ グループの診断設定のデプロイ |ポリシー割り当て |ネットワーク セキュリティ グループの診断用のストレージ アカウントのリソース グループ名 (存在する必要があります) |ストレージ アカウントが作成されるリソース グループ。 このリソース グループは、既に存在している必要があります。 |

## <a name="next-steps"></a>次のステップ

これでメディア サンプルをデプロイする手順を確認できたので、以下の記事を参照して、概要とコントロール マッピングについて学習してください。

> [!div class="nextstepaction"]
> [メディア ブループリント - 概要](./index.md)
> [メディア ブループリント - コントロール マッピング](./control-mapping.md)

ブループリントとその使用方法に関するその他の記事:

- [ブループリントのライフサイクル](../../concepts/lifecycle.md)を参照する。
- [静的および動的パラメーター](../../concepts/parameters.md)の使用方法を理解する。
- [ブループリントの優先順位](../../concepts/sequencing-order.md)のカスタマイズを参照する。
- [ブループリントのリソース ロック](../../concepts/resource-locking.md)の使用方法を調べる。
- [既存の割り当ての更新](../../how-to/update-existing-assignments.md)方法を参照する。
