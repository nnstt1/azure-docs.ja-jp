---
title: チュートリアル - Azure IoT Hub の X.509 公開キー証明書について理解する | Microsoft Docs
description: チュートリアル - Azure IoT Hub の X.509 公開キー証明書について理解する
author: eross-msft
ms.service: iot-hub
services: iot-hub
ms.topic: tutorial
ms.date: 02/26/2021
ms.author: lizross
ms.custom:
- mvc
- 'Role: Cloud Development'
- 'Role: Data Analytics'
ms.openlocfilehash: 718ed8c89fbd5bccaff94b41e80b9b462faba1ee
ms.sourcegitcommit: 05c8e50a5df87707b6c687c6d4a2133dc1af6583
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/16/2021
ms.locfileid: "132555662"
---
# <a name="tutorial-understanding-x509-public-key-certificates"></a>チュートリアル: X.509 公開キー証明書について理解する

X.509 証明書は、ユーザー、コンピューター、サービス、またはデバイスを表すデジタル ドキュメントです。 証明機関 (CA)、下位 CA、または登録機関により発行され、証明書サブジェクトの公開キーが記録されています。 サブジェクトの秘密キーは記録されていません。秘密キーは、セキュリティで保護された場所に保存する必要があります。 公開キー証明書については、[RFC 5280](https://tools.ietf.org/html/rfc5280) で詳しく文書化されています。 デジタル署名が付いており、一般に次の情報が含まれています。

* 証明書サブジェクトに関する情報
* サブジェクトの秘密キーに対応する公開キー
* 発行元 CA に関する情報
* 暗号化やデジタル署名についてサポートされているアルゴリズム
* 証明書の失効と有効性の状態を判断するための情報

## <a name="certificate-fields"></a>証明書フィールド

これまでに、3 つのバージョンの証明書が生まれてきました。 各バージョンとも、1 つ前のバージョンからフィールドが追加されています。 最新版はバージョン 3 で、バージョン 3 固有のフィールドのほかに、バージョン 1 と 2 にあったフィールドが含まれています。 バージョン 1 で定義されていたフィールドは次のとおりです。

* **バージョン**: 証明書のバージョン番号を特定するための値 (1、2、または 3)
* **シリアル番号**: CA が発行する各証明書に固有の値
* **CA の署名アルゴリズム**: 証明書のコンテンツに署名する際に CA が使用するアルゴリズムの名称
* **発行者名**: 証明書の発行元 CA の識別名 (DN)
* **有効期間**: 証明書が有効であるとされる期間
* **サブジェクト名**: 証明書が表すエンティティの名前
* **サブジェクトの公開キー情報**: 証明書サブジェクトが所有する公開キー

バージョン 2 では、証明書の発行者に関する情報を格納する次のフィールドが追加されました。 もっとも、ここに挙げたフィールドはほとんど使われていません。

* **一意の発行者 ID**: 発行元 CA を一意に識別するために CA が定義した ID
* **一意のサブジェクト ID**: 証明書サブジェクトを一意に識別するために発行元 CA が定義した ID

バージョン 3 の証明書では、次の拡張機能が追加されました。

* **証明機関のキー識別子**: これは、次のいずれかの値になります。
  * CA のサブジェクトと、この証明書を発行した CA の証明書のシリアル番号
  * この証明書を発行した CA の公開キーのハッシュ値
* **サブジェクトのキー識別子**: 現在の証明書の公開キーのハッシュ値
* **キーの用途**: 証明書を使用できるサービスを定義します。 これは、次の値のなかから 1 つまたは複数を指定できます。
  * **デジタル署名**
  * **否認防止**
  * **キーの暗号化**
  * **データの暗号化**
  * **キーの承諾**
  * **キー証明書署名**
  * **CRL 署名**
  * **暗号化のみ**
  * **暗号解読のみ**
* **秘密キーの使用期間**: キーの組のうち、秘密キーの部分の有効期間
* **証明書ポリシー**: 証明書サブジェクトの検証に使用するポリシー
* **ポリシー マッピング**: ある組織のポリシーを、別の組織のポリシーにマッピングします
* **サブジェクトの別名**: サブジェクトの別名の一覧
* **発行者の別名**: 発行元 CA の別名の一覧
* **サブジェクトのディレクトリ属性**: X.500 または LDAP ディレクトリから取得する属性
* **基本的制約**: 証明書に、CA、ユーザー、コンピューター、デバイス、サービスのいずれを対象として発行された証明書であるかを指定できます。 この拡張機能にはほかにも、パスの長さに関する制約が含まれており、存在できる下位 CA の数を制限できます。
* **名前の制約**: CA が発行した証明書で許容される名前空間を指定します
* **ポリシーの制約**: CA 間のポリシーのマッピングを禁止するときに使用します
* **キーの用途 (拡張版)** : **キーの用途** 拡張機能で指定した目的のほかに、証明書の公開キーをどのように使用できるかを指定します
* **CRL 配布ポイント**: 基になる証明書失効リスト (CRL) が公開される URL を 1 つまたは複数指定します
* **anyPolicy の禁止**: 下位の CA 証明書で **あらゆる発行ポリシー** (OID: 2.5.29.32.0) を使用できなくします
* **最新の CRL**: 発行元 CA のデルタ CRL が公開される URL を 1 つまたは複数指定します
* **証明機関の情報アクセス**: 発行元 CA の証明書が公開される URL を 1 つまたは複数指定します
* **サブジェクトの情報アクセス**: 証明書サブジェクトについて追加の詳細を取得する方法に関する情報を指定します

## <a name="certificate-formats"></a>証明書の形式

証明書はさまざまな形式で保存できます。 Azure IoT Hub の認証では通常、PEM と PFX の形式を使用します。

### <a name="binary-certificate"></a>バイナリ証明書

これには、DER ASN.1 エンコードを使用した未加工のバイナリ証明書が含まれます。

### <a name="ascii-pem-format"></a>ASCII PEM 形式

PEM 証明書 (拡張子: .pem) には、base64 でエンコードされ、"-----BEGIN CERTIFICATE-----" から始まり、かつ "-----END CERTIFICATE-----" で終わる証明書が含まれます。 PEM 形式はきわめて広く使われているものであり、IoT Hub では、一部の証明書をアップロードする際に必須となっています。

### <a name="ascii-pem-key"></a>ASCII (PEM) キー

base64 でエンコードされた DER キーが含まれます。さらに、パスワードの保護に使用したアルゴリズムに関するメタデータが含まれることもあります。

### <a name="pkcs7-certificate"></a>PKCS#7 証明書

署名または暗号化されたデータを転送するために設計された形式です。 [RFC 2315](https://tools.ietf.org/html/rfc2315) で定義されています。 これには、証明書チェーン全体を含めることができます。

### <a name="pkcs8-key"></a>PKCS#8 キー

[RFC 5208](https://tools.ietf.org/html/rfc5208) で定義されている秘密キー ストアの形式です。

### <a name="pkcs12-key-and-certificate"></a>PKCS#12 キーと証明書

キーと証明書チェーン全体を格納し、保護できる複雑な形式です。 一般に、.pfx 拡張子を付けて使用します。 PKCS#12 と PFX 形式は同義です。

## <a name="for-more-information"></a>詳細情報

詳細については、次のトピックを参照してください。

* [門外漢のための X.509 証明書用語ガイド](https://techcommunity.microsoft.com/t5/internet-of-things/the-layman-s-guide-to-x-509-certificate-jargon/ba-p/2203540)
* [IoT 業界における X.509 CA 証明書の概念理解](./iot-hub-x509ca-concept.md)

## <a name="next-steps"></a>次のステップ

IoT ハブにデバイスを認証する際に利用できるテスト証明書を生成したい場合には、次のトピックを参照してください。

* [Microsoft 提供のスクリプトを使用してテスト証明書を作成する](tutorial-x509-scripts.md)
* [OpenSSL を使用してテスト証明書を作成する](tutorial-x509-openssl.md)
* [OpenSSL を使用して自己署名のテスト証明書を作成する](tutorial-x509-self-sign.md)

証明機関 (CA) の証明書または下位 CA の証明書があり、それをお使いの IoT ハブにアップロードすると共に自分がその所有者であることを証明する必要がある場合には、「[CA 証明書の所有を証明する](tutorial-x509-prove-possession.md)」を参照してください。