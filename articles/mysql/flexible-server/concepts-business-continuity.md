---
title: ビジネス継続性の概要 - Azure Database for MySQL フレキシブル サーバー
description: Azure Database for MySQL フレキシブル サーバーでのビジネス継続性の概念について説明します
author: mksuni
ms.author: sumuth
ms.service: mysql
ms.topic: conceptual
ms.date: 09/21/2020
ms.openlocfilehash: f78143483ccefe5147eb2ba5d0ee3f3353ab4aac
ms.sourcegitcommit: 702df701fff4ec6cc39134aa607d023c766adec3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/03/2021
ms.locfileid: "131445694"
---
# <a name="overview-of-business-continuity-with-azure-database-for-mysql---flexible-server"></a>Azure Database for MySQL - フレキシブル サーバーでのビジネス継続性の概要

[!INCLUDE[applies-to-mysql-flexible-server](../includes/applies-to-mysql-flexible-server.md)]

Azure Database for MySQL フレキシブル サーバーを使用すると、計画的および計画外の停止が発生した場合にデータベースを保護するビジネス継続性機能を利用できます。 自動バックアップや高可用性などの機能は、復旧時間とデータ損失の可能性が異なる、さまざまなレベルのフォールト保護に対応します。 障害から保護するようにアプリケーションを設計する際には、各アプリケーションの目標復旧時間 (RTO) と目標復旧時点 (RPO) を考慮する必要があります。 RTO はダウンタイムの許容範囲であり、RPO はデータベース サービスの中断後のデータ損失の許容範囲です。

次の表は、フレキシブル サーバーが提供する機能を示しています。

| **機能** | **説明** | **制限事項** |
| ---------- | ----------- | ------------ |
| **バックアップ & 復旧** | フレキシブル サーバーでは、データベース ファイルの毎日のバックアップが自動的に実行され、トランザクション ログが継続的にバックアップされます。 バックアップは、1 ～ 35 日の任意の期間保持できます。 データベース サーバーは、バックアップの保持期間内の任意の時点に復元できます。 復旧時間は、復元するデータのサイズとログ復旧を実行する時間によって異なります。 詳細については、「[概念 - バックアップと復元](./concepts-backup-restore.md)」を参照してください。 |バックアップ データはリージョン内に残されます |
| **ローカル冗長バックアップ** | フレキシブル サーバーのバックアップは、リージョン内および同じ可用性ゾーン内のローカル冗長ストレージに自動的かつ安全に格納されます。 ローカル冗長バックアップは、プライマリ リージョンの 1 つの物理的な場所内で、サーバーのバックアップ データ ファイルを 3 回レプリケートします。 ローカル冗長バックアップ ストレージでは、オブジェクトに年間 99.999999999% (9 が 11 個) 以上の持続性が提供されます。 詳細については、「[概念 - バックアップと復元](./concepts-backup-restore.md)」を参照してください。| すべてのリージョンで適用可能 |
| **geo 冗長バックアップ** | フレキシブル サーバー バックアップは、作成時に geo 冗長として構成できます。 geo 冗長性を有効にすると、リージョンの回復性を提供するために、プライマリ リージョンのペアになっているリージョンにサーバーのバックアップ データ ファイルがレプリケートされます。 geo 冗長バックアップ ストレージでは、オブジェクトに年間 99.99999999999999% (9 が 16 個) 以上の持続性が提供されます。 詳細については、「[概念 - バックアップと復元](./concepts-backup-restore.md)」を参照してください。| すべての [Azure のペアになっているリージョン](../../best-practices-availability-paired-regions.md)で使用可能 |
| **ゾーン冗長の高可用性** | フレキシブル サーバーは、リージョン内の 2 つの異なる可用性ゾーンにプライマリ サーバーとスタンバイ サーバーをデプロイする高可用性モードでデプロイできます。 これにより、ゾーンレベルの障害から保護され、計画的および計画外のダウンタイム イベントの発生時にアプリケーションのダウンタイムを減らすことができます。 プライマリ サーバーからのデータは、スタンバイ レプリカに同期的にレプリケートされます。 ダウンタイム イベントが発生すると、データベース サーバーは自動的にスタンバイ レプリカにフェールオーバーされます。 詳細については、「[概念 - 高可用性](./concepts-high-availability.md)」を参照してください。 | 汎用とメモリ最適化の価格レベルでサポートされます。 複数のゾーンが使用可能なリージョンでのみ利用できます。|
| **Premium ファイル共有** | データベース ファイルは、耐久性が高く信頼性に優れた Azure Premium ファイル共有に格納されます。これにより、自動データ復旧機能を備えた可用性ゾーン内に格納されたレプリカの 3 つのコピーを使用してデータの冗長性を実現できます。 詳細については、[Premium ファイル共有](../../storage/files/storage-how-to-create-file-share.md)に関するページを参照してください。 | 可用性ゾーン内に格納されるデータ |

## <a name="planned-downtime-mitigation"></a>計画的なダウンタイムの軽減

ダウンタイムが発生する計画メンテナンスのシナリオを次に示します。

| **シナリオ** | **Process**|
| :------------ | :----------- |
| **コンピューティングのスケーリング (ユーザー)**| コンピューティングのスケーリング操作を実行すると、スケーリングされたコンピューティング構成を使用して新しいフレキシブル サーバーがプロビジョニングされます。 既存のデータベース サーバーでは、アクティブなチェックポイントを完了でき、クライアント接続がドレインされ、コミットされていないトランザクションが取り消され、サーバー自体がシャットダウンされます。 その後、ストレージが新しいサーバーに接続され、データベースが起動します。これにより、クライアント接続を受け入れる前に、必要に応じて復旧が実行されます。 |
| **新しいソフトウェアのデプロイ (Azure)** | 新機能のロールアウトやバグの修正は、サービスの計画メンテナンスの一環として自動的に行われ、ユーザーはそれらのアクティビティがいつ発生するかをスケジュールできます。 詳細については、[ドキュメント](https://aka.ms/servicehealthpm)を参照し、自身の[ポータル](https://aka.ms/servicehealthpm)を確認してください |
| **マイナー バージョンのアップグレード (Azure)** | Azure Database for MySQL では、Azure によって決定されたマイナー バージョンへの修正プログラムが自動的にデータベース サーバーに適用されます。 これは、サービスの計画的なメンテナンスの一環として行われます。 これにより、秒単位の短いダウンタイムが発生し、データベース サーバーは新しいマイナー バージョンで自動的に再起動されます。 詳細については、[ドキュメント](../concepts-monitoring.md#planned-maintenance-notification)を参照し、自身の[ポータル](https://aka.ms/servicehealthpm)を確認してください。|

フレキシブル サーバーが **ゾーン冗長の高可用性** で構成されている場合、フレキシブル サーバーは最初にスタンバイ サーバーで操作を実行し、次にフェールオーバーを行わずにプライマリ サーバーで操作を実行します。 詳細については、「[概念 - 高可用性](./concepts-high-availability.md)」を参照してください。

## <a name="unplanned-downtime-mitigation"></a>計画外のダウンタイムの軽減

計画外のダウンタイムは、基になるハードウェアの障害、ネットワークの問題、ソフトウェアのバグなど、予期しない障害の結果として発生する可能性があります。 データベース サーバーが予期せず停止した場合、高可用性 [HA] を使用して構成されている場合は、スタンバイ レプリカがアクティブ化されます。 それ以外の場合は、新しいデータベース サーバーが自動的にプロビジョニングされます。 計画外のダウンタイムは回避できませんが、フレキシブル サーバーでは、データベース サーバーとストレージ レイヤーの両方で、ユーザーの介入を必要とすることなく自動的に復旧操作を実行することでダウンタイムが軽減されます。

### <a name="unplanned-downtime-failure-scenarios-and-service-recovery"></a>計画外のダウンタイム: 障害シナリオとサービス復旧

計画外の障害シナリオと復旧プロセスを次に示します。

| **シナリオ** | **復旧プロセス [非 HA]** | **復旧プロセス [HA]** |
| :---------- | ---------- | ------- |
| **データベース サーバーの障害** | 基になるハードウェアの障害が原因でデータベース サーバーが停止した場合、アクティブな接続は切断され、処理中のすべてのトランザクションは中止されます。 Azure はデータベース サーバーの再起動を試みます。 成功した場合は、データベース復旧が実行されます。 再起動に失敗した場合は、別の物理ノードでデータベース サーバーの再起動が試みられます。  <br /> <br /> 復旧時間 (RTO) は、大規模なトランザクションや、データベース サーバーの起動プロセス中に実行される復旧の量など、障害発生時のアクティビティを含め、さまざまな要因によって異なります。 <br /> <br /> MySQL データベースを使用するアプリケーションによって、切断された接続や失敗したトランザクションが検出され、再試行するように構築されている必要があります。  アプリケーションが再試行すると、接続は、新しく作成されたデータベース サーバーに転送されます。 | データベース サーバーの障害が検出されると、スタンバイ データベース サーバーがアクティブ化されるため、ダウンタイムが短縮されます。 詳細については、[HA の概念のページ](concepts-high-availability.md)を参照してください。 RTO は、RPO = 0 の場合は 60 ～ 120 秒と想定されます |
| **ストレージの障害** | アプリケーションは、ディスク障害や物理ブロックの破損など、ストレージ関連の問題の影響を一切認識しません。 データが 3 つのコピーに格納されるので、データのコピーは存続しているストレージから提供されます。 ブロックの破損は自動的に修正されます。 データのコピーが失われると、データの新しいコピーが自動的に作成されます。 | 回復不可能なエラーの場合、ダウンタイムを減らすために、フレキシブル サーバーがスタンバイ レプリカにフェールオーバーされます。 詳細については、[HA の概念のページ](./concepts-high-availability.md)を参照してください。 |
| **論理/ユーザー エラー** | 誤って破棄されたテーブルや間違って更新されたデータなどのユーザーエラーからの復旧には、エラーが発生する直前の時間までデータを復元および復旧することによる、[特定の時点への復旧](concepts-backup-restore.md) (PITR) の実行が含まれます。<br> <br>  データベース サーバー内のすべてのデータベースではなく、データベースまたは特定のテーブルのサブセットのみを復元する場合は、新しいインスタンスでデータベース サーバーを復元し、[pg_dump](https://www.postgresql.org/docs/current/app-pgdump.html) を使用してテーブルをエクスポートし、[pg_restore](https://www.postgresql.org/docs/current/app-pgrestore.html) を使用してそれらのテーブルをデータベースに復元することができます。 | これらのユーザー エラーは、すべてのユーザー操作がスタンバイにもレプリケートされるため、高可用性では保護されません。 |
| **可用性ゾーンの障害** | まれなイベントですが、ゾーンレベルの障害から復旧する場合は、バックアップを使用し、カスタム復元ポイントを選択してポイントインタイム リストアを実行して、最新のデータを取得することができます。 新しいフレキシブル サーバーが別のゾーンにデプロイされます。 復元にかかる時間は、前回のバックアップと、復旧するトランザクション ログの数によって異なります。 | フレキシブル サーバーは、スタンバイ サイトへの自動フェールオーバーを実行します。 詳細については、[HA の概念のページ](./concepts-high-availability.md)を参照してください。 |
| **リージョンの障害** | まれなイベントですが、リージョン レベルの障害から復旧する場合は、同じサブスクリプションで利用可能な最新の geo 冗長バックアップを使用して新しいサーバーを作成し、最新のデータを取得することで、データベースの復旧を実行できます。 選択したリージョンに新しいフレキシブル サーバーがデプロイされます。 復元にかかる時間は、前回のバックアップと、復旧するトランザクション ログの数によって異なります。 | まれなイベントですが、リージョン レベルの障害から復旧する場合は、同じサブスクリプションで利用可能な最新の geo 冗長バックアップを使用して新しいサーバーを作成し、最新のデータを取得することで、データベースの復旧を実行できます。 既存の HA サーバーのターゲットのフレキシブル サーバーは、非 HA サーバーとして Azure のペアになっているリージョンにデプロイされます。 復元にかかる時間は、前回のバックアップと、復旧するトランザクション ログの数によって異なります。 |

> [!IMPORTANT]
> 削除したサーバーは、復元 **できません**。 サーバーを削除すると、そのサーバーに属するデータベースもすべて削除され、復元できなくなります。 [Azure リソース ロック](../../azure-resource-manager/management/lock-resources.md)を使用すると、サーバーが誤って削除されるのを防ぐことができます。

## <a name="next-steps"></a>次のステップ

- [ゾーン冗長による高可用性](./concepts-high-availability.md)について確認する
- [バックアップと復旧](./concepts-backup-restore.md)について確認する