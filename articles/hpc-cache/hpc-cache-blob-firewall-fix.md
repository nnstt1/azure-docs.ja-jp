---
title: ストレージのファイアウォール設定を回避する
description: Azure HPC Cache に Azure Blob ストレージ ターゲットを作成するとき、ストレージ アカウントのネットワーク ファイアウォール設定によってエラーが発生することがあります。 この記事では、ソフトウェア修正プログラムが整うまでの間、この制限を回避する方法について説明します。
author: femila
ms.service: hpc-cache
ms.topic: troubleshooting
ms.date: 03/18/2021
ms.author: femila
ms.openlocfilehash: 11b5a28f35250a5d600cf849a3bd7b1a5bbe262e
ms.sourcegitcommit: 106f5c9fa5c6d3498dd1cfe63181a7ed4125ae6d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/02/2021
ms.locfileid: "131068438"
---
# <a name="work-around-blob-storage-account-firewall-settings"></a>BLOB ストレージ アカウントのファイアウォール設定を回避する

ストレージ アカウントの特定のファイアウォール設定により、ご自分の Blob ストレージ ターゲットの作成が失敗することがあります。 この問題に対応するソフトウェア修正プログラムは、Azure HPC Cache チームが着手していますが、この記事の手順に従うとこの問題を回避できます。

キャッシュは、"選択されたネットワーク" からのアクセスのみを許可するファイアウォール設定によって、Blob ストレージ ターゲットを作成または変更できなくなります。 この構成は、ストレージ アカウントの **[ファイアウォールと仮想ネットワーク]** 設定ページにあります。 (この問題は、ADLS-NFS ストレージ ターゲットには適用されません)。

これは、キャッシュ サービスが、お客様の環境とは別の非表示のサービス仮想ネットワークを使用するためです。 このネットワークに、お使いのストレージ アカウントへのアクセスを明示的に承認させることはできません。

キャッシュ サービスは、Blob ストレージ ターゲットを作成するとき、このネットワークを使用してコンテナーが空かどうかを確認します。 ファイアウォールが非表示のネットワークからのアクセスを許可しない場合、チェックは失敗し、ストレージ ターゲットの作成は失敗します。

また、ファイアウォールによって、Blob ストレージ ターゲットの名前空間パスへの変更をブロックすることもできます。

この問題を回避するには、ストレージ ターゲットの作成中は一時的にお使いのファイアウォールの設定を変更します。

1. ストレージ アカウント **[ファイアウォールと仮想ネットワーク]** ページに移動し、[許可するアクセス元] の設定を **[すべてのネットワーク]** に変更します。
1. お使いの Azure HPC Cache で Blob ストレージ ターゲットを作成します。
1. ストレージ ターゲットの名前空間パスを作成します。
1. ストレージ ターゲットとパスが正常に作成されたら、アカウントのファイアウォール設定を **[選択したネットワーク]** に戻します。

Azure HPC Cache は、完成しているストレージ ターゲットへのアクセスにはサービス仮想ネットワークを使用しません。

この回避策のサポートが必要な場合は、[Microsoft サービスにお問い合わせ](hpc-cache-support-ticket.md)ください。
