---
title: 管理者の同意ワークフローの構成
titleSuffix: Azure AD
description: 管理者の同意を必要とするアプリケーションへのアクセスをエンド ユーザーが要求できるように構成する方法について説明します。
services: active-directory
author: davidmu1
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.topic: how-to
ms.date: 10/06/2021
ms.author: davidmu
ms.reviewer: ergreenl
ms.collection: M365-identity-device-management
ms.openlocfilehash: 705a5aa25428378b8031d395b8241b2ac8890828
ms.sourcegitcommit: 05c8e50a5df87707b6c687c6d4a2133dc1af6583
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/16/2021
ms.locfileid: "132553270"
---
# <a name="configure-the-admin-consent-workflow"></a>管理者の同意ワークフローの構成

この記事では、管理者の同意ワークフロー機能を有効にする方法について説明します。これにより、エンド ユーザーは、管理者の同意を必要とするアプリケーションへのアクセスを要求できます。

管理者の同意ワークフローがなければ、ユーザーの同意が無効になっているテナントのユーザーが、組織のデータにアクセスするためのアクセス許可を必要とするアプリにアクセスしようとした場合に、ブロックされてしまいます。 ユーザーには、アプリへのアクセスが許可されていないことを知らせる一般的なエラー メッセージが表示されるため、管理者に問い合わせる必要があります。 しかし、ユーザーは問い合わせ先を知らないことが多いため、操作を諦めるか、アプリケーションで新しいローカル アカウントを作成することになります。 管理者が知らせを受けた場合でも、管理者がユーザーにアクセス権を付与してそれを通知するための合理的なプロセスが常に存在するとは限りません。
管理者の同意ワークフローによって、管理者は、管理者の承認を必要とするアプリケーションへのアクセス権を安全に付与することができます。 ユーザーがアプリケーションにアクセスしようとしているものの同意ができない場合には、ユーザーは管理者の承認の要求を送信できます。 要求は、レビュー担当者として指定された管理者にメールで送信されます。 レビュー担当者が要求に対してアクションを実行すると、ユーザーにそのアクションが通知されます。

レビュー担当者が要求を承認するには、そのレビュー担当者が全体管理者、クラウド アプリケーション管理者、またはアプリケーション管理者である必要があります。 レビュー担当者には、これらの管理者ロールのいずれかが既に割り当てられている必要があります。レビュー担当者として指定するだけでは、特権は昇格されません。

## <a name="enable-the-admin-consent-workflow"></a>管理者の同意ワークフローの有効化

管理者の同意ワークフローを有効にし、レビュー担当者を選択するには:

1. [Azure Portal](https://portal.azure.com) にグローバル管理者としてサインインします。
2. 左側のナビゲーション メニューの上部にある **[すべてのサービス]** をクリックします。 **[Azure Active Directory 拡張機能]** が開きます。
3. フィルターの検索ボックスに「**Azure Active Directory**」と入力して、 **[Azure Active Directory]** 項目を選択します。
4. ナビゲーション メニューで **[エンタープライズ アプリケーション]** をクリックします。
5. **[管理]** の下で **[ユーザー設定]** を選択します。
6. **[管理者の同意要求]** で、 **[ユーザーは、自分が同意できないアプリに対して管理者の同意を要求できます]** を **[はい]** に設定します。

   ![管理者の同意ワークフロー設定の構成](media/configure-admin-consent-workflow/admin-consent-requests-settings.png)

7. 次の設定を構成します。

   * **管理者の同意要求を確認するユーザーの選択**。 全体管理者、クラウド アプリケーション管理者、アプリケーション管理者のロールを持つユーザーのなかから、このワークフローのレビュー担当者を選択します。 **ワークフローをオンにするには、事前に 1 人以上のレビュー担当者を指定する必要があることに注意してください。**
   * **選択されたユーザーは要求に関するメール通知を受信する**。 要求が発生した場合のレビュー担当者へのメール通知を有効または無効にします。  
   * **選択されたユーザーは要求の有効期限に関するリマインダーを受信する**。 要求の有効期限が近づいたときに、レビュー担当者へのリマインダー メール通知を有効または無効にします。  
   * **同意要求の有効期限 (日数)** 。 要求の有効期間を指定します。

8. **[保存]** を選択します。 機能が有効になるまでに、最大で 1 時間かかることがあります。

> [!NOTE]
> このワークフローのレビュー担当者を追加または削除するには、 **[Select admin consent requests reviewers]\(管理者の同意要求のレビュー担当者\)** の一覧を変更します。 この機能には現在、レビュー担当者がレビュー機能を保持できるのはレビュー担当者として指定されている期間中に行われた要求のみという制限事項があることに注意してください。

## <a name="how-users-request-admin-consent"></a>ユーザーが管理者の同意を要求する方法

管理者の同意ワークフローを有効にすると、ユーザーはユーザーの同意が許可されていないアプリケーションについて管理者の承認を要求できます。 次の手順では、承認を要求する際のユーザー エクスペリエンスについて説明します。

1. ユーザーがアプリケーションにサインインしようとします。

2. **[承認が必要です]** というメッセージが表示されます。 ユーザーは、アプリへのアクセスが必要である理由を入力し、 **[承認要求]** を選択します。

   ![スクリーンショットには、承認を要求できる [承認が必要です] ダイアログ ボックスが示されています。](media/configure-admin-consent-workflow/end-user-justification.png)

3. **[リクエストが送信されました]** というメッセージで、要求が管理者に送信されたことを確認します。ユーザーが複数の要求を送信した場合は、最初の要求のみが管理者に送信されます。

   ![スクリーンショットには、[リクエストが送信されました] の確認が表示されています。](media/configure-admin-consent-workflow/end-user-sent-request.png)

4. 要求が承認、拒否、またはブロックされると、ユーザーにメール通知が届きます。

## <a name="review-and-take-action-on-admin-consent-requests"></a>管理者の同意要求の確認とアクションの実行

管理者の同意要求を確認してアクションを実行するには:

1. 管理者の同意ワークフローの登録済みレビュー担当者の 1 人として [Azure portal](https://portal.azure.com)にサインインします。
2. ナビゲーション メニューの左上部にある **[すべてのサービス]** をクリックします。 **[Azure Active Directory 拡張機能]** が開きます。
3. フィルターの検索ボックスに「**Azure Active Directory**」と入力して、 **[Azure Active Directory]** 項目を選択します。
4. ナビゲーション メニューで **[エンタープライズ アプリケーション]** をクリックします。
5. **[アクティビティ]** で、 **[管理者の同意要求]** を選択します。

   > [!NOTE]
   > レビュー担当者には、レビュー担当者として指定された後に作成された管理者の要求のみが表示されます。

6. 要求の対象となっているアプリケーションを選択します。
7. 要求の詳細を確認します。  

   * アクセスを要求しているユーザーとその理由を確認するには、 **[要求者]** タブを選択します。
   * アプリケーションによって要求されているアクセス許可を確認するには、 **[アクセス許可のレビューと同意]** を選択します。

8. 要求を評価し、適切なアクションを実行します。

   * **要求の承認**。 要求を承認する場合には、アプリケーションに管理者の同意を付与します。 要求が承認されたら、すべての要求元に対し、アクセスが許可されたことを知らせる通知が送信されます。 要求を承認すると、ユーザー割り当てによって他に制限されていない限り、テナント内のすべてのユーザーがアプリケーションにアクセスできます。 
   * **要求の拒否**。 要求を拒否する場合には、理由を入力する必要があります。入力した理由は、すべての要求元に提供されます。 要求が拒否されたら、すべての要求元に対し、アプリケーションへのアクセスが拒否されたことを知らせる通知が送信されます。 要求を拒否しても、ユーザーがその後同じアプリについて管理者の同意を要求できなくなるわけではありません。  
   * **要求のブロック**。 要求をブロックする場合には、理由を入力する必要があります。入力した理由は、すべての要求元に提供されます。 要求がブロックされたら、すべての要求元に対し、アプリケーションへのアクセスが拒否されたことを知らせる通知が送信されます。 要求をブロックすると、テナント内でそのアプリケーションのサービス プリンシパル オブジェクトが、無効の状態で作成されます。 以降は、ユーザーがそのアプリケーションに関する管理者の同意を要求することができなくなります。

## <a name="email-notifications"></a>メール通知

構成した場合、すべてのレビュー担当者は次の場合にメール通知を受信します。

* 新しい要求が作成された
* 要求の有効期限が切れた
* 要求の有効期限が近づいている  

要求元は、次の場合にメール通知を受信します。

* アクセス許可を求めて新しい要求を送信した
* 要求の有効期限が切れた
* 要求が拒否またはブロックされた
* 要求が承認された

## <a name="audit-logs"></a>監査ログ

次の表は、管理者の同意ワークフローで使用できるシナリオと監査の値の概要を示します。

|シナリオ  |監査サービス  |監査のカテゴリ  |監査アクティビティ  |監査アクター  |監査ログの制限事項  |
|---------|---------|---------|---------|---------|---------|
|管理者が同意要求のワークフローを有効にする        |アクセス レビュー           |UserManagement           |ガバナンス ポリシー テンプレートを作成する          |アプリのコンテキスト            |ユーザー コンテキストは、現時点では確認できません            |
|管理者が同意要求のワークフローを無効化する       |アクセス レビュー           |UserManagement           |ガバナンス ポリシー テンプレートを削除する          |アプリのコンテキスト            |ユーザー コンテキストは、現時点では確認できません           |
|管理者が同意ワークフローの構成を更新する        |アクセス レビュー           |UserManagement           |ガバナンス ポリシー テンプレートを更新する          |アプリのコンテキスト            |ユーザー コンテキストは、現時点では確認できません           |
|エンド ユーザーがアプリに対する管理者の同意要求を作成する       |アクセス レビュー           |ポリシー         |要求を作成           |アプリのコンテキスト            |ユーザー コンテキストは、現時点では確認できません           |
|レビュー担当者が管理者の同意要求の承認をする       |アクセス レビュー           |UserManagement           |ビジネス フロー内のすべての要求を承認する          |アプリのコンテキスト            |現時点では、管理者の同意が付与されたユーザーコンテキストまたはアプリIDが見つかりません。           |
|レビュー担当者が管理者の同意要求拒否をする       |アクセス レビュー           |UserManagement           |ビジネス フロー内のすべての要求を承認する          |アプリのコンテキスト            | 現時点では、管理者の同意要求を拒否したアクターのユーザーコンテキストが見つかりません          |

## <a name="faq"></a>よく寄せられる質問

**このワークフローをオンにしましたが、機能のテスト時に、アクセスの要求に必要な [承認が必要です] という新しいメッセージが表示されないのはなぜですか。**

この機能をオンにした後、エンド ユーザーが更新を確認できるようになるまでに最大で 60 分かかることがあります。しかし、通常は、数分以内にすべてのユーザーが更新を利用できます。

**レビュー担当者が保留中のすべての要求を表示できないのはなぜですか。**

レビュー担当者は、レビュー担当者として指定された後に作成された管理者の要求のみ表示できます。 そのため、最近レビュー担当者として追加された場合、自分が指定される前に作成された要求は表示されません。

**レビュー担当者が同じアプリケーションに対する複数の要求を確認できるのはなぜですか。**
  
アプリケーション開発者が、静的および動的な同意を使用してエンド ユーザーのデータへのアクセスを要求するようにアプリを構成している場合は、管理者の同意要求が 2 件表示されます。 1 つの要求は静的なアクセス許可を表し、もう 1 つの要求は動的なアクセス許可を表します。

**要求元は、自分の要求の状態を確認できますか。**  

いいえ。現時点では、要求元はメール通知でのみ最新の状態を確認できます。

**レビュー担当者が、アプリケーションの承認を一部のユーザーのみに限定することはできますか。**

管理者の同意を付与してテナント内のすべてのユーザーにアプリケーションの使用を許可することに懸念がある場合は、要求を拒否することをお勧めします。 そのうえで、管理者の同意を手動で付与します。これを行うには、ユーザー割り当てを要求することでアプリケーションへのアクセスを制限し、次にアプリケーションにユーザーまたはグループを割り当てます。 詳細については、[ユーザーとグループの割り当て方法](./assign-user-or-group-access-portal.md)に関するページを参照してください。

**ユーザーの割り当てが必要なアプリがあります。アプリケーションに割り当てたユーザーは、自分で同意するのではなく、管理者の同意を要求するように求められます。なぜですか。**

[ユーザーの割り当てが必要] によってアプリケーションへのアクセスが制限されている場合、Azure AD 管理者は、アプリケーションによって要求されたすべてのアクセス許可に同意する必要があります。 

## <a name="next-steps"></a>次のステップ

アプリケーションに同意する行為の詳細については、「[Azure Active Directory 同意フレームワーク](../develop/consent-framework.md)」を参照してください。

[エンド ユーザーがアプリケーションに同意する方法の構成](configure-user-consent.md)

[アプリケーションへのテナント全体の管理者の同意の付与](grant-admin-consent.md)

[Microsoft ID プラットフォームでのアクセス許可と同意](../develop/v2-permissions-and-consent.md)

[Microsoft Q&A の Azure AD](/answers/topics/azure-active-directory.html)
