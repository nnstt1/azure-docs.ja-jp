---
title: Azure Active Directory アプリケーションのプロビジョニングで、特定のユーザーがいつアプリケーションにアクセスできるようになるかを確認する
description: 非常に重要なユーザーが、Azure Active Directory でユーザー プロビジョニング向けに構成したアプリケーションにいつアクセスできるようになるかを確認する方法
services: active-directory
author: kenwith
manager: karenh444
ms.service: active-directory
ms.subservice: app-provisioning
ms.workload: identity
ms.topic: how-to
ms.date: 05/11/2021
ms.author: kenwith
ms.reviewer: arvinh
ms.openlocfilehash: ef678a9e8a2db46315722eb54f0c4e428355e68d
ms.sourcegitcommit: 611b35ce0f667913105ab82b23aab05a67e89fb7
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/14/2021
ms.locfileid: "129991605"
---
# <a name="check-the-status-of-user-provisioning"></a>ユーザー プロビジョニングの状態を確認する

Azure AD プロビジョニング サービスは、ソース システムとターゲット システムに対して初回プロビジョニング サイクルを実行した後、増分サイクルを定期的に行います。 アプリのプロビジョニングを構成するときに、現在のプロビジョニング サービスの状態をチェックすることで、ユーザーがいつ頃アプリにアクセスできるようになるかを予想できます。

## <a name="view-the-provisioning-progress-bar"></a>プロビジョニング進行状況バーを確認する

 アプリの **[プロビジョニング]** ページで、Azure AD プロビジョニング サービスの状態を確認できます。 プロビジョニング サイクルによってユーザー アカウントのプロビジョニングが開始されたかどうかは、ページ下部の **[現在の状態]** セクションに表示されます。 サイクルの進行状況を監視して、プロビジョニング済みのユーザーとグループの数を確認したり、作成されたロールの数を確認したりすることができます。

初めて自動プロビジョニングを構成するとき、ページ下部の **[現在の状態]** セクションに、初回プロビジョニング サイクルの状態が表示されます。 増分サイクルが実行されるたびに、このセクションが更新されます。 次の情報が表示されます。
- 現在実行されているプロビジョニング サイクルまたは最後に完了したプロビジョニング サイクルの種類 (初回または増分)。
- 完了したプロビジョニング サイクルのパーセンテージを示す **進行状況バー**。 このパーセンテージは、プロビジョニングされたページの数を表します。 各ページには複数のユーザーまたはグループが含まれている可能性もあるため、プロビジョニングされたユーザー、グループ、ロールの数とこのパーセンテージとの間に、直接的な相関関係はないことに注意してください。
- **[最新の情報に更新]** ボタン。このボタンを使用して、常に最新の情報を表示することができます。
- コネクタ データ ストア内の **ユーザー** と **グループ** の数。 この数は、オブジェクトがプロビジョニングのスコープに追加されるたびに増加します。 ユーザーが論理的に削除されたり、物理的に削除されたりしても、コネクタ データ ストアからオブジェクトが削除されないため、数は減りません。 この数は、CDS が[リセット](/graph/api/synchronization-synchronizationjob-restart?tabs=http&view=graph-rest-beta&preserve-view=true)された後の最初の同期で再計算されます。 
- **[監査ログの表示]** リンク。Azure AD のプロビジョニング ログが開いて、個々のユーザーのプロビジョニング状態を含め、ユーザー プロビジョニング サービスによって実行された全操作についての詳細が表示されます (以下の [プロビジョニング ログの使用](#use-provisioning-logs-to-check-a-users-provisioning-status)に関するセクションを参照)。

プロビジョニング サイクルの完了後、現在までにプロビジョニングされた累積のユーザー数とグループ数が、完了日と最後のサイクルの期間と共に **[現在までの統計情報]** セクションに表示されます。 直近のプロビジョニング サイクルは、 **[アクティビティ ID]** によって一意に識別されます。 **[ジョブ ID]** は、プロビジョニング ジョブの一意識別子であり、テナント内のアプリに固有です。

プロビジョニングの進行状況は、Azure portal の **[Azure Active Directory] &gt; [エンタープライズ アプリ] &gt; \[<アプリケーション名>\] &gt; [プロビジョニング]** タブで確認できます。

![プロビジョニング ページの進行状況バー](./media/application-provisioning-when-will-provisioning-finish-specific-user/provisioning-progress-bar-section.png)

## <a name="use-provisioning-logs-to-check-a-users-provisioning-status"></a>プロビジョニング ログを使用してユーザーのプロビジョニング状態を確認する

選択したユーザーのプロビジョニングの状態を確認するには、Azure AD の[プロビジョニング ログ (プレビュー)](../reports-monitoring/concept-provisioning-logs.md?context=azure/active-directory/manage-apps/context/manage-apps-context) を確認します。 ユーザー プロビジョニング サービスによって実行された操作はすべて、Azure AD のプロビジョニング ログに記録されます。 これには、ソース システムとターゲット システムに対して実行されたすべての読み取りおよび書き込み操作と、各操作の際に読み取られたり書き込まれたりしたユーザー データが含まれます。

Azure portal で、 **[Azure Active Directory]** &gt; **[エンタープライズ アプリ]** &gt; **[プロビジョニング ログ (プレビュー)]** ( **[アクティビティ]** セクション内) を順に選択して、プロビジョニング ログにアクセスできます。 プロビジョニング データは、ユーザー名か、ソース システムまたはターゲット システムの識別子に基づいて検索できます。 詳細については、[プロビジョニング ログ(プレビュー)](../reports-monitoring/concept-provisioning-logs.md?context=azure/active-directory/manage-apps/context/manage-apps-context) に関する記事を参照してください。 

プロビジョニング ログには、プロビジョニング サービスによって実行されたすべての操作が記録されます。これには、次の操作が含まれます。

* プロビジョニングの対象となる割り当て済みユーザーを Azure AD で照会する
* これらのユーザーが存在するかどうかを対象となるアプリで照会する
* システム間でユーザー オブジェクトを比較する
* 比較に基づいて、対象のシステムのユーザー アカウントを追加または更新するか、無効にする

Azure portal でプロビジョニング ログを確認する方法の詳細については、[プロビジョニング レポートに関するガイド](check-status-user-account-provisioning.md)を参照してください。

## <a name="how-long-will-it-take-to-provision-users"></a>ユーザーをプロビジョニングするにはどのくらいの時間がかかりますか。
アプリケーションで自動ユーザー プロビジョニングを使用するとき、Azure AD は[ユーザーとグループの割り当て](../manage-apps/assign-user-or-group-access-portal.md)などに基づいて、定期的にスケジュールされた間隔 (通常は 40 分ごと) で自動的にユーザー アカウントをアプリ内でプロビジョニングし、更新します。

特定のユーザーがプロビジョニングされるのにかかる時間は主に、プロビジョニング ジョブで実行されているのが初回サイクルか増分サイクルかによって異なります。

- **初回サイクル** では、ジョブ時間は、プロビジョニングのスコープ内のユーザーおよびグループの数、ソース システム内のユーザーおよびグループの合計数など多くの要因によって異なります。 Azure AD とアプリの間での初回の同期には 20 分～数時間かかることがあります。この時間は Azure AD のディレクトリ サイズと、プロビジョニングの対象となるユーザー数によって異なります。 初回サイクルのパフォーマンスに影響する要因の包括的な一覧は、このセクションの後の方にまとめられています。

- 初回サイクル後の **増分サイクル** では、初回サイクル後の両方のシステムの状態を表すウォーターマークがプロビジョニング サービスに保存されるため、ジョブの時間が短縮される傾向があり (たとえば 10 分以内など)、後続の同期のパフォーマンスが改善されます。 ジョブ時間は、そのプロビジョニング サイクルで検出される変更の数によって異なります。 ユーザーまたはグループのメンバーシップの変更が 5,000 未満の場合、ジョブは 1 増分プロビジョニング サイクル内で終了できます。 

次の表は、一般的なプロビジョニング シナリオの同期時間のまとめです。 これらのシナリオでは、ソース システムが Azure AD、ターゲット システムが SaaS アプリです。 同期時間は、SaaS アプリである ServiceNow、Workplace、Salesforce、および G Suite の同期ジョブの統計分析から導かれています。


| スコープ構成 | スコープ内のユーザー、グループ、およびメンバー | 初回サイクル時間 | 増分サイクル時間 |
| -------- | -------- | -------- | -------- |
| 割り当てられたユーザーとグループのみを同期する |  1,000 未満 |  30 分未満 | 30 分未満 |
| 割り当てられたユーザーとグループのみを同期する |  1,000 ～ 10,000 | 142 ～ 708 分 | 30 分未満 |
| 割り当てられたユーザーとグループのみを同期する |   10,000 ～ 100,000 | 1,170 ～ 2,340 分 | 30 分未満 |
| Azure AD のすべてのユーザーとグループを同期する |  1,000 未満 | 30 分未満  | 30 分未満 |
| Azure AD のすべてのユーザーとグループを同期する |  1,000 ～ 10,000 | 30 分未満 ～ 120 分 | 30 分未満 |
| Azure AD のすべてのユーザーとグループを同期する |  10,000 ～ 100,000  | 713 ～ 1,425 分 | 30 分未満 |
| Azure AD のすべてのユーザーを同期する|  1,000 未満  | 30 分未満 | 30 分未満 |
| Azure AD のすべてのユーザーを同期する | 1,000 ～ 10,000  | 43 ～ 86 分 | 30 分未満 |

**割り当てられたユーザーとグループのみを同期する** 構成では、次の式を使用して **初回サイクル** のおよその最小予測時間と最大予測時間を確認できます。

- 最小時間 (分) = 0.01 x [割り当てられたユーザー、グループ、およびグループ メンバーの数]
- 最大時間 (分) = 0.08 x [割り当てられたユーザー、グループ、およびグループ メンバーの数]

**初回サイクル** の完了に要する時間に影響する要因のまとめ:

- プロビジョニングのスコープ内のユーザーとグループの合計数。

- ソース システム (Azure AD) に存在するユーザー、グループ、およびグループのメンバーの合計数。

- プロビジョニングのスコープ内のユーザーがターゲット アプリケーション内の既存のユーザーと一致するかどうか、または新たに作成する必要があるかどうか。 すべてのユーザーを初めて作成する同期ジョブはすべてのユーザーが既存ユーザーと一致する同期ジョブの約 *2 倍* の時間がかかります。

- [プロビジョニング ログ](check-status-user-account-provisioning.md)内のエラーの数。 多くのエラーが発生し、プロビジョニング サービスが検疫状態に移行した場合、パフォーマンスは低下します。 

- ターゲット システムによって実装される要求レートの制限および調整。 ターゲット システムによって、要求レートの制限および調整が実装される場合があり、大規模な同期動作中にパフォーマンスに影響する可能性があります。 このような条件下では、高速で大量の要求を受信するアプリは応答レートが遅くなったり、接続が閉じたりする場合があります。 パフォーマンスを向上するために、アプリが処理できるよりも速くアプリ要求を送信しないようにコネクタによって調整する必要があります。 Microsoft がビルドしたプロビジョニング コネクタはこの調整を行います。 

- 割り当てられたグループの数とサイズ。 割り当てられたグループの同期はユーザーの同期よりも時間がかかります。 割り当てられたグループの数とサイズの両方がパフォーマンスに影響します。 [グループ オブジェクト同期用に有効にされたマッピング](customize-application-attributes.md#editing-group-attribute-mappings)がアプリにある場合、グループ名やメンバーシップなどのグループ プロパティがユーザーの他に同期されます。 これらの追加の同期はユーザー オブジェクトの同期のみの場合よりも時間がかかります。

- パフォーマンスが問題になり、テナント内のユーザーとグループのほとんどをプロビジョニングしようとしている場合は、スコープ フィルターを使用します。 スコープ フィルターによって、ユーザーが特定の属性値に基づいてフィルター処理され、プロビジョニング サービスが Azure AD から抽出するデータを細かく調整できるようになります。 スコープ フィルターの詳細については、「[スコープ フィルターを使用した属性ベースのアプリケーション プロビジョニング](../app-provisioning/define-conditional-rules-for-provisioning-user-accounts.md)」を参照してください。

## <a name="next-steps"></a>次のステップ
[Azure Active Directory による SaaS アプリへのユーザー プロビジョニングとプロビジョニング解除の自動化](user-provisioning.md)