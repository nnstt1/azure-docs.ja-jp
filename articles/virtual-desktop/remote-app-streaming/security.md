---
title: Azure Virtual Desktop での組織間アプリのセキュリティ ガイド - Azure
description: Azure Virtual Desktop でホストするアプリを複数の組織にわたってセキュリティで保護する方法に関するガイド。
author: Heidilohr
ms.topic: conceptual
ms.date: 07/14/2021
ms.author: helohr
ms.custom: devx-track-azurepowershell
manager: femila
ms.openlocfilehash: 3216a8f82bc066cded33f133d9fe8823484d50b0
ms.sourcegitcommit: 702df701fff4ec6cc39134aa607d023c766adec3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/03/2021
ms.locfileid: "131463147"
---
# <a name="security-guidelines-for-cross-organizational-apps"></a>組織間アプリのセキュリティ ガイドライン

Azure Virtual Desktop でアプリをホストまたはストリーム配信する場合、組織内外のさまざまなユーザーにアクセスすることになります。 そのため、組織と顧客の安全性を確保できるように、デプロイをセキュリティで保護する方法を知っていることが非常に重要です。 このガイドでは、想定される安全性に関する懸念事項とその対処方法に関する基礎知識を提供します。

## <a name="shared-responsibility"></a>共同責任

Azure Virtual Desktop よりも前は、リモート デスクトップ サービスのようなオンプレミスの仮想化ソリューションでは、ゲートウェイ、ブローカー、Web アクセスなどのロールへのアクセス権をユーザーに付与する必要がありました。 これらのロールは、完全に冗長化され、ピーク時の容量を処理できる必要がありました。 管理者はこれらのロールを Windows Server OS の一部としてインストールし、それらはパブリック接続からアクセスできる特定のポートを使用してドメイン参加済みである必要がありました。 デプロイのセキュリティを維持するために、管理者はインフラストラクチャ内のすべてのものが保守され、最新の状態になっているかを常に確認する必要がありました。

一方で、Azure Virtual Desktop では、お客様に代わってサービスの一部が管理されます。 具体的には、インフラストラクチャの部分は、サービスの一部として Microsoft によってホストおよび管理されます。 パートナーと顧客は、ユーザーがセッション ホスト仮想マシン (VM) にアクセスするために必要なインフラストラクチャを手動で管理する必要がなくなりました。 このサービスには、リバース接続のような高度なセキュリティ機能も組み込まれています。これにより、ユーザーがどこからでもリモート デスクトップにアクセスできるようにすることに伴うリスクが軽減されます。

サービスの柔軟性を維持するために、セッション ホストはパートナーまたは顧客の Azure サブスクリプションでホストされます。 これにより、顧客はサービスを他の Azure サービスと統合し、それらが ExpressRoute や仮想プライベート ネットワーク (VPN) を使用してオンプレミスのネットワーク インフラストラクチャに接続できるようにします。

多くのクラウド サービスと同様に、お客様と Microsoft との間には[セキュリティに関する共同責任](../../security/fundamentals/shared-responsibility.md)があります。 Azure Virtual Desktop を使用する場合、サービスのある部分はお客様のためにセキュリティで保護されている一方で、組織のセキュリティ ニーズに応じてお客様自身で構成する必要がある部分もあることを理解していることが重要です。

お客様は、次の領域でセキュリティを構成する必要があります。

- エンド ユーザーのデバイス
- アプリケーションのセキュリティ
- セッション ホストのオペレーティング システム
- デプロイの構成
- ネットワーク制御

これらの各領域を構成する方法の詳細については、「[セキュリティの運用方法](./../security-guide.md)」を参照してください。

## <a name="combined-microsoft-security-platform"></a>結合された Microsoft セキュリティ プラットフォーム

Microsoft 365、Azure、および Azure Virtual Desktop のセキュリティ機能とコントロールを使用してワークロードを保護できます。

ユーザーがインターネットを使用してサービスに接続すると、Azure Active Directory (Azure AD) によってユーザーの資格情報が認証され、[条件付きアクセス](../../active-directory/conditional-access/overview.md)や[多要素認証](../../active-directory/authentication/concept-mfa-howitworks.md)などの保護機能が有効になります。 これらの機能によって、ユーザー ID が侵害されるリスクが大幅に軽減されます。

Azure Virtual Desktop には、ユーザーが受信ポートを開かなくてもセッション ホストにアクセスできるようにする[リバース接続](../network-connectivity.md#reverse-connect-transport)のような機能があります。 この機能はスケーラビリティとサービスを念頭に置いて設計されているため、セッション ホストを拡張する能力が制限されることもありません。 また、既存の GPO をこの機能と共に使用して、Active Directory 参加 VM、または Azure Active Directory 参加シナリオが関連する可能性がある Windows 10 セッション ホストのサポートに追加のセキュリティを適用することもできます ([Microsoft エンドポイント マネージャー](/mem/intune/fundamentals/windows-virtual-desktop-multi-session)に関する記事を参照)。

## <a name="defense-in-depth"></a>多層防御

今日の脅威の状況では、セキュリティ アプローチを念頭に置いた設計が必要です。 理想的には、データとネットワークを侵害や攻撃から保護するために、コンピューター ネットワーク全体に階層化された一連のセキュリティ メカニズムとコントロールを構築することです。 米国のサイバーセキュリティ インフラストラクチャ セキュリティ庁 (CISA) では、この種類のセキュリティ設計を "多層防御" と呼んでいます。 多層防御について詳しくは、[CISA の Web サイト](https://us-cert.cisa.gov/bsi/articles/knowledge/principles/defense-in-depth)をご覧ください。

## <a name="session-host-operating-systems"></a>セッション ホストのオペレーティング システム

Azure Virtual Desktop では、次のオペレーティング システムがサポートされています。

- Windows 7
- Windows 10 Enterprise
- Windows Server 2012 R2、2016、2019、および 2022
- Windows 10 (Enterprise マルチセッション)

Windows 10 Enterprise マルチセッションは、リモート デスクトップ セッション ホスト (RDSH) として機能する Azure 専用の OS です。これを使用すると、Windows Server と同様に、複数の対話型セッションを同時に実行できます。 Windows 10 環境は、使い慣れた一貫性のあるエクスペリエンスをユーザーに提供します。 また、IT 部門では RDS のクライアント アクセス ライセンス (CAL) を購入し続ける必要がないため、このサービスのユーザーごとの Windows ライセンスによって組織全体のコストも削減されます。 これらの利点のため、Windows 10 Enterprise マルチセッションは、Azure Virtual Desktop でのセッション ホスト用に最も広くデプロイされている OS です。

## <a name="security-boundaries"></a>セキュリティ境界

セキュリティ境界では、セキュリティ ドメインのコードとデータを異なる信頼レベルで分離します。 たとえば、通常、カーネル モードとユーザー モードの間にはセキュリティ境界があります。 ほとんどの Microsoft のソフトウェアとサービスは、ネットワーク上のデバイス、VM、およびデバイス上のアプリケーションを分離するために複数のセキュリティ境界に依存しています。 次の表に、Windows の各セキュリティ境界と、全体的なセキュリティに関して行われる内容を示します。

| セキュリティ境界             | 境界によって行われる内容      |
|-----------------------------------|--------------------------------------|
| ネットワーク境界              | 承認されていないネットワーク エンドポイントは、顧客のデバイス上のコードやデータに対するアクセスや改ざんができません。                                                                   |
| カーネル境界               | 管理者以外のユーザー モード プロセスは、カーネル コードやデータに対するアクセスや改ざんができません。 Administrator-to-kernel はセキュリティ境界ではありません。                             |
| プロセス境界               | 承認されていないユーザー モード プロセスは、別のプロセスのコードやデータに対するアクセスや改ざんができません。                                                                      |
| AppContainer サンドボックス境界  | AppContainer ベースのサンドボックス プロセスは、コンテナーの機能に基づいてサンドボックスの外部のコードやデータに対するアクセスや改ざんができません。                               |
| ユーザー境界                  | ユーザーは、承認されていない場合、別のユーザーのコードやデータに対するアクセスや改ざんができません。                                                                           |
| セッション境界               | ユーザー セッションは、承認されていない場合、別のユーザー セッションに対するアクセスや改ざんができません。                                                                    |
| Web ブラウザー境界           | 承認されていない Web サイトは、同一オリジン ポリシーに違反できません。また、Microsoft Edge Web ブラウザーのサンドボックスのネイティブ コードやデータに対するアクセスや改ざんができません。       |
| 仮想マシン境界       | 承認されていない Hyper-V ゲスト仮想マシンは、別のゲスト仮想マシンのコードやデータに対するアクセスや改ざんができません。これには、Hyper-V の分離コンテナーも含まれます。 |
| 仮想セキュア モード (VSM) 境界  | VSM の信頼されたプロセスまたはエンクレーブの外部で実行されているコードは、信頼されたプロセス内のデータやコードに対するアクセスや改ざんができません。                              |

## <a name="security-features"></a>セキュリティ機能

セキュリティ機能は、特定の脅威からの保護を強化するために、セキュリティ境界に基づいて構築されています。 ただし、設計上の制限により、セキュリティ機能によるデプロイの完全な保護ができない場合もあります。

Azure Virtual Desktop では、Windows で使用できるほとんどのセキュリティ機能がサポートされています。 (v)TPM や入れ子になった仮想化などのハードウェア機能に依存するセキュリティ機能には、Azure Virtual Desktop チームからの別のサポート ステートメントが必要になる場合があります。

セキュリティ機能のサポートとサービスの詳細については、「[Windows での Microsoft セキュリティ サービス提供の基準](https://www.microsoft.com/msrc/windows-security-servicing-criteria)」を参照してください。

## <a name="recommended-security-boundaries-for-azure-virtual-desktop-scenarios"></a>Azure Virtual Desktop のシナリオで推奨されるセキュリティ境界

また、ケースバイケースでセキュリティ境界に関する特定の選択を行う必要があります。 たとえば、組織内のユーザーがアプリをインストールするためにローカルの管理特権を必要とする場合は、共有 RDSH ではなく、個人用デスクトップを提供する必要があります。 マルチセッション プール シナリオでは、ユーザーにローカル管理者特権を付与することはお勧めできません。その理由は、これらのユーザーが、セッションまたは NTFS データ アクセス許可のセキュリティ境界を越えたり、マルチセッション VM をシャットダウンしたり、サービスの中断やデータ損失を引き起こす可能性があるその他の操作を行ったりする場合があるからです。

管理者特権を必要としないアプリのナレッジ ワーカーなど、同じ組織のユーザーは、Windows 10 Enterprise マルチセッションのようなマルチセッション リモート デスクトップ セッション ホストの候補として最適です。 これらのセッション ホストでは、1 つの OS のオーバーヘッド コストのみで複数のユーザーが 1 つの VM を共有できるため、組織のコストが削減されます。 FSLogix などのプロファイル テクノロジを使用すると、サービスの中断に気づくことなく、ホスト プール内の任意の VM をユーザーに割り当てることができます。 また、この機能を使用すると、オフピーク時間中に VM をシャットダウンするなどの操作を行うことにより、コストを最適化できます。

さまざまな組織のユーザーがデプロイに接続する必要がある場合は、Active Directory や Azure AD のような ID サービス用に別個のテナントを用意することをお勧めします。 さらに、Azure Virtual Desktop や VM などの Azure リソースをホストするために別個のサブスクリプションを用意することもお勧めします。

次の表に、各シナリオの推奨事項を示します。

| 信頼レベルのシナリオ                                 | 推奨される解決策                |
|------------------------------------------------------|-------------------------------------|
| 標準の特権を持つ 1 つの組織のユーザーである | Windows 10 (Enterprise マルチセッション) |
| ユーザーに管理者特権が必要である             | 個人用デスクトップ (VDI)             |
| さまざまな組織のユーザーが接続する        | 別個の Azure サブスクリプション         |

いくつかのシナリオ例での推奨事項を見てみましょう。

### <a name="should-i-share-identity-resources-to-reduce-costs"></a>コストを削減するために ID リソースを共有するべきでしょうか?

現時点では、Azure Virtual Desktop で共有 ID システムを使用することはお勧めできません。 別個の Azure サブスクリプションにデプロイする別個の ID リソースを用意することをお勧めします。 これらのリソースには、Active Directory、Azure AD、VM ワークロードが含まれます。 個々の組織で働くすべてのユーザーには、追加のインフラストラクチャと、関連するメンテナンス コストが必要になりますが、セキュリティの目的を達成するためには、現時点では、これが最も実現可能なソリューションです。 

### <a name="should-i-share-a-multi-session-remote-desktop-rd-session-host-vm-to-reduce-costs"></a>コストを削減するために、マルチセッション リモート デスクトップ (RD) セッション ホスト VM を共有すべきでしょうか?

マルチセッション RD セッション ホストでは、CPU やメモリなどのハードウェア リソースをユーザー間で共有することによってコストを削減します。 このリソース共有を使用することで、すべてのユーザーが同時に最大のリソースを必要とする可能性が低い場合でも、ピーク時の容量に合わせて設計できます。 共有マルチセッション環境では、ハードウェア リソースは、使用量とコストのギャップが少なくなるように、共有されて割り当てられます。

多くの場合、マルチセッションの使用は、コストを削減するために容認できる方法ですが、それが推奨されるかどうかは、共有マルチセッション インスタンスに同時にアクセスできるユーザー間の信頼レベルによって決まります。 通常、同じ組織に属するユーザーには、十分かつ合意された信頼関係があります。 たとえば、ユーザーが共同作業を行い、お互いの個人情報にアクセスできる部門やワークグループは、信頼レベルが高い組織です。

Windows では、セキュリティ境界とコントロールを使用して、ユーザー プロセスとデータがセッション間で分離されるようにしています。 ただし、Windows では、ユーザーが作業しているインスタンスへのアクセス権は引き続き提供されます。

このデプロイには、組織内外のユーザーが他のユーザーの個人情報に未承認でアクセスできないようにするセキュリティ境界をさらに追加する、多層セキュリティ戦略を使用することをお勧めします。 未承認のデータ アクセスは、未公開のセキュリティの脆弱性や、まだ修正プログラムが適用されていない既知の脆弱性など、システム管理者による構成プロセスのエラーが原因で発生します。

一方、Microsoft では、異なるまたは競合する企業で働くユーザーに、同じマルチセッション環境へのアクセス権を付与することはサポートしていません。 これらのシナリオには、ネットワーク、カーネル、プロセス、ユーザー、セッションなど、攻撃または悪用される可能性があるいくつかのセキュリティ境界があります。 1 つのセキュリティの脆弱性によって、無許可のデータと資格情報の窃盗、個人情報の漏洩、なりすまし、およびその他の問題が発生する可能性があります。 仮想化環境のプロバイダーには、複数の強力なセキュリティ境界と追加の安全性機能が可能な限り有効化された、適切に設計されたシステムを提供する責任があります。

これらの潜在的な脅威を減らすには、フォールトプルーフ構成、パッチ管理設計プロセス、および定期的なパッチ デプロイ スケジュールが必要です。 多層防御の原則に従い、環境を分離することをお勧めします。

## <a name="next-steps"></a>次のステップ

Azure Virtual Desktop のデプロイ用にセキュリティを構成するための推奨ガイドラインについては、「[セキュリティの運用方法](./../security-guide.md)」を参照してください。