---
title: Bicep ファイルの開発時のベスト プラクティスを確認する
description: 適切に機能し、管理しやすい Bicep ファイルを作成する際に従うべき手法について説明します。
author: johndowns
ms.author: jodowns
ms.topic: conceptual
ms.date: 11/02/2021
ms.openlocfilehash: d9639e3aab33df9fdc6e27ed3650f252d5dc1789
ms.sourcegitcommit: 0415f4d064530e0d7799fe295f1d8dc003f17202
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/17/2021
ms.locfileid: "132716889"
---
# <a name="best-practices-for-bicep"></a>Bicep に関するベスト プラクティス

この記事では、Bicep ファイルの開発時に従うべき手法を推奨します。 これらの手法により、Bicep ファイルを簡単に理解して使用できるようになります。

### <a name="microsoft-learn"></a>Microsoft Learn

Bicep のベスト プラクティスの詳細とハンズオン ガイダンスについては、**Microsoft Learn** で「[コラボレーションのための Bicep コードの構築](/learn/modules/structure-bicep-code-collaboration/)」を参照してください。

## <a name="parameters"></a>パラメーター

* パラメーター宣言には、適切な名前付けを使用してください。 適切な名前にすると、読みやすく理解しやすいテンプレートになります。 明確でわかりやすい名前を使用し、名前付けの一貫性を保ってください。

* テンプレートで使用するパラメーターは慎重に検討してください。 デプロイによって変わる設定には、パラメーターを使用してみてください。 変数やハードコーディングされた値は、デプロイによって変わらない設定に使用できます。

* 使用する既定値には注意してください。 既定値はすべてのユーザーが安全にデプロイできるものにします。 たとえば、テスト環境にテンプレートをデプロイする人が不必要に大きなコストを負担しないように、低コストな価格レベルと SKU を使用することを検討します。

* `@allowed` デコレーターの使用は控えめにしてください。 このデコレーターを広く使用すると、有効なデプロイがブロックされる可能性があります。 Azure サービスによって SKU とサイズが追加されると、許可リストが最新の状態でなくなる可能性があります。 たとえば、Premium v3 SKU だけを許可することは運用環境では意味がありますが、運用環境以外では同じテンプレートを使用できなくなります。

* パラメーターには説明を記述することをお勧めします。 説明が役に立つようにして、テンプレートに必要なパラメーター値をどのようなものにするべきかという内容に関する重要な情報を記述してください。

  情報のために `//` コメントを使用することもできます。

* パラメーター宣言は、テンプレート ファイルのどこにでも書くことができますが、通常は Bicep のコードを読みやすくするために、ファイルの先頭に書くのが良いでしょう。

* 名前付けを制御するパラメーターには最小と最大の文字数を指定することをお勧めします。 これらの制限により、後でデプロイ中にエラーが発生するのを防ぐことができます。

Bicep パラメーターの詳細については、「[Bicep のパラメーター](parameters.md)」を参照してください。

## <a name="variables"></a>変数

* 変数を定義する場合、[データ型](data-types.md)は不要です。 変数は解決値から型を推論します。

* Bicep 関数を使用すると、変数を作成できます。

* Bicep ファイルに変数が定義された後で、変数の名前を使用して値を参照します。

Bicep 変数の詳細については、「[Bicep の変数](variables.md)」を参照してください。

## <a name="names"></a>名前

* 名前にはローワー キャメル ケース (最初の単語の先頭が小文字) を使用します (例: `myVariableName` または `myResource`)。

* [uniqueString() 関数](bicep-functions-string.md#uniquestring)は、グローバルに一意のリソース名を作成する場合に便利です。 同じパラメーターを指定すると、毎回同じ文字列が返されます。 リソース グループ ID を渡すことは、同じリソース グループに対するどのデプロイでも文字列が同じであり、異なるリソース グループまたはサブスクリプションにデプロイする場合は文字列が異なることを意味します。

* `uniqueString()` 関数によって、数字で始まる文字列が作成される場合があります。 一部の Azure リソース (ストレージ アカウントなど) では、数字で始まる名前を使用することはできません。 この要件により、文字列補間を使用してリソース名を作成することをお勧めします。 一意の文字列にプレフィックスを追加できます。

* 多くの場合、テンプレート式を使用してリソース名を作成することをお勧めします。 多くの Azure リソースの種類には、許可される文字と名前の長さに関する規則があります。 テンプレートにリソース名の作成を埋め込むと、そのテンプレートを使用するすべてのユーザーが、これらの規則自体に従うことを覚えている必要はありません。

* シンボリック名に `name` を使用しないでください。 シンボリック名はリソースの名前ではなくリソースを表します。 たとえば、次のようにするのではなく、

  ```bicep
  resource cosmosDBAccountName 'Microsoft.DocumentDB/databaseAccounts@2021-04-15' = {
  ```

  次のようにします。

  ```bicep
  resource cosmosDBAccount 'Microsoft.DocumentDB/databaseAccounts@2021-04-15' = {
  ```

* サフィックスを使用して変数とパラメーターを区別しないでください。

## <a name="resource-definitions"></a>リソース定義

* 複雑な式をリソース プロパティに直接埋め込む代わりに、変数を使用して式を格納します。 この方法により、Bicep ファイルが読みやすく、理解しやすくなります。 ロジックを使用してリソース定義が煩雑にならないようにします。

* リソースの動作について推測するのではなく、リソースのプロパティを出力として使用してみてください。 たとえば、App Service アプリへの URL の出力が必要な場合は、URL の文字列を自分で作成するのではなく、アプリの defaultHostname プロパティを使用します。 環境によっては、これらの前提条件が適切でない場合や、リソースの動作が変化する場合があります。 リソースには独自のプロパティを指定する方が安全です。

* リソースごとに最新の API バージョンを使用することをお勧めします。 Azure サービスの新機能は、新しい API バージョンでのみ使用できる場合があります。

* 可能であれば、Bicep ファイルで [reference](./bicep-functions-resource.md#reference) と [resourceId](./bicep-functions-resource.md#resourceid) 関数を使用しないようにしてください。 シンボリック名を使用して、Bicep 内の任意のリソースにアクセスできます。 たとえば、シンボリック名 toyDesignDocumentsStorageAccount を使用してストレージ アカウントを定義する場合は、式 `toyDesignDocumentsStorageAccount.id` を使用してそのリソース ID にアクセスできます。 シンボリック名を使用することで、リソース間に暗黙的な依存関係が作成されます。

* 明示的な依存関係よりも暗黙的な依存関係を優先的に使用してください。 `dependsOn` リソース プロパティを使用すると、リソース間の明示的な依存関係を宣言できますが、通常であれば、他のリソースのシンボリック名を使用すればそのリソースを使用できます。 これによって、2 つのリソース間に暗黙の依存関係が作成され、Bicep で関係自体を管理できるようになります。

* リソースが Bicep ファイルにデプロイされていない場合でも、`existing` キーワードを使用してリソースへのシンボリック参照を取得することができます。

## <a name="child-resources"></a>子リソース

* 入れ子の階層が深くなりすぎないようにしてください。 入れ子の階層が深すぎると、Bicep コードが読みにくくなり、操作も難しくなります。

* 子リソースのリソース名を作成しなでください。 Bicep がリソース間の関係を理解する場合に提供される利点が失われます。 代わりに `parent` プロパティまたは入れ子を使用します。

## <a name="outputs"></a>出力

* 機密データについては出力を作成しないでください。 出力値は、デプロイ履歴にアクセスできるユーザーであれば誰でもアクセスできます。 こういったものは、シークレットの処理には適していません。

* 出力を介してプロパティ値を渡すのではなく、[既存のキーワード](resource-declaration.md#existing-resources)を使用して、既存のリソースのプロパティを検索します。 出力を介してキーを渡すのではなく、この方法で他のリソースからキーを参照するのがベスト プラクティスです。 常に最新のデータが取得されます。

Bicep の出力の詳細については、「[Bicep の出力](outputs.md)」を参照してください。

## <a name="tenant-scopes"></a>テナント スコープ

[テナント スコープ](deploy-to-tenant.md)でポリシーまたはロールの割り当てを作成することはできません。 ただし、組織全体にアクセス権を付与したり、ポリシーを適用したりする必要がある場合は、このようなリソースをルート管理グループにデプロイすることができます。

## <a name="next-steps"></a>次のステップ

* Bicep の概要については、[Bicep のクイックスタート](quickstart-create-bicep-use-visual-studio-code.md)に関する記事を参照してください。
* Bicep ファイルの構成要素については、「[Bicep ファイルの構造と構文について](file.md)」を参照してください。
