---
title: チュートリアル:Azure portal を使用してリージョン間ロード バランサーを作成する
titleSuffix: Azure Load Balancer
description: このチュートリアルでは、Azure portal を使用してリージョン間 Azure ロード バランサーのデプロイを開始します。
author: asudbring
ms.author: allensu
ms.service: load-balancer
ms.topic: tutorial
ms.date: 08/02/2021
ms.openlocfilehash: f0004845033493dc7546bb3af467918ea77ebcad
ms.sourcegitcommit: 47491ce44b91e546b608de58e6fa5bbd67315119
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/16/2021
ms.locfileid: "122201622"
---
# <a name="tutorial-create-a-cross-region-azure-load-balancer-using-the-azure-portal"></a>チュートリアル:Azure portal を使用してリージョン間 Azure ロード バランサーを作成する

リージョン間ロード バランサーを使うと、サービスが複数の Azure リージョンにわたってグローバルに利用可能になります。 1 つのリージョンで障害が発生した場合、トラフィックは次の最も近い正常なリージョンのロード バランサーにルーティングされます。  

このチュートリアルでは、以下の内容を学習します。

> [!div class="checklist"]
> * リージョン間ロード バランサーを作成します。
> * 2 つのリージョン ロード バランサーを含むバックエンド プールを作成します。
> * ロード バランサー規則を作成します。
> * ロード バランサーをテストします。

Azure サブスクリプションがない場合は、開始する前に[無料アカウント](https://azure.microsoft.com/free/?WT.mc_id=A261C142F)を作成してください。

> [!IMPORTANT]
> リージョンをまたがる Azure Load Balancer は、現在パブリック プレビューの段階にあります。
> このプレビュー バージョンはサービス レベル アグリーメントなしで提供されています。運用環境のワークロードに使用することはお勧めできません。 特定の機能はサポート対象ではなく、機能が制限されることがあります。 詳しくは、[Microsoft Azure プレビューの追加使用条件](https://azure.microsoft.com/support/legal/preview-supplemental-terms/)に関するページをご覧ください。

## <a name="prerequisites"></a>前提条件

- Azure サブスクリプション。
- 2 つの異なる Azure リージョンにデプロイされたバックエンド プールを備えた 2 つの **Standard** SKU Azure ロード バランサー。
    - バックエンド プール用にリージョンの Standard ロード バランサーと仮想マシンを作成する方法については、「[クイックスタート: Azure portal を使用して、VM の負荷分散を行うパブリック ロード バランサーを作成する](quickstart-load-balancer-standard-public-portal.md)」を参照してください。
        - 各リージョンのロード バランサー、仮想マシン、その他のリソースの名前の末尾に、**R1** と **-R2** を追加します。 

## <a name="sign-in-to-azure-portal"></a>Azure Portal にサインインする

Azure portal に[サインイン](https://portal.azure.com)します。

## <a name="create-cross-region-load-balancer"></a>リージョン間ロード バランサーを作成する

このセクションでは、以下のものを作成します。 

* リージョン間のロード バランサー
* グローバル パブリック IP アドレスを持つフロントエンド
* 2 つのリージョン ロード バランサーを含むバックエンド プール

> [!IMPORTANT]
> これらの手順を完了するには、2 つのリージョン ロード バランサーとバックエンド プールを自分のサブスクリプションにデプロイしておく必要があります。  詳細については、「 **[クイックスタート: Azure portal を使用して、VM の負荷分散を行うパブリック ロード バランサーを作成する](quickstart-load-balancer-standard-public-portal.md)** 」を参照してください。

1. ポータルの上部にある検索ボックスに、「**ロード バランサー**」と入力します。 検索結果で **[ロード バランサー]** を選択します。

2. **[ロード バランサー]** ページで、 **[作成]** を選択します。

3. **[ロード バランサーの作成]** ページの **[基本]** タブで、次の情報を入力または選択します。 

    | 設定                 | 値                                              |
    | ---                     | ---                                                |
    | **プロジェクトの詳細** |    |
    | サブスクリプション               | サブスクリプションを選択します。    |    
    | Resource group         | **[新規作成]** を選択し、テキスト ボックスに「**CreateCRLBTutorial-rg**」と入力します。 |
    | **インスタンスの詳細** |   |
    | Name                   | 「**myLoadBalancer-CR**」と入力します                                   |
    | リージョン         | **[(米国) 米国西部]** を選択します。                                        |
    | Type          | **[パブリック]** を選択します。                                        |
    | SKU           | 規定値である **[標準]** のままにします。 |
    | レベル           | **[グローバル]** を選択します |

    :::image type="content" source="./media/tutorial-cross-region-portal/create-cross-region.png" alt-text="リージョン間ロード バランサーを作成する" border="true":::
  
4. ページ下部にある **[次へ: フロントエンド IP の構成]** を選択します。

5. **[フロントエンド IP 構成]** で、 **[+ フロントエンド IP の追加]** を選択します。

6. **[フロントエンド IP アドレスの追加]** で **[名前]** に「**LoadBalancerFrontend**」と入力します。

7. **[IP バージョン]** には **[IPv4]** または **[IPv6]** を選択します。

8. **[パブリック IP アドレス]** で、 **[新規作成]** を選択します｡ **[名前]** に「**myPublicIP-cr**」と入力します。  **[OK]** を選択します。

9. **[追加]** を選択します。

10. ページ下部で **[次へ: バックエンド プール]** を選択します。

11. **[バックエンド プール]** で、 **[+ バックエンド プールの追加]** を選択します。

12. **[バックエンド プールの追加]** の **[名前]** に「**myBackendPool-cr**」と入力します。

13. **ロード バランサー** で、**ロード バランサー** のプルダウン ボックスから **myLoadBalancer-r1** または最初のリージョン ロード バランサーを選択します。 **[フロントエンド IP 構成]** と **[IP アドレス]** が **myLoadBalancer-r1** に対応していることを確認します。

14. **[ロード バランサー]** のプルダウン ボックスで、 **[myLoadBalancer-r2]** または 2 番目のリージョン ロード バランサーを選択します。 **[フロントエンド IP 構成]** と **[IP アドレス]** が **myLoadBalancer-r2** に対応していることを確認します。

15. **[追加]** を選択します。

16. ページ下部にある **[次へ: インバウンド規則]** を選択します。

17. **[インバウンド規則]** で、 **[+ 負荷分散規則の追加]** を選択します。

18. **[負荷分散規則の追加]** で、次の情報を入力または選択します。

    | 設定 | 値 |
    | ------- | ----- |
    | Name | 「**myHTTPRule-cr**」と入力します。 |
    | IP バージョン | **[IP バージョン]** には **[IPv4]** または **[IPv6]** を選択します。 |
    | フロントエンド IP アドレス | **[LoadBalancerFrontend]** を選択します。 |
    | Protocol | **[TCP]** を選択します。 |
    | Port | 「**80**」と入力します。 |
    | バックエンド プール | **[myBackendPool-cr]** を選択します。 |
    | セッション永続化 | **[なし]** を選択します。 |
    | アイドル タイムアウト (分) | 「**15**」と入力するか、スライダーをその値まで移動します。 |
    | TCP リセット | **[Enabled]** を選択します。 |
    | フローティング IP | 既定値の **[無効]** のままにします。 |

19. **[追加]** を選択します。

20. ページ下部にある **[確認と作成]** を選択します。

21. **[確認と作成]** タブの **[作成]** を選択します。

    > [!NOTE]
    > リージョン間ロード バランサーは、次のホーム リージョンにのみデプロイできます。**米国東部 2、米国西部、西ヨーロッパ、東南アジア、米国中部、北ヨーロッパ、東アジア**。 詳細については、**https://aka.ms/homeregionforglb** をご覧ください。

## <a name="test-the-load-balancer"></a>ロード バランサーをテストする

このセクションでは、リージョン間ロード バランサーをテストします。 Web ブラウザーで、パブリック IP アドレスに接続します。  いずれかのリージョン ロード バランサーのバックエンド プールにある仮想マシンを停止し、フェールオーバーを観察します。

1. **[概要]** 画面で、ロード バランサーのパブリック IP アドレスを見つけます。 左側のメニューで **[すべてのサービス]** 、 **[すべてのリソース]** の順に選択し、 **[myPublicIP-CR]** を選択します。

2. そのパブリック IP アドレスをコピーし、ブラウザーのアドレス バーに貼り付けます。 IIS Web サーバーの既定のページがブラウザーに表示されます。

    :::image type="content" source="./media/tutorial-cross-region-portal/test-cr-lb-1.png" alt-text="ロード バランサーをテストする" border="true":::

3. いずれかのリージョン ロード バランサーのバックエンド プールにある仮想マシンを停止します。

4. Web ブラウザーを最新の状態に更新し、別のリージョン ロード バランサーへの接続のフェールオーバーを観察します。

    :::image type="content" source="./media/tutorial-cross-region-portal/test-cr-lb-2.png" alt-text="フェールオーバー後のロード バランサーをテストする" border="true":::

## <a name="clean-up-resources"></a>リソースをクリーンアップする

リソース グループ、ロード バランサー、および関連するすべてのリソースは、不要になったら削除します。 

これを行うには、これらのリソースを含むリソース グループ (**CreateCRLBTutorial-rg**) を選択し、 **[削除]** を選択します。

## <a name="next-steps"></a>次の手順

このチュートリアルでは、次の作業を行いました。

* リージョン間ロード バランサーを作成しました。
* リージョン間ロード バランサーのバックエンド プールにリージョン ロード バランサーを追加しました。
* 負荷分散規則を作成しました。
* ロード バランサーをテストしました。

リージョン間ロード バランサーの詳細については、次を参照してください。
> [!div class="nextstepaction"]
> [リージョン間ロード バランサー (プレビュー)](cross-region-overview.md)
