---
title: App Service Environment の概要
description: App Service Environment の概要
author: madsd
ms.topic: overview
ms.date: 11/15/2021
ms.author: madsd
ms.custom: references_regions
ms.openlocfilehash: 7530925ac23d8b6a25d5d74cdf5a6531cddb0edf
ms.sourcegitcommit: 2ed2d9d6227cf5e7ba9ecf52bf518dff63457a59
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/16/2021
ms.locfileid: "132524020"
---
# <a name="app-service-environment-overview"></a>App Service Environment の概要

> [!NOTE]
> これは、Isolated v2 App Service プランで使用される App Service Environment v3 に関する記事です
> 

Azure App Service Environment は、App Service アプリを大規模かつ安全に実行するために完全に分離された専用の環境を提供する、Azure App Service の機能です。 この機能は、以下をホストできます。

- Windows Web アプリ
- Linux Web アプリ
- Docker コンテナー (Windows と Linux)
- 関数
- ロジック アプリ (Standard)

App Service Environment (ASE) は、以下を必要とするアプリケーション ワークロードに最適です。

- 高スケール。
- 分離およびセキュリティで保護されたネットワーク アクセス。
- 高いメモリ使用率。
- 高い RPS (Requests Per Second: 1 秒あたりの要求数)。 複数の ASE を 1 つの Azure リージョン内に作成することも、複数の Azure リージョンにわたって作成することもできます。 この柔軟性により、ASE は、RPS 要件の厳しいステートレス アプリケーションの水平方向のスケーリングに最適です。

ASE では、単一の顧客のアプリケーションは仮想ネットワークの 1 つでホストされます。 顧客は、受信と送信の両方のアプリケーション ネットワーク トラフィックをきめ細かく制御することができます。 アプリケーションは VPN を介した、オンプレミスの企業リソースへのセキュリティで保護された高速な接続を確立することができます。

## <a name="usage-scenarios"></a>使用シナリオ

App Service Environment には、次のようなさまざまなユース ケースがあります。

- 内部基幹業務アプリケーション
- 30 以上の App Service プラン インスタンスを必要とするアプリケーション
- 内部のコンプライアンスまたはセキュリティ要件を満たすための単一のテナント システム
- ネットワーク分離アプリケーションのホスト
- 多層アプリケーション

マルチテナント App Service 内のアプリをネットワーク分離リソースに接続したり、それ自体をネットワークから分離するためのネットワーク機能が多数あります。 これらの機能は、アプリケーション レベルで有効になります。 ASE を使えば、仮想ネットワークに配置するアプリに追加の構成が不要になります。 アプリは、仮想ネットワークに既に存在するネットワーク分離環境にデプロイされます。 ASE は、ネットワーク分離アプリのホストであるほか、単一のテナント システムでもあります。 ASE を使用する他の顧客は存在しません。 完全な分離環境が実際に必要な場合は、ASE を専用のハードウェアにデプロイすることもできます。

## <a name="dedicated-environment"></a>専用の環境

ASE は、仮想ネットワーク内で実行される Azure App Service のシングル テナント デプロイです。 

アプリケーションをホストするのは、App Service Environment 内に作成する App Service プランです。 この App Service プランは、つまるところアプリケーション ホストのプロビジョニング プロファイルです。 App Service プランをスケールアウトしていくと、アプリケーション ホストの数が増えていきます。各ホストでは、その App Service プラン内のアプリがすべてホストされます。 1 つの ASEv3 に作成できる App Service プラン インスタンスの数は、全 App Service プランの合計で最大 200 件です。 Isolated v2 App Service プランの場合には、1 つにつきインスタンスを 100 件まで作成できます。

## <a name="virtual-network-support"></a>Virtual Network のサポート

ASE 機能は、お客様の仮想ネットワークの中のサブネットの 1 つに Azure App Service をデプロイしたものです。 ASE にアプリをデプロイすると、そのアプリが ASE に割り当てられている受信アドレスで公開されます。 デプロイした ASE に割り当てられているのが内部仮想 IP (VIP) の場合には、その ASE サブネット内のアドレスの 1 つが、全部のアプリに共通する受信アドレスとなります。 デプロイした ASE に割り当てられているのが外部 VIP の場合には、受信アドレスはアドレス可能なインターネット アドレスとなり、アプリはパブリック DNS に登録されます。

サブネット内で ASEv3 が使用するアドレスの数は、インスタンスの数とトラフィックの量によって異なります。 一部のインフラストラクチャ ロールでは、App Service プランの数とその負荷に応じて自動でスケーリングが発生します。 ASEv3 のサブネットに推奨されるサイズは、`/24` の CIDR ブロック (アドレス数: 256) です。このサイズであれば、最大限スケールアウトした ASEv3 であってもホストが可能です。

ASE 内のアプリは、特に何か機能を有効にしておかなくても、その ASE がデプロイされている仮想ネットワーク内のリソースにアクセスすることができます。 ASE の仮想ネットワークが別のネットワークに接続されている場合には、その ASE 内のアプリがそのネットワーク内のリソースにアクセスできます。 トラフィックのブロックは、ネットワークのユーザー構成で行うことができます。

マルチテナント バージョンの Azure App Service には、アプリをさまざまなネットワークに接続できる機能が多数用意されています。 これらのネットワーク機能を使用すると、あたかも単体の仮想ネットワークにデプロイしたかのような動作をアプリに実現できます。 ASEv3 内にデプロイしたアプリの場合には、仮想ネットワークにデプロイするための構成が一切必要ありません。 マルチテナント サービスではなく ASE を使用する利点は、ASE ではホストするアプリに対するネットワーク アクセス制御が、アプリケーション構成の外部に置かれるという点です。 マルチテナント サービス内のアプリでは、アプリ単位で機能を有効にし、RBAC またはポリシーを使用して構成の変更を防ぐ必要があります。

## <a name="feature-differences"></a>機能の違い

ASEv3 を以前のバージョンの ASE と比較すると、いくつかの点で違いがあります。 ASEv3 の場合、

- お客様の仮想ネットワークにネットワーキング関連の依存関係がありません。 受信と送信の一切に必要に応じたセキュリティ保護が可能です。 このほか、送信トラフィックを必要に応じてルーティングすることも可能です。 
- ゾーン冗長を有効にしてデプロイできます。 ゾーン冗長は、ASEv3 作成中のタイミングで、かつ、ASEv3 の依存関係のすべてがゾーン冗長になっているリージョンの場合に限り設定できます。 
- 専用のホスト グループにデプロイできます。 ホスト グループに対するデプロイはゾーン冗長ではありません。 
- スケーリングが、ASEv2 よりもはるかに高速です。 依然としてマルチテナント サービスほどではありませんが、それでも格段に高速になりました。
- フロントエンドのスケーリング調整が不要になりました。 ASEv3 のフロントエンドはニーズに合わせて自動的にスケーリングされ、より優れたホストにデプロイされます。 
- スケーリングの際にその ASEv3 インスタンス内の他のスケーリング操作がブロックされることがなくなりました。 スケーリング操作は、OS とサイズの組み合わせ 1 つにつき 1 件のみ有効になります。 たとえば、Windows 小の App Service プランでスケーリングを実行している間に、同時に Windows 中 (ほか、Windows 小以外であれば何でもかまいません) でスケーリング操作を開始することができます。 
- 内部 VIP の ASEv3 内のアプリに、グローバル ピアリングによりアクセスできます。 以前のバージョンでは、グローバル ピアリングによるアクセスは不可能でした。

ASEv3 では、以前のバージョンの ASE で利用できた機能のいくつかが利用できなくなっています。 ASEv3 でできないことは次のとおりです。

- SMTP トラフィックを送信する。 電子メールによってトリガーされるアラートは引き続き使用できますが、アプリがポート 25 経由で送信トラフィックを送信することはできません
- FTP を使用してアプリをデプロイする
- アプリにリモート デバッグを使用する
- ASEv2 からアップグレードする
- Network Watcher または NSG フローを使用してトラフィックを監視する
- アプリに IP ベースの TLS/SSL バインドを構成する
- カスタム ドメイン サフィックスを構成する

## <a name="pricing"></a>価格

ASEv3 では、ASE のデプロイの種類に応じて価格モデルが異なります。 価格モデルには次の 3 つがあります。

- **ASEv3**: ASE が空の場合には、Windows I1v2 のインスタンスが 1 件あるものとして料金が発生します。 このインスタンス 1 件分の料金は、ASE が空の場合にのみ適用されるもので、そうでない場合に追加で発生することはありません。
- **ゾーン冗長 ASEv3**: 9 つのインスタンスの最小料金が発生します。 App Service プランのインスタンスが 9 件以上ある場合でも、可用性ゾーンのサポートのための追加料金は発生しません。 ゾーン冗長 ASE の App Service プラン全体で使用しているインスタンス (任意のサイズ) が 9 つ未満の場合、9 と実行中のインスタンス数の差が、追加の Windows I1v2 インスタンスとして課金されます。
- **専用ホスト ASEv3**: 専用ホストのデプロイでは、ASEv3 の作成時に Microsoft の価格設定に従って専用ホスト 2 つ分の料金が発生したうえで、その後はスケーリング時に Isolated V2 の 1 コアあたりの料金の数 % が発生します。

Isolated v2 の予約インスタンスの料金が利用可能です。詳細は、[Azure App Service に予約割引を適用する方法](../../cost-management-billing/reservations/reservation-discount-app-service.md)に関するページで説明されています。 料金については、予約インスタンスの料金と共に、「[App Service の料金](https://azure.microsoft.com/pricing/details/app-service/windows/)」の **Isolated v2 プラン** で確認できます。

## <a name="regions"></a>リージョン

ASEv3 は、次のリージョンで使用できます。

|通常および専用ホスト ASEv3 のリージョン|AZ ASEv3 のリージョン|
|---------------------------------------|------------------|
|オーストラリア東部|オーストラリア東部|
|オーストラリア南東部|ブラジル南部|
|ブラジル南部|カナダ中部|
|カナダ中部|米国中部|
|インド中部|米国東部|
|米国中部|米国東部 2|
|東アジア|フランス中部|
|米国東部|ドイツ中西部|
|米国東部 2|東日本|
|フランス中部|北ヨーロッパ|
|ドイツ中西部|米国中南部|
|東日本|東南アジア|
|韓国中部|英国南部|
|米国中北部|西ヨーロッパ|
|北ヨーロッパ|米国西部 2|
|ノルウェー東部| |
|南アフリカ北部| |
|米国中南部| |
|東南アジア| |
|スイス北部| |
|アラブ首長国連邦北部| |
|英国南部| |
|英国西部| |
|米国中西部| |
|西ヨーロッパ| |
|米国西部| |
|米国西部 2| |
|米国西部 3| |
|US Gov テキサス| |
|US Gov アリゾナ| |
|US Gov バージニア州| |

## <a name="app-service-environment-v2"></a>App Service Environment v2

App Service Environment には、ASEv1、ASEv2、および ASEv3 の 3 つのバージョンがあります。 前述の情報は ASEv3 に基づいていました。 ASEv2 について詳しくは、[App Service Environment v2 の概要](./intro.md)に関するページを参照してください。
