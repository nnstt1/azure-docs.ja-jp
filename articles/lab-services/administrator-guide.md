---
title: 管理者ガイド | Microsoft Docs
description: このガイドは、Azure Lab Services を使用してラボ アカウントを作成および管理する管理者に役立ちます。
ms.topic: how-to
ms.date: 10/20/2020
ms.openlocfilehash: 698b6ddb6474031e7d19f2029156197b7d6a7741
ms.sourcegitcommit: 92889674b93087ab7d573622e9587d0937233aa2
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/19/2021
ms.locfileid: "130177272"
---
# <a name="azure-lab-services---administrator-guide"></a>Azure Lab Services - 管理者ガイド
大学のクラウド リソースを管理する情報技術 (IT) 管理者は、通常、学校のラボ アカウントの設定を担当します。 管理者または教師は、ラボ アカウントを設定した後、アカウント内に含まれるラボを作成します。 この記事では、関連する Azure リソースの概要を説明し、それらを作成するためのガイダンスを示します。

![ラボ アカウント内の Azure リソースの概要図。](./media/administrator-guide/high-level-view.png)

- ラボは、Azure Lab Services によって所有される Azure サブスクリプション内でホストされます。
- ラボ アカウント、共有イメージ ギャラリー、イメージ バージョンは、ご利用のサブスクリプション内でホストされます。
- ラボ アカウントと共有イメージ ギャラリーは、同じリソース グループに含めることができます。 この図では、これらは異なるリソース グループに含まれています。

このアーキテクチャの詳細については、[ラボのアーキテクチャの基礎](./classroom-labs-fundamentals.md)に関する記事を参照してください。

## <a name="subscription"></a>サブスクリプション
大学は 1 つ以上の Azure サブスクリプションを持っている場合があります。 サブスクリプションを使用して、ラボ アカウントなど、サブスクリプション内で使用されるすべての Azure リソースおよびサービスの課金とセキュリティを管理します。

次の理由から、ラボ アカウントとそのサブスクリプションの関係は重要です。

- 課金は、ラボ アカウントを含むサブスクリプションを通じて報告されます。
- サブスクリプションの Azure Active Directory (Azure AD) テナント内のユーザーに、Azure Lab Services へのアクセス権を付与できます。 ユーザーをラボ アカウントの所有者または共同作成者、ラボ作成者、またはラボ所有者として追加できます。

ラボとその仮想マシン (VM) は、Azure Lab Services によって所有されるサブスクリプション内で管理およびホストされます。

## <a name="resource-group"></a>Resource group
サブスクリプションには、1 つ以上のリソース グループが含まれます。 リソース グループを使用して、同じソリューション内で一緒に使用される Azure リソースの論理グループを作成します。  

ラボ アカウントを作成するときには、そのラボ アカウントを含むリソース グループを構成する必要があります。 

リソース グループは、[共有イメージ ギャラリー](#shared-image-gallery)を作成するときにも必要となります。 ラボ アカウントと共有イメージ ギャラリーは、同一のリソース グループ内または 2 つの個別のリソース グループ内に配置できます。 イメージ ギャラリーをさまざまなソリューション間で共有する予定がある場合は、2 番目の方法を使用することをお勧めします。

ラボ アカウントを作成するときに、同時に共有イメージ ギャラリーを自動的に作成してアタッチできます。  このオプションにより、ラボ アカウントと共有イメージ ギャラリーが異なるリソース グループに作成されます。 この動作は、[共有イメージ ギャラリーをラボ アカウントの作成時に構成する](how-to-attach-detach-shared-image-gallery.md#configure-at-the-time-of-lab-account-creation)ためのチュートリアルで説明されている手順に従う場合に見られます。 この記事の最初の図では、この構成を使用しています。 

ラボ アカウントまたは共有イメージ ギャラリーのリソース グループは、作成後に変更 "*できない*" ため、事前に時間をかけてリソース グループの構造を計画することをお勧めします。 これらのリソースのリソース グループを変更する必要がある場合は、ラボ アカウントまたは共有イメージ ギャラリーを削除して再作成する必要があります。

## <a name="lab-account"></a>ラボ アカウント

ラボ アカウントは、1 つ以上のラボのコンテナーとして機能します。 Azure Lab Services の使用を開始するときは、ラボ アカウントを 1 つ用意するのが最も一般的です。 ラボの使用をスケールアップするに従って、追加のラボ アカウントを後で作成することもできます。

複数のラボ アカウントが役立つ可能性のあるシナリオを以下に示します。

- **複数のラボのさまざまなポリシー要件を管理する**

    ラボ アカウントを設定するときは、ラボ アカウントの "*すべての*" ラボに適用される次のようなポリシーを設定します。
    - ラボでアクセスできる共有リソースがある Azure 仮想ネットワーク。 たとえば、仮想ネットワーク内の共有データ セットへのアクセスを必要とする一連のラボがある場合などがあります。
    - ラボで VM の作成に使用できる仮想マシン (VM) イメージ。 たとえば、[Data Science VM for Linux](https://azuremarketplace.microsoft.com/marketplace/apps/microsoft-dsvm.ubuntu-1804) Azure Marketplace イメージへのアクセスを必要とする一連のラボがある場合などがあります。

    各ラボに固有のポリシー要件がある場合は、各ラボを個別に管理するために個別のラボ アカウントを作成すると有益な場合があります。

- **各ラボに個別の予算を割り当てる**
  
    1 つのラボ アカウントを使用してすべてのラボのコストを報告するのではなく、予算をより明確に分配することが必要な場合があります。 たとえば、大学の数学部、コンピューター サイエンス学部などごとに個別のラボ アカウントを作成し、学部間で予算を分配することができます。  その後、[Azure Cost Management](../cost-management-billing/cost-management-billing-overview.md) を使用して、個々のラボ アカウントのコストを表示できます。

- **パイロット ラボをアクティブなまたは運用環境のラボから分離する**
  
    アクティブなまたは運用環境のラボに影響を与えることなく、ポリシーの変更をラボ アカウントに試験的に適用することが必要な場合があります。 この種のシナリオでは、パイロット用に別のラボ アカウントを作成することで変更を分離できます。 

## <a name="lab"></a>ラボ

ラボには、学生 1 人に 1 つずつ割り当てられた VM が含まれます。  一般に、次のことを想定できます。

- クラスごとに 1 つのラボがあります。
- 使用している学期、四半期、またはその他の履修制度ごとに、新しいラボのセットを作成します。 同じイメージを使用する必要があるクラスの場合は、[共有イメージ ギャラリー](#shared-image-gallery)を使用する必要があります。 こうすることで、ラボおよび学期間で、イメージを再利用できます。

ラボを構築する方法を決定する際には、次の点を考慮します。

- **ラボ内のすべての VM は、発行されている同じイメージを使用してデプロイされる**

    そのため、さまざまなラボ イメージを同時に発行する必要があるクラスがある場合は、イメージごとに個別のラボを作成する必要があります。
  
- **使用量クォータはラボ レベルで設定され、ラボ内のすべてのユーザーに適用される**

    この場合、ユーザーに異なるクォータを設定するには、個別のラボを作成する必要があります。 ただし、クォータを設定したら、特定のユーザーに対して時間を追加することができます。
  
- **起動またはシャットダウンのスケジュールはラボ レベルで設定され、ラボ内のすべての VM に適用される**

    クォータの設定と同様に、ユーザーに異なるスケジュールを設定する必要がある場合は、スケジュールごとに個別のラボを作成する必要があります。

既定では、ラボごとに独自の仮想ネットワークが設定されます。  仮想ネットワーク ピアリングが有効になっている場合、ラボごとに、指定の仮想ネットワークとピアリングされた独自のサブネットが設定されます。

## <a name="shared-image-gallery"></a>共有イメージ ギャラリー

共有イメージ ギャラリーはラボ アカウントにアタッチされ、イメージを保存するための中央リポジトリとして機能します。 教師がラボのテンプレート VM からエクスポートすることを選択すると、イメージがギャラリーに保存されます。 教師がテンプレート VM を変更してエクスポートするたびに、新しいイメージの定義とバージョンの一方または両方がギャラリーに作成されます。  

講師は、新しいラボを作成するときに、共有イメージ ギャラリーからイメージ バージョンを発行できます。 ギャラリーにはイメージの複数のバージョンが保存されますが、教師がラボの作成時に選択できるのは最新バージョンに限られます。  最新バージョンは、MajorVersion、MinorVersion、Patch の順で最高値に基づいて選択されます。  バージョン管理の詳細については、「[イメージ バージョン](../virtual-machines/shared-image-galleries.md#image-versions)」を参照してください。

Shared Image Gallery サービスはオプションのリソースであり、ごく少数のラボのみで開始する場合は、すぐに必要にならない可能性があります。 ただし、Shared Image Gallery には、追加のラボにスケールアップするときに役立つ多くの利点があります。

- **テンプレート VM イメージの複数のバージョンを保存して管理できる**

    カスタム イメージを作成したり、Azure Marketplace ギャラリーのイメージを変更 (ソフトウェア、構成など) したりする場合に便利です。  たとえば、教師が別のソフトウェアやツールをインストールする必要があることがよくあります。 これらの前提条件を各自が手動でインストールするよう学生に要求するのではなく、テンプレート VM イメージのさまざまなバージョンを共有イメージ ギャラリーにエクスポートできます。 この後、新しいラボを作成するときに、これらのイメージ バージョンを使用できます。

- **ラボ間でテンプレート VM イメージを共有または再利用できる**

    新しいラボを作成するたびに最初から構成しなくて済むように、イメージを保存して再使用できます。 たとえば、複数のクラスで同じイメージを使用する必要がある場合、そのイメージを 1 回作成し、共有イメージ ギャラリーにエクスポートすると、ラボ間で共有できるようになります。

- **ラボの外部にある他の環境から独自のカスタム イメージをアップロードできる**

    [ラボのコンテキストの外部にある他の環境からカスタム イメージをアップロードする](how-to-attach-detach-shared-image-gallery.md)ことができます。  たとえば、独自の物理ラボ環境や Azure VM から、共有イメージ ギャラリーにイメージをアップロードできます。  イメージをギャラリーにインポートすると、そのイメージを使用してラボを作成できます。

共有イメージを論理的にグループ化するには、次のいずれかの方法を使用できます。

- 複数の共有イメージ ギャラリーを作成します。 各ラボ アカウントで接続できる共有イメージ ギャラリーは 1 つに限られるため、このオプションでは複数のラボ アカウントを作成することも必要になります。
- 複数のラボ アカウントで共有される単一の共有イメージ ギャラリーを使用します。 この場合、各ラボ アカウントでは、そのアカウント内のラボに適用可能なイメージだけを有効にすることができます。

## <a name="naming"></a>名前を付ける

Azure Lab Services の使用を開始するときは、リソース グループ、ラボ アカウント、ラボ、共有イメージ ギャラリーの名前付け規則を確立することをお勧めします。 確立する名前付け規則は組織のニーズに固有のものになりますが、次の表に一般的なガイドラインを示します。

| リソースの種類 | Role | 提案されるパターン | 例 |
| ------------- | ---- | ----------------- | -------- | 
| Resource group | 1 つ以上のラボ アカウントと 1 つ以上の共有イメージ ギャラリーが含まれます。 | \<organization short name\>-\<environment\>-rg<ul><li>**組織の短い名前** は、リソース グループでサポートされる組織の名前を示します。</li><li>**環境** は、リソースの環境 ("*パイロット*" や "*運用*" など) を識別します。</li><li>**rg** は、リソースの種類 "*リソース グループ*" を表します。</li></ul> | contosouniversitylabs-rg<br/>contosouniversitylabs-pilot-rg<br/>contosouniversitylabs-prod-rg |
| ラボ アカウント | 1 つ以上のラボが含まれます。 | \<organization short name\>-\<environment\>-la<ul><li>**組織の短い名前** は、リソース グループでサポートされる組織の名前を示します。</li><li>**環境** は、リソースの環境 ("*パイロット*" や "*運用*" など) を識別します。</li><li>**la** は、リソースの種類 "*ラボ アカウント*" を表します。</li></ul> | contosouniversitylabs-la<br/>mathdeptlabs-la<br/>sciencedeptlabs-pilot-la<br/>sciencedeptlabs-prod-la |
| ラボ | 1 つ以上の VM が含まれます。 |\<class name\>-\<timeframe\>-\<educator identifier\><ul><li>**クラス名** は、ラボでサポートされるクラスの名前を識別します。</li><li>**期間** は、クラスが提供される期間を示します。</li>**教師識別子** は、ラボを所有する教師を識別します。</li></ul> | CS1234-fall2019-johndoe<br/>CS1234-spring2019-johndoe |
| 共有イメージ ギャラリー | 1 つ以上の VM イメージ バージョンが含まれます。 | \<organization short name\>gallery | contosouniversitylabsgallery |

他の Azure リソースの名前付けの詳細については、[Azure リソースの名前付け規則](/azure/architecture/best-practices/naming-conventions)に関する記事をご覧ください。

## <a name="regionslocations"></a>リージョン (場所)

Azure Lab Services のリソースを設定する場合、リソースをホストするデータ センターのリージョンまたは場所を指定する必要があります。 次のセクションでは、リージョンまたは場所が、ラボの設定に関係する各リソースに及ぼす可能性のある影響について説明します。

### <a name="resource-group"></a>Resource group

リージョンでは、リソース グループに関する情報を保存するデータ センターを指定します。 リソース グループに含まれている Azure リソースは、その親とは異なるリージョンに配置できます。

### <a name="lab-account"></a>ラボ アカウント

ラボ アカウントの場所は、リソースが存在するリージョンを示します。  

### <a name="lab"></a>ラボ    

ラボが存在する場所は、次の要因に応じて異なります。

  - **ラボ アカウントが仮想ネットワークとピアリングされている**
  
    ラボ アカウントと仮想ネットワークが同じリージョンにある場合、[それらをピアリングする](./how-to-connect-peer-virtual-network.md)ことができます。  ラボ アカウントが仮想ネットワークとピアリングされている場合、ラボは、ラボ アカウントと仮想ネットワークの両方と同じリージョンに自動的に作成されます。

    > [!NOTE]
    > ラボ アカウントが仮想ネットワークとピアリングされている場合、 **[ラボ作成者にラボの場所の選択を許可する]** 設定は無効になります。 詳細については、 「[ラボの作成者にラボ用の場所を選択できるようにする](./allow-lab-creator-pick-lab-location.md)」 を参照してください。
    
  - **どの仮想ネットワークもピアリングされておらず、"*かつ*" ラボ作成者はラボの場所の選択を許可されていない**
  
    ラボ アカウントとピアリングされている仮想ネットワークが "*なく*"、かつ [ラボ作成者がラボの場所の選択を "*許可されていない*" 場合](./allow-lab-creator-pick-lab-location.md)、ラボは、使用可能な VM 容量があるリージョンに自動的に作成されます。  具体的には、Azure Lab Services は、[ラボ アカウントと同じ地域内にあるリージョン](https://azure.microsoft.com/global-infrastructure/regions)の可用性を調べます。

  - **どの仮想ネットワークもピアリングされておらず、"*かつ*" ラボ作成者はラボの場所の選択を許可されている**
       
    ラボ アカウントがどの VNet ともピアリングされて "*おらず*"、かつ [ラボ作成者がラボの場所の選択を "*許可されている*" 場合](./allow-lab-creator-pick-lab-location.md)、ラボ作成者が選択できる場所は使用可能な容量に応じて異なります。

> [!NOTE]
> リージョンの十分な VM 容量を確保するには、まず、ラボの作成時にラボ アカウントを使用して容量を要求することが重要です。

リソースのリージョンは、原則として、ユーザーに最も近いものに設定します。 ラボの場合、これは、学生の最も近くにラボを作成することを意味します。 学生が世界中にいるオンライン コースの場合は、中央に配置するラボの作成について慎重に検討します。 または、学生のリージョンに応じてクラスを複数のラボに分割することもできます。

## <a name="vm-sizing"></a>VM のサイズ設定

管理者またはラボ作成者は、ラボを作成するときに、クラスルームのニーズに応じてさまざまな VM サイズから選択できます。 利用できるサイズは、ラボ アカウントがあるリージョンによって異なることに注意してください。

次の表では、いくつかの VM サイズが複数の VM シリーズに対応していることに注意してください。  利用できる容量に応じて、VM サイズの一覧にあるいずれかの VM シリーズを Lab Services で使用できます。  たとえば、"*小*" VM サイズは、[Standard_A2_v2](../virtual-machines/av2-series.md) または [Standard_A2](../virtual-machines/sizes-previous-gen.md#a-series) VM シリーズの使用に対応します。  ラボの VM サイズとして "*小*" を選択した場合、Lab Services では最初に *Standard_A2_v2* シリーズの使用が試みられます。  しかし、十分な容量を使用できない場合は、Lab Services によって *Standard_A2* シリーズが使用されます。  価格は VM のサイズによって決まり、その特定のサイズに対して Lab Services で使用される VM シリーズに関係なく同じです。 各 VM サイズの価格の詳細については、[Lab Services 価格ガイド](https://azure.microsoft.com/pricing/details/lab-services/)を参照してください。


| サイズ | 最小の仕様 | 系列 | 推奨される用途 |
| ---- | ----- | ------ | ------------- |
| Small| <ul><li>2&nbsp;コア</li><li>3.5 GB RAM</li> | [Standard_A2_v2](../virtual-machines/av2-series.md)、[Standard_A2](../virtual-machines/sizes-previous-gen.md#a-series) | コマンド ライン、Web ブラウザーの起動、トラフィックが少ない Web サーバー、中小規模のデータベースに最も適しています。 |
| Medium | <ul><li>4&nbsp;コア</li><li>7&nbsp;GB&nbsp;RAM</li> | [Standard_A4_v2](../virtual-machines/av2-series.md)、[Standard_A3](../virtual-machines/sizes-previous-gen.md#a-series) | リレーショナル データベース、メモリ内キャッシュ、分析に最も適しています。 |
| 中 (入れ子になった仮想化) | <ul><li>4&nbsp;コア</li><li>16&nbsp;GB&nbsp;RAM</li></ul> | [Standard_D4s_v3](../virtual-machines/dv3-dsv3-series.md#dsv3-series) | リレーショナル データベース、メモリ内キャッシュ、分析に最も適しています。  また、このサイズは入れ子になった仮想化もサポートしています。
| Large | <ul><li>8&nbsp;コア</li><li>16&nbsp;GB&nbsp;RAM</li></ul>  | [Standard_A8_v2](../virtual-machines/av2-series.md)、[Standard_A7](../virtual-machines/sizes-previous-gen.md#a-series) | 高速の CPU、ローカル ディスクのより優れたパフォーマンス、大規模なデータベース、大きなメモリ キャッシュを必要とするアプリケーションに最適です。 |
| 大 (入れ子になった仮想化) | <ul><li>8&nbsp;コア</li><li>32&nbsp;GB&nbsp;RAM</li></ul>  | [Standard_D8s_v3](../virtual-machines/dv3-dsv3-series.md#dsv3-series) | 高速の CPU、ローカル ディスクのより優れたパフォーマンス、大規模なデータベース、大きなメモリ キャッシュを必要とするアプリケーションに最適です。  また、このサイズは入れ子になった仮想化もサポートしています。 |
| 小規模 GPU (視覚化) | <ul><li>6&nbsp;コア</li><li>56&nbsp;GB&nbsp;RAM</li>  | [Standard_NV6](../virtual-machines/nv-series.md) | OpenGL や DirectX などのフレームワークを使用するリモート視覚化、ストリーミング、ゲーム、エンコードに最適です。 |
| Small GPU (Compute) | <ul><li>6&nbsp;コア</li><li>56&nbsp;GB&nbsp;RAM</li></ul>  | [Standard_NC6](../virtual-machines/nc-series.md)、[Standard_NC6s_v3](../virtual-machines/ncv3-series.md) |AI やディープ ラーニングなどのコンピューティング集中型アプリケーションに最も適しています。 |
| 中規模 GPU (視覚化) | <ul><li>12&nbsp;コア</li><li>112&nbsp;GB&nbsp;RAM</li></ul>  | [Standard_NV12](../virtual-machines/nv-series.md)、[Standard_NV12s_v3](../virtual-machines/nvv3-series.md)、[Standard_NV12s_v2](../virtual-machines/sizes-previous-gen.md#nvv2-series)  | OpenGL や DirectX などのフレームワークを使用するリモート視覚化、ストリーミング、ゲーム、エンコードに最適です。 |

## <a name="manage-identity"></a>ID の管理

ラボ アカウントおよびラボへのアクセスに [Azure ロールベースのアクセス制御 (RBAC)](../role-based-access-control/overview.md) を使用することにより、次のロールを割り当てることができます。

- ラボ アカウントの **所有者**

    ラボ アカウントを作成する管理者には、ラボ アカウントの所有者ロールが自動的に割り当てられます。 所有者ロールでは、次のことを実行できます。
     - ラボ アカウントの設定を変更する。
     - 所有者または共同作成者としてのラボ アカウントへのアクセス権を他の管理者に付与する。
     - 作成者、所有者、または共同作成者としてのラボへのアクセス権を教師に付与する。
     - ラボ アカウント内のすべてのラボを作成および管理する。

- ラボ アカウントの **共同作成者**

    共同作成者ロールを割り当てられた管理者は、次のことを実行できます。
    - ラボ アカウントの設定を変更する。
    - ラボ アカウント内のすべてのラボを作成および管理する。

    ただし、共同作成者は、ラボ アカウントまたはラボへのアクセス権を他のユーザーに付与することは "*できません*"。

- **Lab Creator**

    ラボ アカウント内にラボを作成するには、教師がラボ作成者ロールのメンバーである必要があります。  ラボを作成する教師は、自動的にラボ所有者として追加されます。 詳細については、「[ユーザーをラボの作成者ロールに追加する](./tutorial-setup-lab-account.md#add-a-user-to-the-lab-creator-role)」を参照してください。 

- ラボの **所有者** または **共同作成者**
  
    ラボの所有者または共同作成者のいずれかのロールを持つ教師は、ラボの設定を表示および変更することができます。 このユーザーは、ラボ アカウントの閲覧者ロールのメンバーでもある必要があります。

    ラボの所有者と共同作成者ロールの重要な違いは、所有者だけが他のユーザーにラボへの管理アクセス権を付与できるという点です。 共同作成者は、他のユーザーにラボへの管理アクセス権を付与することは "*できません*"。

- **共有イメージ ギャラリー**

    共有イメージ ギャラリーをラボ アカウントにアタッチすると、ラボ アカウントの所有者と共同作成者、およびラボの作成者、ラボの所有者、ラボの共同作成者には、ギャラリーのイメージを表示および保存するためのアクセス権が自動的に付与されます。

ロールを割り当てる際に役立つヒントを次に示します。

   - 通常、ラボ アカウントの所有者または共同作成者ロールのメンバーである必要があるのは、管理者だけです。 ラボ アカウントには、複数の所有者または共同作成者が存在する場合があります。
   - 教師がラボの新規作成や自身が作成したラボの管理を行うことができるようにするには、ラボの作成者ロールを割り当てるだけで済みます。
   - 教師が特定のラボを管理できるが、新しいラボを作成 "*できない*" ようにするには、その教師が管理する各ラボの所有者または共同作成者ロールを割り当てます。 たとえば、教授と補助教員がラボを共同で所有することを許可できます。 詳細については、[ラボへの所有者の追加](./how-to-add-user-lab-owner.md)に関する記事を参照してください。

## <a name="content-filtering"></a>コンテンツのフィルター処理

学校では、学生が不適切な Web サイトにアクセスできないようにコンテンツのフィルター処理を行うことが必要になる場合があります。  たとえば、[子供のインターネット保護法 (CIPA)](https://www.fcc.gov/consumers/guides/childrens-internet-protection-act)に準拠するためなどです。  Lab Services には、コンテンツ フィルター処理の組み込みサポートはありません。

通常、コンテンツのフィルター処理に関して学校では 2 つの方法を考慮します。
- ネットワーク レベルでコンテンツをフィルター処理するようにファイアウォールを構成します。
- コンテンツのフィルター処理を実行する各コンピューターに、サードパーティ製ソフトウェアを直接インストールします。

最初の方法は、Lab Services では現在サポートされていません。  Lab Services により、Microsoft が管理する Azure サブスクリプション内に各ラボの仮想ネットワークがホストされています。  そのため、基になる仮想ネットワークにアクセスして、ネットワーク レベルでコンテンツのフィルター処理を行うことはできません。  Lab Services のアーキテクチャの詳細については、[アーキテクチャの基礎](./classroom-labs-fundamentals.md)に関する記事を参照してください。

代わりに、各ラボのテンプレート VM にサードパーティ製ソフトウェアをインストールする 2 番目の方法をお勧めします。  このソリューションの一部として注目すべき重要な点がいくつかあります。
- [自動シャットダウンの設定](./cost-management-guide.md#automatic-shutdown-settings-for-cost-control)を使用する場合は、サードパーティ製ソフトウェアでいくつかの Azure ホスト名のブロックを解除する必要があります。  自動シャットダウンの設定で使用される診断拡張機能では、Lab Services に対して通信できる必要があります。  そうしないと、自動シャットダウンの設定をラボで有効にできません。
- また、コンテンツ フィルター処理ソフトウェアをアンインストールできないように、各学生には VM で管理者以外のアカウントを使用させる必要もあります。  既定では、各学生が VM へのサインインに使用する管理者アカウントが Lab Services によって作成されます。  特別に作成されたイメージを使用して、非管理者アカウントを追加することはできますが、いくつかの既知の制限があります。

学校でコンテンツのフィルター処理を行う必要がある場合は、詳細について [Azure Lab Services のフォーラム](https://techcommunity.microsoft.com/t5/azure-lab-services/bd-p/AzureLabServices)でご連絡ください。

## <a name="endpoint-management"></a>Endpoint management (エンドポイント管理)

[Microsoft エンドポイント マネージャー](https://techcommunity.microsoft.com/t5/azure-lab-services/configuration-manager-azure-lab-services/ba-p/1754407)などの多くのエンドポイント管理ツールでは、Windows VM に一意のマシン セキュリティ識別子 (SID) が必要です。  SysPrep を使用して "*一般化された*" イメージを作成すると、通常、VM がイメージから起動されるときに、各 Windows マシンに新しい一意のマシン SID が生成されます。

Lab Services では、"*一般化された*" イメージを使用してラボが作成される場合でも、テンプレート VM と学生用 VM のマシン SID はすべて同じになります。  テンプレート VM のイメージは、学生用 VM を作成するために発行されるときは "*特殊化された*" 状態であるため、VM の SID は同じになります。

たとえば、Azure Marketplace のイメージは一般化されています。  Win 10 の Marketplace イメージからラボを作成して、テンプレート VM を発行すると、ラボ内のすべての学生用 VM は、テンプレート VM と同じマシン SID を持つようになります。  マシン SID は、[PsGetSid](/sysinternals/downloads/psgetsid) などのツールを使用して確認できます。

エンドポイント管理ツールまたは類似のソフトウェアを使用する場合は、ラボの VM を使用してそれをテストし、マシンの SID が同じであっても正常に動作することを確認することをお勧めします。  

## <a name="pricing"></a>価格

### <a name="azure-lab-services"></a>Azure Lab Services

価格については、「[Azure Lab Services の価格](https://azure.microsoft.com/pricing/details/lab-services/)」を参照してください。

### <a name="shared-image-gallery"></a>共有イメージ ギャラリー

イメージ バージョンの保存と管理に共有イメージ ギャラリーを使用する予定があれば、Shared Image Gallery サービスの価格も検討する必要があります。 

共有イメージ ギャラリーの作成とラボ アカウントへのアタッチは無料です。 イメージ バージョンをギャラリーに保存するまで、コストは発生しません。 通常、共有イメージ ギャラリーの使用料金はごくわずかですが、Azure Lab Services の価格には含まれていないため、計算方法を理解しておくことが重要です。  

#### <a name="storage-charges"></a>ストレージ料金

イメージのバージョンを格納するため、共有イメージ ギャラリーでは既定で、Standard ハード ディスク ドライブ (HDD) マネージド ディスクが使用されます。  Lab Services で共有イメージ ギャラリーを使用するときは、HDD マネージド ディスクを使用することをお勧めします。  使用される HDD マネージド ディスクのサイズは、保存されるイメージ バージョンのサイズによって異なります。  Lab Services でサポートされるイメージとディスクのサイズは、最大 128 GB です。  価格については、「[Managed Disks の価格](https://azure.microsoft.com/pricing/details/managed-disks/)」を参照してください。

#### <a name="replication-and-network-egress-charges"></a>レプリケーションとネットワーク エグレス料金

ラボのテンプレート VM を使用してイメージ バージョンを保存する場合、Azure Lab Services によって、まず、ソース リージョンに保存され、次にソース イメージ バージョンが 1 つ以上のターゲット リージョンに自動的にレプリケートされます。 

Azure Lab Services では、ラボが配置されている[地域内のターゲット リージョン](https://azure.microsoft.com/global-infrastructure/regions/)すべてに対して、ソース イメージ バージョンが自動的にレプリケートされることに注意してください。 たとえば、ラボが米国内の地域にある場合、イメージ バージョンは米国内に存在する 8 つの各リージョンにレプリケートされます。

イメージ バージョンがソース リージョンから追加のターゲット リージョンにレプリケートされると、ネットワーク エグレス料金が発生します。 請求額は、イメージのデータがソース リージョンから外部に最初に転送されたときのイメージ バージョンのサイズに基づきます。  価格の詳細については、「[帯域幅の料金詳細](https://azure.microsoft.com/pricing/details/bandwidth/)」を参照してください。

[教育機関向けソリューション](https://www.microsoft.com/licensing/licensing-programs/licensing-for-industries?rtc=1&activetab=licensing-for-industries-pivot:primaryr3)のお客様は、エグレス料金の支払いを免除される場合があります。 詳細については、アカウント マネージャーにお問い合わせください。 

また、 [教育期間向けのプログラム](https://azure.microsoft.com/pricing/details/bandwidth/)ページの FAQ セクションにある「教育機関のお客様向けのどんなデータ転送プログラムがありますか? 資格を得るにはどうすればよいですか?」も参照してください。

#### <a name="pricing-example"></a>価格の例

ここで、テンプレート VM イメージを共有イメージ ギャラリーに保存するコストの例を見てみることにしましょう。 次のシナリオを想定します。

- カスタム VM イメージが 1 つある。
- イメージの 2 つのバージョンを保存する。
- ラボは米国にあり、米国には合計 8 つのリージョンがある。
- 各イメージ バージョンのサイズは 32 GB であるため、HDD マネージド ディスクの価格は月額 1.54 ドルになる。

1 か月あたりの合計コストは次のように概算されます。

* "*イメージの数 &times; バージョンの数 &times; レプリカの数 &times; マネージド ディスクの価格 = 1 か月あたりの合計コスト*"

この例では、コストは次のとおりです。

* 1 カスタム イメージ (32 GB) &times; 2 バージョン &times; 8 米国リージョン &times; 1.54 ドル = 1 か月あたり 24.64 ドル

> [!NOTE]
> 上記の計算は、例の目的でのみ使用されます。 これは、Shared Image Gallery の使用に関連するストレージ コストを対象にしており、エグレス コストは含まれて "*いません*"。 ストレージの実際の価格については、「[Managed Disks の価格](https://azure.microsoft.com/pricing/details/managed-disks/)」を参照してください。

#### <a name="cost-management"></a>コスト管理

ラボ アカウント管理者は、不要なイメージ バージョンをギャラリーから定期的に削除してコストを管理することが重要です。 

共有イメージ ギャラリーには、特定のリージョンへのレプリケーションを削除するオプションがありますが、コストを削減する方法としてレプリケーションを削除しないでください。 レプリケーションを変更すると、Azure Lab Services で、共有イメージ ギャラリー内に保存されたイメージから VM を発行することができなくなるおそれがあります。

## <a name="next-steps"></a>次のステップ

ラボの設定と管理の詳細については、以下を参照してください。

- [ラボ アカウント設定ガイド](account-setup-guide.md)  
- [ラボ設定ガイド](setup-guide.md)  
- [ラボのコスト管理](cost-management-guide.md)  
- [Microsoft Teams 内で Azure Lab Services を使用する](lab-services-within-teams-overview.md)