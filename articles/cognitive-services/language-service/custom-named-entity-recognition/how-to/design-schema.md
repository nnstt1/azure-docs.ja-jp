---
title: カスタム NER のデータの準備とスキーマの設計
titleSuffix: Azure Cognitive Services
description: カスタム NER プロジェクトの作成に成功するように、データを選択して準備する方法について説明します。
services: cognitive-services
author: aahill
manager: nitinme
ms.service: cognitive-services
ms.subservice: language-service
ms.topic: overview
ms.date: 11/02/2021
ms.author: aahi
ms.custom: language-service-custom-ner, ignite-fall-2021
ms.openlocfilehash: 04a01833498154a1446e7f00aafb505b37e9e335
ms.sourcegitcommit: 0415f4d064530e0d7799fe295f1d8dc003f17202
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/17/2021
ms.locfileid: "132705020"
---
# <a name="how-to-prepare-data-and-define-a-schema-for-custom-ner"></a>データを準備し、カスタム NER のスキーマを定義する方法

カスタム NER モデルを作成するには、それをトレーニングするための高品質なデータが必要です。 この記事では、スキーマの定義と共に、データの選択と準備を行う方法について説明します。 スキーマは、実行時にご使用のモデルがテキストから抽出する必要があるエンティティの種類やカテゴリを定義します。これは[エンティティ抽出モデルを開発する](../overview.md#application-development-lifecycle)最初の手順です。

## <a name="schema-design"></a>スキーマの設計

スキーマは、実行時にモデルがテキストから抽出する必要があるエンティティの種類やカテゴリを定義します。

* データセット内のファイルを確認して、その形式と構造を理解します。

* データから抽出する[エンティティ](../glossary.md#entity)を特定します。

    たとえば、サポート電子メールからエンティティを抽出する場合は、"顧客名"、"製品名"、"顧客の問題"、"要求日"、および "連絡先情報" を抽出する必要がある場合があります。

* エンティティ型のあいまいさを回避します。

    **あいまいさ** は、選択した型が互いに似ている場合に発生します。 スキーマがあいまいであればあるほど、より多くのタグ付きデータでモデルをトレーニングすることになります。

    たとえば、法的な契約からデータを抽出する場合、"第一当事者の名前" と "第二当事者の名前" を抽出するには、両当事者の名前が似ているので、あいまいさを解決するためにより多くの例を追加する必要があります。 あいまいさを回避することで、時間と労力が節約され、より良い結果が得られます。

* 複雑なエンティティを避けます。 複雑なエンティティは、テキストから正確に選択するのが難しい場合があります。複数のエンティティに分割することを検討してください。

    たとえば、モデルが小さなエンティティに分割されていない場合、"Address" の抽出に苦労します。 アドレスの表示方法には非常に多くのバリエーションがあります。アドレスを分解せずに全体として抽出するようにモデルに教えるには、多くのタグ付けされたエンティティが必要になります。 ただし、"Address" を "Street Name"、"PO Box"、"City"、"State"、"Zip" に置き換えた場合、モデルではエンティティごとに必要なタグが少なくなります。

## <a name="data-selection"></a>データの選択

モデルをトレーニングするデータの品質は、モデルのパフォーマンスに大きく影響します。

* ドメインの問題空間を反映した実際のデータを使用して、モデルを効果的にトレーニングします。 合成データを使用すると、最初のモデル トレーニング プロセスを加速できますが、実際のデータとは異なる可能性が高く、使用したときにモデルから得られる効果が少なくなることがあります。

* 実際の分布から大きく離れることなく、可能な限りデータ分散のバランスを取ります。 たとえば、さまざまな形式や言語で提供される可能性がある法的ドキュメントからエンティティを抽出するためにモデルをトレーニングする場合は、実際に見られるような多様性を示す例を提供する必要があります。

* モデルのオーバーフィットを回避するために、可能な限り多様なデータを使用します。 トレーニング データの多様性が低いと、実際のデータに存在しない場合がある偽の相関関係をモデルが学習する可能性があります。 
 
* データ内のファイルが重複しないようにします。 重複するデータは、トレーニング プロセス、モデル メトリック、モデルのパフォーマンスに悪影響を及ぼす可能性があります。 

* データの取得場所を検討します。 1 人の人物、1 つの部署、またはシナリオの一部からデータを収集する場合は、モデルが学ぶべき重要な多様性が欠落している可能性があります。 

> [!NOTE]
> ファイルで複数の言語が使われている場合は、[プロジェクトの作成](../quickstart.md)中に **[複数言語]** オプションを選び、 **[言語]** オプションをファイルの主要な言語に設定します。

## <a name="data-preparation"></a>データ準備

プロジェクトを作成するための前提条件として、トレーニング データをストレージ アカウントの BLOB コンテナーにアップロードする必要があります。 トレーニング ファイルの作成とアップロードは、Azure から直接行うことも、 Azure Storage Explorer を使用して行うこともできます。 Azure Storage Explorer を使用すると、より多くのデータをすばやくアップロードできます。  

* [Azure からのファイルの作成とアップロード](../../../../storage/blobs/storage-quickstart-blobs-portal.md#create-a-container)
* [Azure Storage Explorer を使用したファイルの作成とアップロード](../../../../vs-azure-tools-storage-explorer-blobs.md)

使用できるのは、`.txt` ファイルのみです。 データが他の形式の場合は、[CLUtils 解析コマンド](https://github.com/microsoft/CognitiveServicesLanguageUtilities/blob/main/CustomTextAnalytics.CLUtils/Solution/CogSLanguageUtilities.ViewLayer.CliCommands/Commands/ParseCommand/README.md)を使用してファイル形式を変更できます。

 注釈付きデータセットをアップロードするか、注釈の付いていないデータセットをアップロードし、Language Studio で[データにタグ付けする](../how-to/tag-data.md)ことができます。 
 
## <a name="next-steps"></a>次のステップ

まだ作成していない場合は、カスタム NER プロジェクトを作成します。 カスタム NER を初めて使用する場合は、[クイック スタート](../quickstart.md)に従ってサンプル プロジェクトを作成することを検討してください。 また、プロジェクトを作成するために必要な内容について詳しくは、[ハウツー記事](../how-to/create-project.md)を参照してください。