---
title: データを準備してスキーマを定義する方法
titleSuffix: Azure Cognitive Services
description: カスタム分類プロジェクトのためのデータの選択、準備、スキーマの作成について説明します。
services: cognitive-services
author: aahill
manager: nitinme
ms.service: cognitive-services
ms.subservice: language-service
ms.topic: overview
ms.date: 11/02/2021
ms.author: aahi
ms.custom: language-service-custom-classification, ignite-fall-2021
ms.openlocfilehash: 37e55e4f246ffdc172621bc19b81975ff8324e10
ms.sourcegitcommit: 0415f4d064530e0d7799fe295f1d8dc003f17202
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/17/2021
ms.locfileid: "132719544"
---
# <a name="how-to-prepare-data-and-define-a-schema"></a>データを準備してスキーマを定義する方法

カスタム分類モデルを作成するには、それをトレーニングするための高品質なデータが必要です。 この記事では、スキーマの定義と共に、データの選択と準備を行う方法について説明します。 スキーマは、モデルの実行時にテキストを分類するために必要なクラスを定義するものであり、[カスタム分類アプリケーションを開発する](../overview.md#project-development-lifecycle)最初の手順です。


## <a name="data-selection"></a>データの選択

モデルをトレーニングするデータの品質は、モデルのパフォーマンスに大きく影響します。

* ドメインの問題空間を反映した実際のデータを使用して、モデルを効果的にトレーニングします。 合成データを使用すると、最初のモデル トレーニング プロセスを加速できますが、実際のデータとは異なる可能性が高く、使用したときにモデルから得られる効果が少なくなることがあります。

* 実際の分布から大きく離れることなく、可能な限りデータ分散のバランスを取ります。

* モデルのオーバーフィットを回避するために、可能な限り多様なデータを使用します。 トレーニング データの多様性が低いと、実際のデータに存在しない場合がある偽の相関関係をモデルが学習する可能性があります。 
 
* データ内のファイルが重複しないようにします。 重複するデータは、トレーニング プロセス、モデル メトリック、モデルのパフォーマンスに悪影響を及ぼす可能性があります。 

* データの取得場所を検討します。 1 人の人物、1 つの部署、またはシナリオの一部からデータを収集する場合は、モデルが学ぶべき重要な多様性が欠落している可能性があります。 

> [!NOTE]
> ファイルで複数の言語が使われている場合は、[プロジェクトの作成](../quickstart.md)中に **[複数言語]** オプションを選び、 **[言語]** オプションをファイルの主要な言語に設定します。

## <a name="data-preparation"></a>データ準備

カスタム テキスト分類プロジェクトを作成するための前提条件として、トレーニング データをストレージ アカウントの BLOB コンテナーにアップロードする必要があります。 トレーニング ファイルの作成とアップロードは、Azure から直接行うことも、Azure Storage Explorer ツールを使って行うこともできます。 Azure Storage Explorer を使用すると、より多くのデータをすばやくアップロードできます。  

* [Azure からのファイルの作成とアップロード](../../../../storage/blobs/storage-quickstart-blobs-portal.md#create-a-container)
* [Azure Storage Explorer を使用したファイルの作成とアップロード](../../../../vs-azure-tools-storage-explorer-blobs.md)

カスタム テキストに使用できるのは、`.txt` ファイルのみです。 データが他の形式の場合は、[CLUtils 解析コマンド](https://github.com/microsoft/CognitiveServicesLanguageUtilities/blob/main/CustomTextAnalytics.CLUtils/Solution/CogSLanguageUtilities.ViewLayer.CliCommands/Commands/ParseCommand/README.md)を使用してファイル形式を変更できます。

 注釈付きデータセットをアップロードするか、注釈の付いていないデータセットをアップロードし、Language Studio で[データにタグ付けする](../how-to/tag-data.md)ことができます。 
 
## <a name="schema-design"></a>スキーマの設計

スキーマには、モデルの実行時にテキストを分類するために必要なクラスが定義されています。

* **確認と識別**: データセット内のファイルを確認して、その構造と内容を理解し、データをどのように分類したいかを特定します。 

    たとえば、サポート チケットを分類する場合、"*ログインの問題*"、"*ハードウェアの問題*"、"*接続の問題*"、"*新しい機器の要求*" などのクラスが必要になるかもしれません。

* **クラスのあいまいさを回避する**: あいまいさは、指定したクラスが互いに似た意味を共有する場合に生じます。 スキーマがあいまいであればあるほど、より多くのタグ付きデータを使用したモデルのトレーニングが必要になる場合があります。  

    たとえば、食べ物のレシピを分類する場合、ある程度似ている可能性があります。 "*デザートのレシピ*" と "*メイン ディッシュのレシピ*" を区別するには、モデルで 2 つのクラスを区別できるように、必要に応じてさらに多くの例にタグを付けます。 あいまいさを回避することで、時間が節約され、より良い結果が得られます。 

* **範囲外のデータ**: 運用環境でモデルを使用する場合、どのクラスにも属さないファイルが予想される場合は、"*範囲外*" のクラスをスキーマに追加することを検討してください。 次にいくつかのファイルをデータセットに追加して、"*範囲外*" のタグを付けます。 無関係なファイルを認識し、それに応じてタグを予測する方法をモデルに学習させることができます。

## <a name="next-steps"></a>次のステップ

まだカスタム分類プロジェクトを作成していない場合は、試してみてください カスタム分類を初めて使用する場合は、[クイックスタート](../quickstart.md)に従ってサンプル プロジェクトを作成することを検討してください。 また、プロジェクトの作成に必要なことの詳細については、[プロジェクトの要件](../how-to/create-project.md)に関する記事を参照してください。