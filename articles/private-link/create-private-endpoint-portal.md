---
title: クイックスタート - Azure portal を使用してプライベート エンドポイントを作成する
description: このクイックスタートを使用して、Azure portal を使用してプライベート エンドポイントを作成する方法について学習します。
services: private-link
author: asudbring
ms.service: private-link
ms.topic: quickstart
ms.date: 10/20/2020
ms.author: allensu
ms.openlocfilehash: 02d9ca3ba6a16e06c4357a46a050f8803147aaaf
ms.sourcegitcommit: dddd1596fa368f68861856849fbbbb9ea55cb4c7
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/13/2021
ms.locfileid: "114292892"
---
# <a name="quickstart-create-a-private-endpoint-using-the-azure-portal"></a>クイックスタート: Azure portal を使用してプライベート エンドポイントを作成する

プライベート エンドポイントを使用して Azure Web アプリに安全に接続することにより、Azure Private Link の使用を開始します。

このクイックスタートでは、Azure Web アプリのプライベート エンドポイントを作成し、仮想マシンをデプロイしてプライベート接続をテストします。  

プライベート エンドポイントは、Azure SQL や Azure Storage などのさまざまな種類の Azure サービスに対して作成できます。

## <a name="prerequisites"></a>前提条件

* アクティブなサブスクリプションが含まれる Azure アカウント。 [無料でアカウントを作成できます](https://azure.microsoft.com/free/?WT.mc_id=A261C142F)。
* 対象の Azure サブスクリプションにデプロイされている **PremiumV2 レベル** 以上のアプリ サービス プランを持つ Azure Web アプリ。  
    * 詳細および例については、「[クイックスタート: Azure に ASP.NET Core Web アプリを作成する](../app-service/quickstart-dotnetcore.md)」を参照してください。 
    * Web アプリとエンドポイントの作成に関する詳細なチュートリアルについては「[チュートリアル: Azure プライベート エンドポイントを使用して Web アプリに接続する](tutorial-private-endpoint-webapp-portal.md)」を参照してください。

## <a name="sign-in-to-azure"></a>Azure へのサインイン

Azure Portal ( https://portal.azure.com ) にサインインします。

## <a name="create-a-virtual-network-and-bastion-host"></a>仮想ネットワークと bastion ホストの作成

このセクションでは、仮想ネットワーク、サブネット、bastion ホストを作成します。 

bastion ホストは、プライベート エンドポイントをテストする目的で、仮想マシンに安全に接続するために使用されます。

1. 画面の左上で、 **[リソースの作成] > [ネットワーク] > [仮想ネットワーク]** の順に選択するか、検索ボックスで **Virtual network** を検索します。

2. **[仮想ネットワークの作成]** の **[基本]** タブで次の情報を入力または選択します。

    | **設定**          | **Value**                                                           |
    |------------------|-----------------------------------------------------------------|
    | **プロジェクトの詳細**  |                                                                 |
    | サブスクリプション     | Azure サブスクリプションを選択します。                                  |
    | リソース グループ   | **[CreatePrivateEndpointQS-rg]** を選択します |
    | **インスタンスの詳細** |                                                                 |
    | 名前             | 「**myVNet**」と入力します                                    |
    | リージョン           | **[西ヨーロッパ]** を選択します。|

3. **[IP アドレス]** タブを選択するか、ページの下部にある **[Next: IP Addresses]\(次へ: IP アドレス\)** ボタンを選択します。

4. **[IP アドレス]** タブで、次の情報を入力します。

    | 設定            | 値                      |
    |--------------------|----------------------------|
    | IPv4 アドレス空間 | 「**10.1.0.0/16**」と入力します。 |

5. **[サブネット名]** で、 **[default]\(既定\)** という単語を選択します。

6. **[サブネットの編集]** に次の情報を入力します。

    | 設定            | 値                      |
    |--------------------|----------------------------|
    | サブネット名 | 「**mySubnet**」と入力します。 |
    | サブネットのアドレス範囲 | 「**10.1.0.0/24**」と入力します。 |

7. **[保存]** を選択します。

8. **[セキュリティ]** タブをクリックします。

9. **[BastionHost]** で **[有効にする]** を選択します。 この情報を入力します。

    | 設定            | 値                      |
    |--------------------|----------------------------|
    | 要塞名 | 「**myBastionHost**」と入力します |
    | AzureBastionSubnet のアドレス空間 | 「**10.1.1.0/24**」と入力します |
    | パブリック IP アドレス | **[新規作成]** を選択します。 </br> **[名前]** に「**myBastionIP**」と入力します。 </br> **[OK]** を選択します。 |


8. **[確認と作成]** タブを選択するか、 **[確認と作成]** ボタンを選択します。

9. **［作成］** を選択します

## <a name="create-a-virtual-machine"></a>仮想マシンの作成

このセクションでは、プライベート エンドポイントのテストに使用する仮想マシンを作成します。

1. ポータルの左上で、 **[リソースの作成]**  >  **[Compute]**  >  **[仮想マシン]** の順に選択するか、検索ボックスで「**仮想マシン**」を検索します。
   
2. **[仮想マシンの作成]** の **[Basic]** タブに、値を入力するか選択します。

    | 設定 | 値                                          |
    |-----------------------|----------------------------------|
    | **プロジェクトの詳細** |  |
    | サブスクリプション | Azure サブスクリプションを選択します。 |
    | リソース グループ | **[CreatePrivateEndpointQS-rg]** を選択します |
    | **インスタンスの詳細** |  |
    | 仮想マシン名 | 「**myVM**」と入力します |
    | リージョン | **[西ヨーロッパ]** を選択します。 |
    | 可用性オプション | **[インフラストラクチャ冗長は必要ありません]** を選択します |
    | Image | **[Windows Server 2019 Datacenter - Gen1]** を選択します |
    | Azure Spot インスタンス | **[いいえ]**  を選択します |
    | サイズ | VM サイズを選択するか、既定の設定を使用します |
    | **管理者アカウント** |  |
    | ユーザー名 | ユーザー名を入力します |
    | Password | [パスワード] を入力します |
    | [パスワードの確認入力] | パスワードを再入力します |

3. **[ネットワーク]** タブまたは **[次へ: ディスク]** を選択してから **[次へ: ネットワーク]** を選択します。
  
4. [ネットワーク] タブで、次を選択または入力します。

    | 設定 | 値 |
    |-|-|
    | **ネットワーク インターフェイス** |  |
    | 仮想ネットワーク | **myVNet** |
    | Subnet | **mySubnet** |
    | パブリック IP | **[なし]** を選択します。 |
    | NIC ネットワーク セキュリティ グループ | **Basic**|
    | パブリック受信ポート | **[なし]** を選択します。 |
   
5. **[Review + create]\(レビュー + 作成\)** を選択します。 
  
6. 設定を確認し、 **[作成]** を選択します。

[!INCLUDE [ephemeral-ip-note.md](../../includes/ephemeral-ip-note.md)]

## <a name="create-a-private-endpoint"></a>プライベート エンドポイントを作成する

このセクションでは、「前提条件」セクションで作成した Web アプリ用のプライベート エンドポイントを作成します。

1. ポータルの画面の左上で、 **[リソースの作成]**  >  **[Networking]\(ネットワーキング\)**  >  **[Private Link]\(プライベート リンク\)** を選択するか、検索ボックスに「**プライベート リンク**」と入力します。

2. **［作成］** を選択します

3. **プライベート リンク センター** で、左側のメニューから **[プライベート エンドポイント]** を選択します。

4. **[プライベート エンドポイント]** で、 **[+ 追加]** を選択します。

5. **[プライベート エンドポイントの作成]** の **[基本]** タブで、次の情報を入力または選択します。

    | 設定 | 値 |
    | ------- | ----- |
    | **プロジェクトの詳細** | |
    | サブスクリプション | サブスクリプションを選択します。 |
    | Resource group | **[CreatePrivateEndpointQS-rg]** を選択します。 このリソース グループは、前のセクションで作成しました。|
    | **インスタンスの詳細** |  |
    | 名前  | 「**myPrivateEndpoint**」と入力します。 |
    | リージョン | **[西ヨーロッパ]** を選択します。 |

6. **[リソース]** タブを選択するか、ページ下部の **[次へ: リソース]** ボタンを選択します。
    
7. **[リソース]** で、次の情報を入力または選択します。

    | 設定 | 値 |
    | ------- | ----- |
    | 接続方法 | **[マイ ディレクトリ内の Azure リソースに接続します]** を選択します。 |
    | サブスクリプション | サブスクリプションを選択します。 |
    | リソースの種類 | **[Microsoft.Web/sites]** を選択します。 |
    | リソース | **\<your-web-app-name>** を選びます。 </br> 「前提条件」で作成した Web アプリの名前を選択します。 |
    | ターゲット サブリソース | **[サイト]** を選択します。 |

8. **[構成]** タブを選択するか、 **[次へ: 構成]** ボタン (画面の下部にあります) を選択します。

9. **[構成]** で、次の情報を入力または選択します。

    | 設定 | 値 |
    | ------- | ----- |
    | **ネットワーク** |  |
    | 仮想ネットワーク | **[myVNet]** を選択します。 |
    | Subnet | **[mySubnet]** を選択します。 |
    | **プライベート DNS の統合** |  |
    | プライベート DNS ゾーンとの統合 | 既定値の **[はい]** のままにします。 |
    | サブスクリプション | サブスクリプションを選択します。 |
    | プライベート DNS ゾーン | 既定値の **[ privatelink.azurewebsites.net]** のままにします。
    

13. **[Review + create]\(レビュー + 作成\)** を選択します。

14. **［作成］** を選択します

## <a name="test-connectivity-to-private-endpoint"></a>プライベート エンドポイントへの接続のテスト

このセクションでは、前の手順で作成した仮想マシンを使用し、プライベート エンドポイントを通じて Web アプリに接続します。

1. 左側のナビゲーション ペインで **[リソース グループ]** を選択します。

2. **[CreatePrivateEndpointQS-rg]** を選択します。

3. **[myVM]** を選択します。

4. **myVM** の [概要] ページで **[接続]** 、 **[Bastion]** の順に選択します。

5. 青色の **[Bastion を使用する]** ボタンを選択します。

6. 仮想マシンの作成時に入力したユーザー名とパスワードを入力します。

7. 接続後にサーバーで Windows PowerShell を開きます。

8. 「`nslookup <your-webapp-name>.azurewebsites.net`」と入力します。 **\<your-webapp-name>** を、前の手順で作成した Web アプリの名前に置き換えます。  以下に表示されるようなメッセージが返されます。

    ```powershell
    Server:  UnKnown
    Address:  168.63.129.16

    Non-authoritative answer:
    Name:    mywebapp8675.privatelink.azurewebsites.net
    Address:  10.1.0.5
    Aliases:  mywebapp8675.azurewebsites.net
    ```

    Web アプリ名に対応する **10.1.0.5** というプライベート IP アドレスが返されます。  このアドレスは、先ほど作成した仮想ネットワークのサブネット内に存在します。

11. **myVM** への bastion 接続で、Internet Explorer を開きます。

12. Web アプリの URL **https://\<your-webapp-name>.azurewebsites.net** を入力します。

13. アプリケーションがデプロイされていない場合は、既定の Web アプリ ページが表示されます。

    :::image type="content" source="./media/create-private-endpoint-portal/web-app-default-page.png" alt-text="既定の Web アプリ ページ。" border="true":::

18. **myVM** への接続を閉じます。

## <a name="clean-up-resources"></a>リソースをクリーンアップする

今後このアプリケーションを使う予定がなければ、次の手順を使用して、仮想ネットワーク、仮想マシン、および Web アプリを削除します。

1. 左側のメニューから、 **[リソース グループ]** を選択します。

2. **[CreatePrivateEndpointQS-rg]** を選択します。

3. **[リソース グループの削除]** を選択します。

4. **[TYPE THE RESOURCE GROUP NAME]\(リソース グループ名を入力してください\)** に「**CreatePrivateEndpointQS-rg**」と入力します。

5. **[削除]** を選択します。


## <a name="next-steps"></a>次のステップ

このクイックスタートでは、次のものを作成しました。

* 仮想ネットワークと bastion ホスト。
* 仮想マシン。
* Azure Web アプリのプライベート エンドポイント。

仮想マシンを使用して、プライベート エンドポイントを介した Web アプリへの接続を安全にテストしました。



プライベート エンドポイントをサポートするサービスの詳細については、以下を参照してください。
> [!div class="nextstepaction"]
> [Private Link の可用性](private-link-overview.md#availability)
