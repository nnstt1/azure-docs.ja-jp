---
title: Azure Front Door 上の Azure Web Application Firewall の DRS 規則グループと規則
description: この記事では、Web Application Firewall の DRS 規則グループと規則について説明します。
ms.service: web-application-firewall
author: vhorne
ms.author: victorh
ms.topic: conceptual
ms.date: 07/29/2021
ms.openlocfilehash: 95839937f2356f74d29499bb45e7cd0e1159b02c
ms.sourcegitcommit: 57b7356981803f933cbf75e2d5285db73383947f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/05/2021
ms.locfileid: "129546351"
---
# <a name="web-application-firewall-drs-rule-groups-and-rules"></a>Web Application Firewall の DRS 規則グループと規則

Azure Front Door の Web アプリケーション ファイアウォール (WAF) は、一般的な脆弱性や悪用から Web アプリケーションを保護します。 Azure で管理される規則セットでは、一般的なセキュリティ脅威のセットに対する保護をデプロイする簡単な方法が提供されます。 そのような規則セットは Azure によって管理されるので、新しい攻撃シグネチャから保護するために、必要に応じて規則が更新されます。


## <a name="default-rule-sets"></a>既定の規則セット

Azure で管理される既定の規則セットには、次の脅威カテゴリに対する規則が含まれます。

- クロスサイト スクリプティング
- Java 攻撃
- ローカル ファイル インクルージョン
- PHP インジェクション攻撃
- リモート コマンド実行
- リモート ファイル インクルージョン
- セッション固定
- SQL インジェクションからの保護
- プロトコル攻撃者

既定の規則セットのバージョン番号は、新しい攻撃シグネチャが規則セットに追加されると増分されます。
WAF ポリシーの検出モードでは、既定の規則セットが既定で有効になります。 ご自分のアプリケーション要件に合わせて、既定の規則セット内の規則を個別に有効または無効にすることができます。 また、規則ごとに特定のアクション (許可/ブロック/リダイレクト/ログ) を設定することもできます。

場合によっては、WAF の評価から特定の要求属性を省略する必要があります。 一般的な例として、認証に使用される、Active Directory で挿入されたトークンが挙げられます。 管理下にある規則や規則グループに対する除外リスト、または規則セット全体に対する除外リストを構成することができます。  

既定のアクションはブロックです。 さらに、既定の規則セット内の事前構成済みの規則のいずれかをバイパスしたい場合は、同じ WAF ポリシーでカスタム規則を構成できます。

カスタム規則は常に、既定の規則セット内の規則が評価される前に適用されます。 要求がカスタム規則に一致した場合、対応する規則のアクションが適用されます。 要求はブロックされるか、バックエンドに渡されます。 他のカスタム規則や既定の規則セット内の規則は処理されません。 既定の規則セットを WAF ポリシーから削除することもできます。

### <a name="microsoft-threat-intelligence-collection-rules"></a>Microsoft 脅威インテリジェンスの収集規則

Microsoft 脅威インテリジェンスの収集規則は、Microsoft インテリジェンス チームと協力して作成されており、カバレッジの向上、特定の脆弱性に対するパッチ、擬陽性削減の向上が実現されます。

### <a name="anomaly-scoring-mode"></a>異常スコアリング モード

OWASP には、トラフィックをブロックするかどうかを決定するための 2 つのモードがあります。従来モードと異常スコアリング モードです。

従来モードでは、いずれかの規則に一致するトラフィックが、他の規則の一致とは無関係に考慮されます。 このモードは簡単に理解できます。 しかし、特定の要求に一致する規則の数に関する情報が不足することが制限事項です。 そのため、異常スコアリング モードが導入されました。 OWASP 3.*x* ではこれが既定です。

異常スコアリング モードでは、ファイアウォールが防止モードの場合、いずれかの規則に一致するトラフィックがすぐにブロックされることはありません。 規則には特定の重大度があります。 *[重大]* 、 *[エラー]* 、 *[警告]* 、または *[通知]* です。 その重大度は、異常スコアと呼ばれる要求の数値に影響します。 たとえば、１つの *[警告]* 規則の一致によって、スコアに 3 が与えられます。 １つの *[重大]* 規則の一致では 5 が与えられます。

|重大度  |値  |
|---------|---------|
|Critical     |5|
|エラー        |4|
|警告      |3|
|注意事項       |2|

異常スコアでトラフィックがブロックされるしきい値は 5 です。 そのため、防止モードであっても、WAF によって要求がブロックされるには、"*クリティカル*" 規則との一致が 1 つあるだけで十分です。 しかし、1 つの *[警告]* 規則の一致では、異常スコアは 3 増加するだけで、その一致だけではトラフィックをブロックするには不十分です。

> [!NOTE]
> 本体の検査は DRS 2.0 でのみ使用できます。

### <a name="drs-20"></a>DRS 2.0

次の表に示すように、DRS 2.0 には 17 個の規則グループが含まれています。 各グループには、無効にできる複数の規則が含まれています。

> [!NOTE]
> DRS 2.0 は、Azure Front Door Premium でのみ利用できます。

|規則グループ|説明|
|---|---|
|**[全般](#general-20)**|一般グループ|
|**[METHOD-ENFORCEMENT](#drs911-20)**|メソッド (PUT、PATCH) をロックダウンします|
|**[PROTOCOL-ENFORCEMENT](#drs920-20)**|プロトコルとエンコーディングの問題から保護します|
|**[PROTOCOL-ATTACK](#drs921-20)**|ヘッダー インジェクション、要求スマグリング、応答分割から保護します|
|**[APPLICATION-ATTACK-LFI](#drs930-20)**|ファイル攻撃やパス攻撃から保護します|
|**[APPLICATION-ATTACK-RFI](#drs931-20)**|リモート ファイル インクルージョン (RFI) 攻撃から保護します|
|**[APPLICATION-ATTACK-RCE](#drs932-20)**|リモート コード実行攻撃から保護します|
|**[APPLICATION-ATTACK-PHP](#drs933-20)**|PHP インジェクション攻撃から保護します|
|**[APPLICATION-ATTACK-NodeJS](#drs934-20)**|Node JS 攻撃から保護します|
|**[APPLICATION-ATTACK-XSS](#drs941-20)**|クロスサイト スクリプティング攻撃から保護します|
|**[APPLICATION-ATTACK-SQLI](#drs942-20)**|SQL インジェクション攻撃から保護します|
|**[APPLICATION-ATTACK-SESSION-FIXATION](#drs943-20)**|セッション固定攻撃から保護します|
|**[APPLICATION-ATTACK-SESSION-JAVA](#drs944-20)**|Java 攻撃から保護します|
|**[MS-ThreatIntel-WebShells](#drs9905-20)**|Web シェル攻撃から保護します|
|**[MS-ThreatIntel-AppSec](#drs9903-20)**|AppSec 攻撃から保護します|
|**[MS-ThreatIntel-SQLI](#drs99031-20)**|SQLI 攻撃から保護します|
|**[MS-ThreatIntel-CVEs](#drs99001-20)**|CVE 攻撃から保護します|

### <a name="drs-11"></a>DRS 1.1
|規則グループ|説明|
|---|---|
|**[PROTOCOL-ATTACK](#drs921-11)**|ヘッダー インジェクション、要求スマグリング、応答分割から保護します|
|**[APPLICATION-ATTACK-LFI](#drs930-11)**|ファイル攻撃やパス攻撃から保護します|
|**[APPLICATION-ATTACK-RFI](#drs931-11)**|リモート ファイル インクルージョン攻撃から保護します|
|**[APPLICATION-ATTACK-RCE](#drs932-11)**|リモート コマンド実行から保護します|
|**[APPLICATION-ATTACK-PHP](#drs933-11)**|PHP インジェクション攻撃から保護します|
|**[APPLICATION-ATTACK-XSS](#drs941-11)**|クロスサイト スクリプティング攻撃から保護します|
|**[APPLICATION-ATTACK-SQLI](#drs942-11)**|SQL インジェクション攻撃から保護します|
|**[APPLICATION-ATTACK-SESSION-FIXATION](#drs943-11)**|セッション固定攻撃から保護します|
|**[APPLICATION-ATTACK-SESSION-JAVA](#drs944-11)**|Java 攻撃から保護します|
|**[MS-ThreatIntel-WebShells](#drs9905-11)**|Web シェル攻撃から保護します|
|**[MS-ThreatIntel-AppSec](#drs9903-11)**|AppSec 攻撃から保護します|
|**[MS-ThreatIntel-SQLI](#drs99031-11)**|SQLI 攻撃から保護します|
|**[MS-ThreatIntel-CVEs](#drs99001-11)**|CVE 攻撃から保護します|

### <a name="drs-10"></a>DRS 1.0

|規則グループ|説明|
|---|---|
|**[PROTOCOL-ATTACK](#drs921-10)**|ヘッダー インジェクション、要求スマグリング、応答分割から保護します|
|**[APPLICATION-ATTACK-LFI](#drs930-10)**|ファイル攻撃やパス攻撃から保護します|
|**[APPLICATION-ATTACK-RFI](#drs931-10)**|リモート ファイル インクルージョン攻撃から保護します|
|**[APPLICATION-ATTACK-RCE](#drs932-10)**|リモート コマンド実行から保護します|
|**[APPLICATION-ATTACK-PHP](#drs933-10)**|PHP インジェクション攻撃から保護します|
|**[APPLICATION-ATTACK-SQLI](#drs942-10)**|SQL インジェクション攻撃から保護します|
|**[APPLICATION-ATTACK-SESSION-FIXATION](#drs943-10)**|セッション固定攻撃から保護します|
|**[APPLICATION-ATTACK-SESSION-JAVA](#drs944-10)**|Java 攻撃から保護します|



### <a name="bot-rules"></a>ボットの規則

|規則グループ|説明|
|---|---|
|**[BadBots](#bot100)**|問題のあるボットから保護します|
|**[GoodBots](#bot200)**|問題のないボットを識別します|
|**[UnknownBots](#bot300)**|不明なボットを識別します|



次の規則グループと規則は、Azure Front Door で Web Application Firewall を使用するときに利用できます。

# <a name="drs-20"></a>[DRS 2.0](#tab/drs20)

## <a name="20-rule-sets"></a><a name="drs20"></a> 2.0 の規則セット

### <a name="general"></a><a name="general-20"></a> 全般
|RuleId|説明|
|---|---|
|200002|要求本文を解析できませんでした。|
|200003|マルチパートの要求本文が厳密な検証に失敗しました。|


### <a name="method-enforcement"></a><a name="drs911-20"></a> METHOD ENFORCEMENT
|RuleId|説明|
|---|---|
|911100|メソッドがポリシーによって許可されていません|

### <a name="protocol-enforcement"></a><a name="drs920-20"></a> PROTOCOL-ENFORCEMENT
|RuleId|説明|
|---|---|
|920100|無効な HTTP 要求行|
|920120|マルチパート/フォームデータのバイパスを試行しました|
|920121|マルチパート/フォームデータのバイパスを試行しました|
|920160|Content-Length HTTP ヘッダーが数値ではありません。|
|920170|本文コンテンツがある GET または HEAD 要求。|
|920171|転送エンコードがある GET または HEAD 要求。|
|920180|POST 要求に Content-Length ヘッダーがありません。|
|920190|範囲: 無効な最終バイト値。|
|920200|範囲: フィールドが多すぎます (6 以上)|
|920201|範囲: pdf 要求のフィールドが多すぎます (35 以上)|
|920210|複数の/競合している接続ヘッダー データが見つかりました。|
|920220|URL エンコード悪用攻撃の試行|
|920230|複数の URL エンコードが検出されました|
|920240|URL エンコード悪用攻撃の試行|
|920260|Unicode 全/半角悪用攻撃の試行|
|920270|要求に無効な文字が含まれています (null 文字)|
|920271|要求に無効な文字が含まれています (印字できない文字)|
|920280|要求にホスト ヘッダーがありません|
|920290|ホスト ヘッダーが空です|
|920300|要求に Accept ヘッダーがありません|
|920310|要求に空の Accept ヘッダーがあります|
|920311|要求に空の Accept ヘッダーがあります|
|920320|User Agent ヘッダーがありません|
|920330|User Agent ヘッダーが空です|
|920340|要求にコンテンツは含まれていますが、Content-Type ヘッダーがありません|
|920341|コンテンツを含む要求には、Content-Type ヘッダーが必要です|
|920350|ホスト ヘッダーが数値 IP アドレスです|
|920420|要求のコンテンツの種類がポリシーによって許可されていません|
|920430|HTTP プロトコルのバージョンがポリシーによって許可されていません|
|920440|URL ファイル拡張子がポリシーによって制限されています|
|920450|HTTP ヘッダーがポリシーによって制限されています|
|920470|無効な Content-Type ヘッダー|
|920480|要求のコンテンツの種類の文字セットが、ポリシーによって許可されません|

### <a name="protocol-attack"></a><a name="drs921-20"></a> PROTOCOL-ATTACK

|RuleId|説明|
|---|---|
|921110|HTTP 要求スマグリング攻撃|
|921120|HTTP 応答分割攻撃|
|921130|HTTP 応答分割攻撃|
|921140|ヘッダーによる HTTP ヘッダー インジェクション攻撃|
|921150|ペイロードによる HTTP ヘッダー インジェクション攻撃 (CR/LF 検出)|
|921151|ペイロードによる HTTP ヘッダー インジェクション攻撃 (CR/LF 検出)|
|921160|ペイロードによる HTTP ヘッダー インジェクション攻撃 (CR/LF および header-name 検出)|

### <a name="lfi---local-file-inclusion"></a><a name="drs930-20"></a> LFI - ローカル ファイル インクルージョン
|RuleId|説明|
|---|---|
|930100|パス トラバーサル攻撃 (/../)|
|930110|パス トラバーサル攻撃 (/../)|
|930120|OS ファイル アクセスの試行|
|930130|制限付きファイル アクセスの試行|

### <a name="rfi---remote-file-inclusion"></a><a name="drs931-20"></a> RFI - リモート ファイル インクルージョン
|RuleId|説明|
|---|---|
|931100|リモート ファイル インクルード (RFI) 攻撃の可能性あり: IP アドレスを使用している URL パラメーター|
|931110|リモート ファイル インクルード (RFI) 攻撃の可能性あり: URL ペイロードと共に使用される一般的な RFI 脆弱性パラメーター名|
|931120|リモート ファイル インクルード (RFI) 攻撃の可能性あり: 末尾の疑問符 (?) と共に使用される URL ペイロード|
|931130|可能性のあるリモート ファイル インクルード (RFI) 攻撃: ドメイン外参照/リンク|

### <a name="rce---remote-command-execution"></a><a name="drs932-20"></a> RCE - リモート コマンド実行
|RuleId|説明|
|---|---|
|932100|リモート コマンド実行: UNIX コマンド インジェクション|
|932105|リモート コマンド実行: UNIX コマンド インジェクション|
|932110|リモート コマンド実行: Windows コマンド インジェクション|
|932115|リモート コマンド実行: Windows コマンド インジェクション|
|932120|リモート コマンド実行: Windows PowerShell コマンドが見つかりました|
|932130|リモート コマンド実行: Unix シェル式が見つかりました|
|932140|リモート コマンド実行: Windows FOR/IF コマンドが見つかりました|
|932150|リモート コマンド実行: Unix コマンドの直接実行|
|932160|リモート コマンド実行: Unix シェル コードが見つかりました|
|932170|リモート コマンド実行: Shellshock (CVE-2014-6271)|
|932171|リモート コマンド実行: Shellshock (CVE-2014-6271)|
|932180|制限付きファイル アップロードの試行|

### <a name="php-attacks"></a><a name="drs933-20"></a> PHP 攻撃
|RuleId|説明|
|---|---|
|933100|PHP インジェクション攻撃: 開始または終了タグが見つかりました|
|933110|PHP インジェクション攻撃: PHP スクリプト ファイルのアップロードが見つかりました|
|933120|PHP インジェクション攻撃: 構成ディレクティブが見つかりました|
|933130|PHP インジェクション攻撃: 変数が見つかりました|
|933131|PHP インジェクション攻撃: 変数が見つかりました|
|933140|PHP インジェクション攻撃: I/O ストリームが見つかりました|
|933150|PHP インジェクション攻撃: 危険度の高い PHP 関数名が見つかりました|
|933151|PHP インジェクション攻撃: 危険度が中程度の PHP 関数名が見つかりました|
|933160|PHP インジェクション攻撃: 危険度の高い PHP 関数呼び出しが見つかりました|
|933161|PHP インジェクション攻撃: 低い値の PHP 関数呼び出しが見つかりました|
|933170|PHP インジェクション攻撃: シリアル化されたオブジェクトの挿入|
|933180|PHP インジェクション攻撃: 可変関数呼び出しが見つかりました|
|933200|PHP インジェクション攻撃: ラッパー スキームが検出されました|
|933210|PHP インジェクション攻撃: 関数呼び出しが見つかりました|

### <a name="node-js-attacks"></a><a name="drs934-20"></a> Node JS 攻撃
|RuleId|説明|
|---|---|
|934100|Node.js インジェクション攻撃|

### <a name="xss---cross-site-scripting"></a><a name="drs941-20"></a> XSS - クロスサイト スクリプティング
|RuleId|説明|
|---|---|
|941100|libinjection を通じて XSS 攻撃が検出されました|
|941101|libinjection を通じて XSS 攻撃が検出されました。|
|941110|XSS フィルター - カテゴリ 1: スクリプト タグ ベクター|
|941120|XSS フィルター - カテゴリ 2: イベント ハンドラー ベクター|
|941130|XSS フィルター - カテゴリ 3: 属性ベクター|
|941140|XSS フィルター - カテゴリ 4: JavaScript URI ベクター|
|941150|XSS フィルター - カテゴリ 5: 許可されていない HTML 属性|
|941160|NoScript XSS InjectionChecker: HTML インジェクション|
|941170|NoScript XSS InjectionChecker: 属性インジェクション|
|941180|ノード検証コントロールのブラックリスト キーワード|
|941190|スタイル シートを使用する XSS|
|941200|VML フレームを使用する XSS|
|941210|難読化 JavaScript を使用する XSS|
|941220|難読化 VB Script を使用する XSS|
|941230|'embed' タグを使用する XSS|
|941240|'import' または 'implementation' 属性を使用する XSS|
|941250|IE XSS フィルター - 攻撃が検出されました。|
|941260|'meta' タグを使用する XSS|
|941270|'link' href を使用する XSS|
|941280|'base' タグを使用する XSS|
|941290|'applet' タグを使用する XSS|
|941300|'object' タグを使用する XSS|
|941310|US-ASCII 非整形式エンコード XSS フィルター - 攻撃が検出されました。|
|941320|可能性のある XSS 攻撃が検出されました - HTML タグ ハンドラー|
|941330|IE XSS フィルター - 攻撃が検出されました。|
|941340|IE XSS フィルター - 攻撃が検出されました。|
|941350|UTF-7 エンコード IE XSS - 攻撃が検出されました。|
|941360|JavaScript の難読化が検出されました。|
|941370|JavaScript のグローバル変数が見つかりました|
|941380|AngularJS クライアント側テンプレート インジェクションが検出されました|

>[!NOTE]
> この記事には、Microsoft では使用されなくなった "*ブラックリスト*" という用語への言及があります。 ソフトウェアからこの用語が削除された時点で、この記事から削除します。


### <a name="sqli---sql-injection"></a><a name="drs942-20"></a> SQLI - SQL インジェクション
|RuleId|説明|
|---|---|
|942100|libinjection を通じて SQL インジェクション攻撃が検出されました|
|942110|SQL インジェクション攻撃:一般的なインジェクション テストが検出されました|
|942120|SQL インジェクション攻撃:SQL 演算子が検出されました|
|942130|SQL インジェクション攻撃:SQL トートロジーが検出されました。|
|942140|SQL インジェクション攻撃: 共通 DB 名が検出されました|
|942150|SQL インジェクション攻撃|
|942160|sleep() または benchmark() を使用して、ブラインド sqli テストを検出します。|
|942170|条件付きクエリも含めて、SQL ベンチマークとスリープ インジェクション試行を検出します|
|942180|基本的な SQL 認証のバイパスの試行 1/3 を検出します|
|942190|MSSQL コード実行と情報収集の試行を検出します。|
|942200|MySQL コメント/スペース難読化インジェクションとバッククォートの終了を検出します|
|942210|チェーンされた SQL インジェクション試行 1/2 を検出します|
|942220|整数オーバーフロー攻撃を探しています。これらは、skipfish から取得されます。ただし、3.0.00738585072007e-308 は "マジック番号" クラッシュであるため除きます|
|942230|条件付き SQL インジェクション試行を検出します|
|942240|MySQL 文字セット スイッチと MSSQL DoS 試行を検出します|
|942250|MATCH AGAINST、MERGE、EXECUTE IMMEDIATE インジェクションを検出します|
|942260|基本的な SQL 認証のバイパスの試行 2/3 を検出します|
|942270|基本的な sql インジェクションを探しています。 mysql、oracle、その他の共通攻撃文字列。|
|942280|Postgres pg_sleep インジェクション、waitfor delay 攻撃、データベース シャットダウン試行を検出します|
|942290|基本的な MongoDB SQL インジェクション試行を探します|
|942300|MySQL コメント、条件、および ch(a)r インジェクションを検出します|
|942310|チェーンされた SQL インジェクション試行 2/2 を検出します|
|942320|MySQL および PostgreSQL ストアド プロシージャ/関数インジェクションを検出します|
|942330|従来の SQL インジェクション プローブ 1/2 を検出します|
|942340|基本的な SQL 認証のバイパスの試行 3/3 を検出します|
|942350|MySQL UDF インジェクションと、その他のデータ/構造操作試行を検出します|
|942360|連結された基本的な SQL インジェクションと SQLLFI 試行を検出します|
|942361|キーワード alter または union に基づいて基本的な SQL インジェクションを検出します|
|942370|従来の SQL インジェクション プローブ 2/2 を検出します|
|942380|SQL インジェクション攻撃|
|942390|SQL インジェクション攻撃|
|942400|SQL インジェクション攻撃|
|942410|SQL インジェクション攻撃|
|942430|制限された SQL 文字の異常検出 (引数): 特殊文字数が超過しました (12)|
|942440|SQL コメント シーケンスが検出されました。|
|942450|SQL 16 進数エンコードが識別されました|
|942460|メタ文字の異常検出アラート - 反復する非単語文字|
|942470|SQL インジェクション攻撃|
|942480|SQL インジェクション攻撃|
|942500|MySQL のインライン コメントが検出されました。|
|942510|ティックまたはバックティックによる SQLi バイパス試行が検出されました。|


### <a name="session-fixation"></a><a name="drs943-20"></a> SESSION-FIXATION
|RuleId|説明|
|---|---|
|943100|可能性のあるセッション固定攻撃: HTML への Cookie 値の設定|
|943110|可能性のあるセッション固定攻撃: SessionID パラメーター名とドメイン外参照元|
|943120|可能性のあるセッション固定攻撃: 参照元のない SessionID パラメーター名|

### <a name="java-attacks"></a><a name="drs944-20"></a> JAVA 攻撃
|RuleId|説明|
|---|---|
|944100|リモート コマンド実行: Apache Struts、Oracle WebLogic|
|944110|ペイロード実行の可能性を検出します|
|944120|可能性のあるペイロード実行とリモート コマンド実行|
|944130|不審な Java クラス|
|944200|Java 逆シリアル化 Apache Commons の悪用|
|944210|Java シリアル化の使用の可能性|
|944240|リモート コマンド実行: Java シリアル化|
|944250|リモート コマンド実行: 疑わしい Java メソッドが検出されました|

### <a name="ms-threatintel-webshells"></a><a name="drs9905-20"></a> MS-ThreatIntel-WebShells
|RuleId|説明|
|---|---|
|99005002|Web シェル相互作用の試行 (POST)|
|99005003|Web シェル アップロードの試行 (POST) - CHOPPER PHP|
|99005004|Web シェル アップロードの試行 (POST) - CHOPPER ASPX|

### <a name="ms-threatintel-appsec"></a><a name="drs9903-20"></a> MS-ThreatIntel-AppSec
|RuleId|説明|
|---|---|
|99030001|ヘッダーでのパス トラバーサル回避 (/.././../)|
|99030002|要求本文でのパス トラバーサル回避 (/.././../)|

### <a name="ms-threatintel-sqli"></a><a name="drs99031-20"></a> MS-ThreatIntel-SQLI
|RuleId|説明|
|---|---|
|99031001|SQL インジェクション攻撃:一般的なインジェクション テストが検出されました|
|99031002|SQL コメント シーケンスが検出されました。|

### <a name="ms-threatintel-cves"></a><a name="drs99001-20"></a> MS-ThreatIntel-CVEs
|RuleId|説明|
|---|---|
|99001001|既知の資格情報で F5 tmui (CVE-2020-5902) REST API の悪用が試みられました|

# <a name="drs-11"></a>[DRS 1.1](#tab/drs11)

## <a name="11-rule-sets"></a><a name="drs11"></a> 1.1 の規則セット

### <a name="protocol-attack"></a><a name="drs921-11"></a> PROTOCOL-ATTACK
|RuleId|説明|
|---|---|
|921110|HTTP 要求スマグリング攻撃|
|921120|HTTP 応答分割攻撃|
|921130|HTTP 応答分割攻撃|
|921140|ヘッダーによる HTTP ヘッダー インジェクション攻撃|
|921150|ペイロードによる HTTP ヘッダー インジェクション攻撃 (CR/LF 検出)|
|921151|ペイロードによる HTTP ヘッダー インジェクション攻撃 (CR/LF 検出)|
|921160|ペイロードによる HTTP ヘッダー インジェクション攻撃 (CR/LF および header-name 検出)|

### <a name="lfi---local-file-inclusion"></a><a name="drs930-11"></a> LFI - ローカル ファイル インクルージョン
|RuleId|説明|
|---|---|
|930100|パス トラバーサル攻撃 (/../)|
|930110|パス トラバーサル攻撃 (/../)|
|930120|OS ファイル アクセスの試行|
|930130|制限付きファイル アクセスの試行|

### <a name="rfi---remote-file-inclusion"></a><a name="drs931-11"></a> RFI - リモート ファイル インクルージョン
|RuleId|説明|
|---|---|
|931100|リモート ファイル インクルード (RFI) 攻撃の可能性あり: IP アドレスを使用している URL パラメーター|
|931110|リモート ファイル インクルード (RFI) 攻撃の可能性あり: URL ペイロードと共に使用される一般的な RFI 脆弱性パラメーター名|
|931120|リモート ファイル インクルード (RFI) 攻撃の可能性あり: 末尾の疑問符 (?) と共に使用される URL ペイロード|
|931130|可能性のあるリモート ファイル インクルード (RFI) 攻撃: ドメイン外参照/リンク|

### <a name="rce---remote-command-execution"></a><a name="drs932-11"></a> RCE - リモート コマンド実行
|RuleId|説明|
|---|---|
|932100|リモート コマンド実行: UNIX コマンド インジェクション|
|932105|リモート コマンド実行: UNIX コマンド インジェクション|
|932110|リモート コマンド実行: Windows コマンド インジェクション|
|932115|リモート コマンド実行: Windows コマンド インジェクション|
|931120|リモート コマンド実行: Windows PowerShell コマンドが見つかりました|
|932130|リモート コマンド実行: Unix シェル式が見つかりました|
|932140|リモート コマンド実行: Windows FOR/IF コマンドが見つかりました|
|932150|リモート コマンド実行: Unix コマンドの直接実行|
|932160|リモート コマンド実行: Shellshock (CVE-2014-6271)|
|932170|リモート コマンド実行: Shellshock (CVE-2014-6271)|
|932171|リモート コマンド実行: Shellshock (CVE-2014-6271)|
|932180|制限付きファイル アップロードの試行|

### <a name="php-attacks"></a><a name="drs933-11"></a> PHP 攻撃
|RuleId|説明|
|---|---|
|933100|PHP インジェクション攻撃: PHP の開始タグが見つかりました|
|933110|PHP インジェクション攻撃: PHP スクリプト ファイルのアップロードが見つかりました|
|933120|PHP インジェクション攻撃: 構成ディレクティブが見つかりました|
|933130|PHP インジェクション攻撃: 変数が見つかりました|
|933140|PHP インジェクション攻撃: I/O ストリームが見つかりました|
|933150|PHP インジェクション攻撃: 危険度の高い PHP 関数名が見つかりました|
|933151|PHP インジェクション攻撃: 危険度が中程度の PHP 関数名が見つかりました|
|933160|PHP インジェクション攻撃: 危険度の高い PHP 関数呼び出しが見つかりました|
|933170|PHP インジェクション攻撃: シリアル化されたオブジェクトの挿入|
|933180|PHP インジェクション攻撃: 関数呼び出しが見つかりました|

### <a name="xss---cross-site-scripting"></a><a name="drs941-11"></a> XSS - クロスサイト スクリプティング
|RuleId|説明|
|---|---|
|941100|libinjection を通じて XSS 攻撃が検出されました|
|941101|libinjection を通じて XSS 攻撃が検出されました|
|941110|XSS フィルター - カテゴリ 1: スクリプト タグ ベクター|
|941120|XSS フィルター - カテゴリ 2: イベント ハンドラー ベクター|
|941130|XSS フィルター - カテゴリ 3: 属性ベクター|
|941140|XSS フィルター - カテゴリ 4: Javascript URI ベクター|
|941150|XSS フィルター - カテゴリ 5: 許可されていない HTML 属性|
|941160|NoScript XSS InjectionChecker: HTML インジェクション|
|941170|NoScript XSS InjectionChecker: 属性インジェクション|
|941180|ノード検証コントロールのブラックリスト キーワード|
|941190|IE XSS フィルター - 攻撃が検出されました。|
|941200|IE XSS フィルター - 攻撃が検出されました。|
|941210|IE XSS フィルター - 攻撃が検出されました。|
|941220|IE XSS フィルター - 攻撃が検出されました。|
|941230|IE XSS フィルター - 攻撃が検出されました。|
|941240|IE XSS フィルター - 攻撃が検出されました。|
|941250|IE XSS フィルター - 攻撃が検出されました。|
|941260|IE XSS フィルター - 攻撃が検出されました。|
|941270|IE XSS フィルター - 攻撃が検出されました。|
|941280|IE XSS フィルター - 攻撃が検出されました。|
|941290|IE XSS フィルター - 攻撃が検出されました。|
|941300|IE XSS フィルター - 攻撃が検出されました。|
|941310|US-ASCII 非整形式エンコード XSS フィルター - 攻撃が検出されました。|
|941320|可能性のある XSS 攻撃が検出されました - HTML タグ ハンドラー|
|941330|IE XSS フィルター - 攻撃が検出されました。|
|941340|IE XSS フィルター - 攻撃が検出されました。|
|941350|UTF-7 エンコード IE XSS - 攻撃が検出されました。|

>[!NOTE]
> この記事には、Microsoft では使用されなくなった "*ブラックリスト*" という用語への言及があります。 ソフトウェアからこの用語が削除された時点で、この記事から削除します。

### <a name="sqli---sql-injection"></a><a name="drs942-11"></a> SQLI - SQL インジェクション
|RuleId|説明|
|---|---|
|942100|libinjection を通じて SQL インジェクション攻撃が検出されました|
|942110|SQL インジェクション攻撃:一般的なインジェクション テストが検出されました|
|942120|SQL インジェクション攻撃:SQL 演算子が検出されました|
|942140|SQL インジェクション攻撃: 共通 DB 名が検出されました|
|942150|SQL インジェクション攻撃|
|942160|sleep() または benchmark() を使用して、ブラインド sqli テストを検出します。|
|942170|条件付きクエリも含めて、SQL ベンチマークとスリープ インジェクション試行を検出します|
|942180|基本的な SQL 認証のバイパスの試行 1/3 を検出します|
|942190|MSSQL コード実行と情報収集の試行を検出します。|
|942200|MySQL コメント/スペース難読化インジェクションとバッククォートの終了を検出します|
|942210|チェーンされた SQL インジェクション試行 1/2 を検出します|
|942220|整数オーバーフロー攻撃を探しています。これらは、skipfish から取得されます。ただし、3.0.00738585072007e-308 は "マジック番号" クラッシュであるため除きます|
|942230|条件付き SQL インジェクション試行を検出します|
|942240|MySQL 文字セット スイッチと MSSQL DoS 試行を検出します|
|942250|MATCH AGAINST、MERGE、EXECUTE IMMEDIATE インジェクションを検出します|
|942260|基本的な SQL 認証のバイパスの試行 2/3 を検出します|
|942270|基本的な sql インジェクションを探しています。 mysql oracle などの共通攻撃文字列。|
|942280|Postgres pg_sleep インジェクション、waitfor delay 攻撃、データベース シャットダウン試行を検出します|
|942290|基本的な MongoDB SQL インジェクション試行を探します|
|942300|MySQL コメント、条件、および ch(a)r インジェクションを検出します。|
|942310|チェーンされた SQL インジェクション試行 2/2 を検出します|
|942320|MySQL および PostgreSQL ストアド プロシージャ/関数インジェクションを検出します|
|942330|従来の SQL インジェクション プローブ 1/3 を検出します|
|942340|基本的な SQL 認証のバイパスの試行 3/3 を検出します|
|942350|MySQL UDF インジェクションと、その他のデータ/構造操作試行を検出します|
|942360|連結された基本的な SQL インジェクションと SQLLFI 試行を検出します|
|942361|キーワード alter または union に基づいて基本的な SQL インジェクションを検出します|
|942370|従来の SQL インジェクション プローブ 2/3 を検出します|
|942380|SQL インジェクション攻撃|
|942390|SQL インジェクション攻撃|
|942400|SQL インジェクション攻撃|
|942410|SQL インジェクション攻撃|
|942430|制限された SQL 文字の異常検出 (引数): 特殊文字数が超過しました (12)|
|942440|SQL コメント シーケンスが検出されました。|
|942450|SQL 16 進数エンコードが識別されました|
|942470|SQL インジェクション攻撃|
|942480|SQL インジェクション攻撃|

### <a name="session-fixation"></a><a name="drs943-11"></a> SESSION-FIXATION
|RuleId|説明|
|---|---|
|943100|可能性のあるセッション固定攻撃: HTML への Cookie 値の設定|
|943110|可能性のあるセッション固定攻撃: SessionID パラメーター名とドメイン外参照元|
|943120|可能性のあるセッション固定攻撃: 参照元のない SessionID パラメーター名|

### <a name="java-attacks"></a><a name="drs944-11"></a> JAVA 攻撃
|RuleId|説明|
|---|---|
|944100|リモート コマンド実行: 疑わしい Java クラスが検出されました|
|944110|可能性のあるセッション固定攻撃: HTML への Cookie 値の設定|
|944120|リモート コマンド実行: Java シリアル化 (CVE-2015-5842)|
|944130|疑わしい Java クラスが検出されました|
|944200|マジック バイトが検出されました。Java シリアル化が使用されている可能性があります|
|944210|Base64 でエンコードされたマジック バイトが検出されました。Java シリアル化が使用されている可能性があります|
|944240|リモート コマンド実行: Java シリアル化 (CVE-2015-5842)|
|944250|リモート コマンド実行: 疑わしい Java メソッドが検出されました|

### <a name="ms-threatintel-webshells"></a><a name="drs9905-11"></a> MS-ThreatIntel-WebShells
|RuleId|説明|
|---|---|
|99005002|Web シェル相互作用の試行 (POST)|
|99005003|Web シェル アップロードの試行 (POST) - CHOPPER PHP|
|99005004|Web シェル アップロードの試行 (POST) - CHOPPER ASPX|

### <a name="ms-threatintel-appsec"></a><a name="drs9903-11"></a> MS-ThreatIntel-AppSec
|RuleId|説明|
|---|---|
|99030001|ヘッダーでのパス トラバーサル回避 (/.././../)|
|99030002|要求本文でのパス トラバーサル回避 (/.././../)|

### <a name="ms-threatintel-sqli"></a><a name="drs99031-11"></a> MS-ThreatIntel-SQLI
|RuleId|説明|
|---|---|
|99031001|SQL インジェクション攻撃:一般的なインジェクション テストが検出されました|
|99031002|SQL コメント シーケンスが検出されました。|

### <a name="ms-threatintel-cves"></a><a name="drs99001-11"></a> MS-ThreatIntel-CVEs
|RuleId|説明|
|---|---|
|99001001|既知の資格情報で F5 tmui (CVE-2020-5902) REST API の悪用が試みられました|

# <a name="drs-10"></a>[DRS 1.0](#tab/drs10)

## <a name="10-rule-sets"></a><a name="drs10"></a> 1.0 の規則セット

### <a name="protocol-attack"></a><a name="drs921-10"></a> PROTOCOL-ATTACK
|RuleId|説明|
|---|---|
|921110|HTTP 要求スマグリング攻撃|
|921120|HTTP 応答分割攻撃|
|921130|HTTP 応答分割攻撃|
|921140|ヘッダーによる HTTP ヘッダー インジェクション攻撃|
|921150|ペイロードによる HTTP ヘッダー インジェクション攻撃 (CR/LF 検出)|
|921151|ペイロードによる HTTP ヘッダー インジェクション攻撃 (CR/LF 検出)|
|921160|ペイロードによる HTTP ヘッダー インジェクション攻撃 (CR/LF および header-name 検出)|

### <a name="lfi---local-file-inclusion"></a><a name="drs930-10"></a> LFI - ローカル ファイル インクルージョン
|RuleId|説明|
|---|---|
|930100|パス トラバーサル攻撃 (/../)|
|930110|パス トラバーサル攻撃 (/../)|
|930120|OS ファイル アクセスの試行|
|930130|制限付きファイル アクセスの試行|

### <a name="rfi---remote-file-inclusion"></a><a name="drs931-10"></a> RFI - リモート ファイル インクルージョン
|RuleId|説明|
|---|---|
|931100|リモート ファイル インクルード (RFI) 攻撃の可能性あり: IP アドレスを使用している URL パラメーター|
|931110|リモート ファイル インクルード (RFI) 攻撃の可能性あり: URL ペイロードと共に使用される一般的な RFI 脆弱性パラメーター名|
|931120|リモート ファイル インクルード (RFI) 攻撃の可能性あり: 末尾の疑問符 (?) と共に使用される URL ペイロード|
|931130|可能性のあるリモート ファイル インクルード (RFI) 攻撃: ドメイン外参照/リンク|

### <a name="rce---remote-command-execution"></a><a name="drs932-10"></a> RCE - リモート コマンド実行
|RuleId|説明|
|---|---|
|932100|リモート コマンド実行: UNIX コマンド インジェクション|
|932105|リモート コマンド実行: UNIX コマンド インジェクション|
|932110|リモート コマンド実行: Windows コマンド インジェクション|
|932115|リモート コマンド実行: Windows コマンド インジェクション|
|932120|リモート コマンド実行: Windows PowerShell コマンドが見つかりました|
|932130|リモート コマンド実行: Unix シェル式が見つかりました|
|932140|リモート コマンド実行: Windows FOR/IF コマンドが見つかりました|
|932150|リモート コマンド実行: Unix コマンドの直接実行|
|932160|リモート コマンド実行: Unix シェル コードが見つかりました|
|932170|リモート コマンド実行: Shellshock (CVE-2014-6271)|
|932171|リモート コマンド実行: Shellshock (CVE-2014-6271)|
|932180|制限付きファイル アップロードの試行|

### <a name="php-attacks"></a><a name="drs933-10"></a> PHP 攻撃
|RuleId|説明|
|---|---|
|933100|PHP インジェクション攻撃: 開始または終了タグが見つかりました|
|933110|PHP インジェクション攻撃: PHP スクリプト ファイルのアップロードが見つかりました|
|933120|PHP インジェクション攻撃: 構成ディレクティブが見つかりました|
|933130|PHP インジェクション攻撃: 変数が見つかりました|
|933131|PHP インジェクション攻撃: 変数が見つかりました|
|933140|PHP インジェクション攻撃: I/O ストリームが見つかりました|
|933150|PHP インジェクション攻撃: 危険度の高い PHP 関数名が見つかりました|
|933151|PHP インジェクション攻撃: 危険度が中程度の PHP 関数名が見つかりました|
|933160|PHP インジェクション攻撃: 危険度の高い PHP 関数呼び出しが見つかりました|
|933161|PHP インジェクション攻撃: 低い値の PHP 関数呼び出しが見つかりました|
|933170|PHP インジェクション攻撃: シリアル化されたオブジェクトの挿入|
|933180|PHP インジェクション攻撃: 関数呼び出しが見つかりました|

### <a name="xss---cross-site-scripting"></a><a name="drs941-10"></a> XSS - クロスサイト スクリプティング
|RuleId|説明|
|---|---|
|941100|libinjection を通じて XSS 攻撃が検出されました|
|941101|libinjection を通じて XSS 攻撃が検出されました。|
|941110|XSS フィルター - カテゴリ 1: スクリプト タグ ベクター|
|941120|XSS フィルター - カテゴリ 2: イベント ハンドラー ベクター|
|941130|XSS フィルター - カテゴリ 3: 属性ベクター|
|941140|XSS フィルター - カテゴリ 4: JavaScript URI ベクター|
|941150|XSS フィルター - カテゴリ 5: 許可されていない HTML 属性|
|941160|NoScript XSS InjectionChecker: HTML インジェクション|
|941170|NoScript XSS InjectionChecker: 属性インジェクション|
|941180|ノード検証コントロールのブラックリスト キーワード|
|941190|スタイル シートを使用する XSS|
|941200|VML フレームを使用する XSS|
|941210|難読化 JavaScript を使用する XSS|
|941220|難読化 VB Script を使用する XSS|
|941230|'embed' タグを使用する XSS|
|941240|'import' または 'implementation' 属性を使用する XSS|
|941250|IE XSS フィルター - 攻撃が検出されました。|
|941260|'meta' タグを使用する XSS|
|941270|'link' href を使用する XSS|
|941280|'base' タグを使用する XSS|
|941290|'applet' タグを使用する XSS|
|941300|'object' タグを使用する XSS|
|941310|US-ASCII 非整形式エンコード XSS フィルター - 攻撃が検出されました。|
|941320|可能性のある XSS 攻撃が検出されました - HTML タグ ハンドラー|
|941330|IE XSS フィルター - 攻撃が検出されました。|
|941340|IE XSS フィルター - 攻撃が検出されました。|
|941350|UTF-7 エンコード IE XSS - 攻撃が検出されました。|

>[!NOTE]
> この記事には、Microsoft では使用されなくなった "*ブラックリスト*" という用語への言及があります。 ソフトウェアからこの用語が削除された時点で、この記事から削除します。

### <a name="sqli---sql-injection"></a><a name="drs942-10"></a> SQLI - SQL インジェクション
|RuleId|説明|
|---|---|
|942100|libinjection を通じて SQL インジェクション攻撃が検出されました|
|942110|SQL インジェクション攻撃:一般的なインジェクション テストが検出されました|
|942120|SQL インジェクション攻撃:SQL 演算子が検出されました|
|942140|SQL インジェクション攻撃: 共通 DB 名が検出されました|
|942150|SQL インジェクション攻撃|
|942160|sleep() または benchmark() を使用して、ブラインド sqli テストを検出します。|
|942170|条件付きクエリも含めて、SQL ベンチマークとスリープ インジェクション試行を検出します|
|942180|基本的な SQL 認証のバイパスの試行 1/3 を検出します|
|942190|MSSQL コード実行と情報収集の試行を検出します。|
|942200|MySQL コメント/スペース難読化インジェクションとバッククォートの終了を検出します|
|942210|チェーンされた SQL インジェクション試行 1/2 を検出します|
|942220|整数オーバーフロー攻撃を探しています。これらは、skipfish から取得されます。ただし、3.0.00738585072007e-308 は "マジック番号" クラッシュであるため除きます|
|942230|条件付き SQL インジェクション試行を検出します|
|942240|MySQL 文字セット スイッチと MSSQL DoS 試行を検出します|
|942250|MATCH AGAINST、MERGE、EXECUTE IMMEDIATE インジェクションを検出します|
|942260|基本的な SQL 認証のバイパスの試行 2/3 を検出します|
|942270|基本的な sql インジェクションを探しています。 mysql、oracle、その他の共通攻撃文字列。|
|942280|Postgres pg_sleep インジェクション、waitfor delay 攻撃、データベース シャットダウン試行を検出します|
|942290|基本的な MongoDB SQL インジェクション試行を探します|
|942300|MySQL コメント、条件、および ch(a)r インジェクションを検出します|
|942310|チェーンされた SQL インジェクション試行 2/2 を検出します|
|942320|MySQL および PostgreSQL ストアド プロシージャ/関数インジェクションを検出します|
|942330|従来の SQL インジェクション プローブ 1/2 を検出します|
|942340|基本的な SQL 認証のバイパスの試行 3/3 を検出します|
|942350|MySQL UDF インジェクションと、その他のデータ/構造操作試行を検出します|
|942360|連結された基本的な SQL インジェクションと SQLLFI 試行を検出します|
|942361|キーワード alter または union に基づいて基本的な SQL インジェクションを検出します|
|942370|従来の SQL インジェクション プローブ 2/2 を検出します|
|942380|SQL インジェクション攻撃|
|942390|SQL インジェクション攻撃|
|942400|SQL インジェクション攻撃|
|942410|SQL インジェクション攻撃|
|942430|制限された SQL 文字の異常検出 (引数): 特殊文字数が超過しました (12)|
|942440|SQL コメント シーケンスが検出されました。|
|942450|SQL 16 進数エンコードが識別されました|
|942470|SQL インジェクション攻撃|
|942480|SQL インジェクション攻撃|

### <a name="session-fixation"></a><a name="drs943-10"></a> SESSION-FIXATION
|RuleId|説明|
|---|---|
|943100|可能性のあるセッション固定攻撃: HTML への Cookie 値の設定|
|943110|可能性のあるセッション固定攻撃: SessionID パラメーター名とドメイン外参照元|
|943120|可能性のあるセッション固定攻撃: 参照元のない SessionID パラメーター名|

### <a name="java-attacks"></a><a name="drs944-10"></a> JAVA 攻撃
|RuleId|説明|
|---|---|
|944100|リモート コマンド実行: Apache Struts、Oracle WebLogic|
|944110|ペイロード実行の可能性を検出します|
|944120|可能性のあるペイロード実行とリモート コマンド実行|
|944130|不審な Java クラス|
|944200|Java 逆シリアル化 Apache Commons の悪用|
|944210|Java シリアル化の使用の可能性|
|944240|リモート コマンド実行: Java シリアル化|
|944250|リモート コマンド実行: 疑わしい Java メソッドが検出されました|

# <a name="bot-rules"></a>[ボットの規則](#tab/bot)

## <a name="bot-manager-rule-sets"></a><a name="bot"></a> ボット マネージャーの規則セット

### <a name="bad-bots"></a><a name="bot100"></a> 問題のあるボット
|RuleId|説明|
|---|---|
|Bot100100|脅威インテリジェンスによって検出された悪意のあるボット|
|Bot100200|ID を偽った悪意のあるボット|

### <a name="good-bots"></a><a name="bot200"></a> 問題のないボット
|RuleId|説明|
|---|---|
|Bot200100|検索エンジン クローラー|
|Bot200200|未確認の検索エンジン クローラー|

### <a name="unknown-bots"></a><a name="bot300"></a> 不明なボット
|RuleId|説明|
|---|---|
|Bot300100|未指定の ID|
|Bot300200|Web クロールと攻撃のためのツールとフレームワーク|
|Bot300300|汎用 HTTP クライアントと SDK|
|Bot300400|サービス エージェント|
|Bot300500|サイト正常性監視サービス|
|Bot300600|脅威インテリジェンスによって検出された不明のボット|
|Bot300700|その他のボット|

---


## <a name="next-steps"></a>次のステップ

- [Azure Front Door での Web アプリケーション ファイアウォールのカスタム規則](waf-front-door-custom-rules.md)
