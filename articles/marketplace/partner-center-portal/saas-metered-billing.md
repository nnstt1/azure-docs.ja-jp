---
title: Microsoft コマーシャル マーケットプレースの測定サービスを使用した SaaS オファーの従量制課金
description: コマーシャル マーケットプレースの測定サービスを使用した SaaS オファーの柔軟な課金モデルについて説明します。
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: conceptual
ms.date: 10/15/2021
author: mingshen-ms
ms.author: mingshen
ms.openlocfilehash: 7021f75bb63e7cb7e7467cf7827a365d81b09bd6
ms.sourcegitcommit: 61f87d27e05547f3c22044c6aa42be8f23673256
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/09/2021
ms.locfileid: "132059621"
---
# <a name="metered-billing-for-saas-using-the-commercial-marketplace-metering-service"></a>コマーシャル マーケットプレースの測定サービスを使用した SaaS の従量制課金

コマーシャル マーケットプレースの測定サービスを使用すると、標準以外の単位に応じて課金される、サービスとしてのソフトウェア (SaaS) オファーを作成できます。 SaaS オファーをコマーシャル マーケットプレースに公開する前に、帯域幅、チケット、処理された電子メールなどの課金ディメンションを定義します。  お客様はこれらのディメンションの使用量に応じて支払いを行い、システムは、課金対象のイベントが発生すると、コマーシャル マーケットプレースの測定サービス API を介して Microsoft にそのイベントを通知します。  

## <a name="prerequisites-for-metered-billing"></a>従量制課金のための前提条件

従量制課金を使用するには、まず SaaS オファーが次の条件を満たすことが必要です。

- [コマーシャル マーケットプレースでの SaaS オファーの作成](../create-new-saas-offer.md)に関する記事に記載されているように、[Microsoft オファーを通じた販売](../plan-saas-offer.md#listing-options)のオファー要件をすべて満たしていること。
- お客様がプロビジョニングしてオファーに接続するための [SaaS Fulfillment API](./pc-saas-fulfillment-apis.md) と統合していること。  
- お客様に対してサービスの課金を行う際、**定額** 料金モデルが構成されていること。  ディメンションは、定額料金モデルに対するオプションの拡張機能です。 

次に、SaaS オファーは、[コマーシャル マーケットプレースの測定サービス API](../marketplace-metering-service-apis.md) と統合して、Microsoft に請求対象のイベントを通知することができます。

>[!Note]
>マーケットプレース測定サービスは定額課金モデルでのみ使用でき、ユーザーあたりの課金モデルには適用されません。

## <a name="how-metered-billing-fits-in-with-pricing"></a>価格モデルに従量制課金を適用する方法

オファーをその価格モデルとともに定義する場合、オファーの階層を理解することが重要です。

- 個々の SaaS オファーは、Microsoft を経由して、あるいは経由せずに販売するように構成されています。  オファーの公開後、このオプションを変更することはできません。
- Microsoft を経由して販売するように構成された各 SaaS オファーは、1 つまたは複数のプランを持つことができます。  ユーザーは SaaS オファーをサブスクライブしますが、オファーはプランのコンテキスト内で Microsoft を経由して購入されます。
- 各プランには、**定額料金** または **ユーザーあたり** の価格モデルが関連付けられています。 あるオファー内のすべてのプランは、同じ価格モデルに関連付けられている必要があります。 たとえば、定額料金モデルのプランと、ユーザーあたりの価格モデルのプランを併せ持つオファーは構成できません。
- 定額課金モデル用に構成された各プランには、少なくとも 1 つの定期的な料金 (0 ドルの場合もあります) が含まれています。
    - 定期的な **月額** 料金: ユーザーがプランを購入した場合に毎月定期的に前払いされる定額の月額料金。
    - 定期的な **年間** 料金: ユーザーがプランを購入した場合に毎年定期的に前払いされる定額の年間料金。
- 定期的な料金に加えて、定額プランには、定額料金に含まれない、超過使用量に応じてお客様に請求するために使用されるオプションのカスタム ディメンションを含めることもできます。  各ディメンションは、サービスが[コマーシャル マーケットプレースの測定サービス API](../marketplace-metering-service-apis.md) を使用して Microsoft に連絡すべき課金対象の項目を表しています。

> [!IMPORTANT]
> コード内の使用状況を把握し、基本料金を超えた使用分についてのみ、使用状況のイベントを Microsoft に送信する必要があります。

## <a name="sample-offer"></a>サンプル オファー

たとえば、Contoso は、Contoso Notification Services (CNS) と呼ばれる SaaS サービスを使用する公開元です。 CNS を使用するお客様は、メールまたは SMS メッセージで通知を送信できます。 Contoso は、Azure のお客様に SaaS オファーを公開するためのコマーシャル マーケットプレース プログラムの公開元としてパートナー センターに登録されています。  次に示すように、CNS に関連付けられているプランが 3 つあります。

- Basic プラン
    - 10000 件のメールと 1000 件の SMS メッセージを月 0 ドルで送信する (定額の月額料金)
    - 電子メールが 10000 件を超えると、100 件ごとに 1 ドル支払う
    - テキストが 1000 件を超えると、テキストごとに 0.02 ドル支払う

    [![Basic プランの価格](./media/saas-basic-pricing.png "クリックして拡大表示")](./media/saas-basic-pricing.png)

- Premium プラン
    - 50000 件のメールと 10000 件の SMS メッセージを月 350 ドルで送信し、500 万件のメールと 100 万件の SMS メッセージを年間 3500 ドルで送信する
    - 電子メールが 50000 件を超えると、100 件ごとに 0.5 ドル支払う
    - テキストが 10000 件を超えると、テキストごとに 0.01 ドル支払う

    [![Premium プランの価格](./media/saas-premium-pricing.png "クリックして拡大表示")](./media/saas-premium-pricing.png)

- Enterprise プラン
    - 無制限の数のメールと 50000 件の SMS メッセージを月 400 ドルで送信する
    - SMS メッセージが 50000 件を超えると、SMS メッセージごとに 0.005 ドル支払う

    [![Enterprise プランの価格](./media/saas-enterprise-pricing.png "クリックして拡大表示")](./media/saas-enterprise-pricing.png)

選択したプランに基づいて、CNS SaaS オファーのサブスクリプションを購入する Azure のお客様は、サブスクリプションの期間 (サブスクリプションの詳細に表示される startDate および endDate の月または年) に応じて、SMS メッセージとメールの無料使用量を送信できるようになります。  Contoso では、基本として含まれている無料使用料に達するまで、Microsoft に使用状況イベントを送信せずに使用量をカウントします。 お客様の使用量が無料使用量を超えた場合、プランを変更したり別のことを行ったりする必要はありません。  Contoso では、無料使用量の超過分を測定し、超過使用量の請求を目的として、[コマーシャル マーケットプレースの測定サービス API](../marketplace-metering-service-apis.md) を使用して、Microsoft に対して使用状況イベントを生成し始めます。  Microsoft ではこれに応じて、カスタム ディメンションで公開元によって指定された超過使用量の請求をお客様に対して行います。 超過分の課金が行われるのは次の課金サイクルです (毎月、ただし顧客に応じて四半期ごとにすることや、早期も可)。  定額の月額料金プランの場合、超過分の課金は、超過が発生した各月に行われます。  定額の年間料金プランの場合、1 年あたりの基本として含まれている無料使用量が消費されると、カスタム測定によって生成される追加の使用量はすべて、サブスクリプションの期間が終わるまで、各請求サイクル (毎月) の超過分として課金されます。

## <a name="billing-dimensions"></a>課金ディメンション

各課金ディメンションによって、ISV が使用状況イベントを生成できるカスタム単位が定義されます。  課金ディメンションは、ソフトウェアの使用について課金される方法を顧客に通知するためにも使用されます。 定義は次のとおりです。

- **ID**: 使用状況イベントの生成中に参照される変更できないディメンション識別子。
- **表示名**: ディメンションに関連付けられている表示名 (例: "送信された SMS メッセージ")。
- **測定単位**: 課金単位の説明 (例: "SMS メッセージごと"、"メール 100 件あたり")。
- **単価 (米国ドル)** : ディメンションの 1 単位あたりの価格。  0 にすることもできます。
- **基本として含まれている月間無料使用量**: 定期的な月額料金を支払っているお客様への 1 か月あたりのディメンションの数量。整数である必要があります。 0 または無制限にすることもできます。
- **基本として含まれている年間無料使用量**: 定期的な年間料金を支払っているお客様への 1 年あたりのディメンションの数量。整数である必要があります。 0 または無制限にすることができます。

> [!IMPORTANT]
> コード内の使用状況を把握し、基本料金を超えた使用分についてのみ、使用状況のイベントを Microsoft に送信する必要があります。

課金ディメンションは、オファーのすべてのプランで共有されます。  一部の属性はすべてのプランのディメンションに適用され、その他の属性はプランに固有です。

ディメンション自体を定義する属性は、オファーのすべてのプランで共有されます。  オファーを公開する前に、あらゆるプランのコンテキストからこれらの属性に加えられた変更は、すべてのプランのディメンション定義に影響を与えます。  プランを公開すると、これらの属性は編集できなくなります。  これらの属性には、以下のようなものがあります。

- id
- 表示名
- 計算単位

ディメンションのその他の属性は各プランに固有であり、各プランで異なる値を持つことができます。  これらの値はプランを発行する前に編集でき、このプランのみが影響を受けます。  プランを公開すると、これらの属性は編集できなくなります。  これらの属性には、以下のようなものがあります。

- 単価 (米国ドル)
- 基本として含まれている月間無料使用量  
- 基本として含まれている年間無料使用量

ディメンションには "有効化" と "無限" という 2 つの特殊な概念もあります。

- **有効化** は、このプランがこのディメンションに参加することを示します。  このディメンションに基づいて使用状況イベントを送信しない新しいプランを作成する場合は、このオプションをオフのままにしておくことをお勧めします。  また、プランが最初に公開された後に追加された新しいディメンションは、既に公開されているプランに対して "無効" として表示されます。  無効なディメンションが、お客様から見たプランのディメンションの一覧に表示されるようになります。
- **無限** は無限大記号 "∞" で表され、このプランはこのディメンションに含まれるが、このディメンションに対して使用量を生成しないことを意味します。  これはお客様に、このディメンションによって表される機能がプランに含まれているが、使用量に制限がないことを示す場合に使用します。  使用量が無限のディメンションは、お客様に表示されるプランのディメンションの一覧に表示され、このプランに対して料金が発生しないことが表示されます。

>[!Note]
>次のシナリオが明示的にサポートされています。 <br> - 新しいディメンションを新しいプランに追加できます。  新しいディメンションは、既に公開されているすべてのプランに対して有効になりません。 <br> - ディメンションを指定せずに **定額** プランを公開し、新しいプランを追加して、そのプランの新しいディメンションを構成することができます。 新しいディメンションは、既に公開されているプランに対して有効になりません。

### <a name="setting-dimension-price-per-unit-per-supported-market"></a>サポートされている市場ごとにディメンションの単価を設定する

定額料金と同様に、課金ディメンションの価格は、サポートされている国または地域ごとに設定できます。 次のように、パートナー センターで価格データのインポートおよびエクスポート機能を使用する必要があります。

1. 必要なディメンションを定義し、サポートされている市場をマークします。 
1. このデータをファイルにエクスポートします。
1. 国または地域ごとに適切な価格を追加し、パートナー センターでファイルをインポートします。

ディメンションの価格がファイルにのみ表示されることを反映して、測定のユーザー インターフェイスが変化します。

[![コマーシャル マーケットプレースの測定サービス ディメンション](media/metering-service-dimensions.png "クリックして拡大表示")](media/metering-service-dimensions.png)

### <a name="private-plan"></a>プライベート プラン

定額プランと同様に、ディメンションを含むプランをプライベート プランとして設定して、プランの定義済み対象者だけがアクセスできるようにすることができます。

## <a name="constraints"></a>制約

### <a name="trial-behavior"></a>無料試用版の動作

コマーシャル マーケットプレースの測定サービスを使用した従量制課金と無料試用版の提供を同時に使用することはできません。  従量制課金と無料試用版の両方を使用するようにプランを構成することはできません。

### <a name="locking-behavior"></a>ロック動作

コマーシャル マーケットプレースの測定サービスで使用されるディメンションは、サービスに対するお客様の支払い方法として合意されている内容を表しているため、ディメンションを公開すると、その詳細はすべて編集できなくなります。  公開する前に、プランに対してディメンションを完全に定義しておくことが重要です。

オファーがディメンションと共に公開されると、そのディメンションについての以下のようなオファーレベルの詳細は変更できなくなります。

- id
- 表示名
- 計算単位

プランが公開されると、以下のようなプラン レベルの詳細を変更できなくなります。

- 単価 (米国ドル)
- 基本として含まれている月間無料使用量
- 基本として含まれている年間無料使用量
- プランでディメンションが有効になっているかどうか

### <a name="upper-limits"></a>上限

1 つのプランに対して構成できる一意のディメンションの最大数は 30 個です。

## <a name="get-support"></a>サポートを受ける

次のいずれかの問題が発生した場合は、サポート チケットを開くことができます。

- Marketplace の測定サービス API に関する技術的な問題。
- お客様の側でのエラーまたはバグが原因でエスカレートする必要がある問題 (例: 間違った使用状況イベント)。
- 従量制課金に関連するその他の問題。

公開元のサポート オプションを理解して、Microsoft のサポート チケットを開くには、「[パートナー センターでのコマーシャル マーケットプレース プログラムのサポート](../support.md)」の手順に従います。

## <a name="next-steps"></a>次のステップ

- [マーケットプレースの従量制課金 API](../marketplace-metering-service-apis.md)
