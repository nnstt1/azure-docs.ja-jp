---
title: Azure Migrate での Azure VM の評価
description: Azure Migrate での評価について説明します
author: rashi-ms
ms.author: rajosh
ms.manager: abhemraj
ms.topic: conceptual
ms.date: 07/28/2021
ms.openlocfilehash: f3fc574e8e381f8e5c911a340ae958ee0939db8f
ms.sourcegitcommit: 37cc33d25f2daea40b6158a8a56b08641bca0a43
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/15/2021
ms.locfileid: "130073850"
---
# <a name="assessment-overview-migrate-to-azure-vms"></a>評価の概要 (Azure VM への移行)

この記事では、[Azure Migrate: 検出および評価](migrate-services-overview.md#azure-migrate-discovery-and-assessment-tool)ツールでの評価の概要について説明します。 このツールでは、Azure への移行について、VMware 仮想マシン、Hyper-V 環境、物理サーバーにおけるオンプレミスのサーバーを評価できます。

## <a name="whats-an-assessment"></a>評価とは

検出および評価ツールを使用した評価では、オンプレミスのサーバーについて、Azure への移行の対応性が測定され、その影響が見積もられます。

> [!NOTE]
> Azure Government では、[評価対象としてサポートされている場所](migrate-support-matrix.md#supported-geographies-azure-government)を確認してください。 VM の推奨サイズでは、Government クラウド リージョン専用の VM シリーズが使用されることに注意してください。 VM の種類の詳細については、[こちら](https://azure.microsoft.com/global-infrastructure/services/?regions=usgov-non-regional,us-dod-central,us-dod-east,usgov-arizona,usgov-iowa,usgov-texas,usgov-virginia&products=virtual-machines)を参照してください。

## <a name="types-of-assessments"></a>評価の種類

Azure Migrate: 検出および評価を使用して作成できる評価には、次の 3 種類があります。

***評価の種類** | **詳細**
--- | ---
**Azure VM** | オンプレミスのサーバーを Azure 仮想マシンに移行するための評価。 この評価の種類を使用すると、[VMware](how-to-set-up-appliance-vmware.md) と [Hyper-V](how-to-set-up-appliance-hyper-v.md) の環境にあるオンプレミスのサーバー、および[物理サーバー](how-to-set-up-appliance-physical.md)を Azure VM に移行するために評価できます。
**Azure SQL** | オンプレミスの SQL サーバーを VMware 環境から Azure SQL Database または Azure SQL Managed Instance に移行するための評価。
**Azure App Service** | オンプレミスの Web アプリを VMware 環境から Azure App Service に移行するための評価。
**Azure VMware Solution (AVS)** | オンプレミスのサーバーを [Azure VMware Solution (AVS)](../azure-vmware/introduction.md) に移行するための評価。 このタイプの評価を使用すると、Azure VMware Solution (AVS) への移行について、オンプレミスの [VMware VM](how-to-set-up-appliance-vmware.md) を評価できます。 [詳細情報](concepts-azure-vmware-solution-assessment-calculation.md)

> [!NOTE]
> 検出と評価ツールで Azure VM または AVS 評価の数が正しくない場合は、評価の合計数をクリックしてすべての評価に移動し、Azure VM または AVS の評価を計算し直します。 その後、検出と評価ツールには、その評価の種類の正しい数が表示されます。 

Azure Migrate を使用して作成した評価は、特定の時点におけるデータのスナップショットです。 Azure VM 評価には、サイズ変更の設定基準として、次の 2 つのオプションが用意されています。

**評価の種類** | **詳細** | **データ**
--- | --- | ---
**パフォーマンスベース** | 収集されたパフォーマンス データに基づいて推奨を行う評価 | VM の推奨サイズは、CPU と RAM の使用率データに基づきます。<br/><br/> ディスクの種類に関する推奨事項は、オンプレミスのディスクの 1 秒あたりの入出力操作数 (IOPS) とスループットに基づきます。 ディスクの種類は、Azure Standard HDD、Azure Standard SSD、Azure Premium ディスク、Azure Ultra Disk です。
**現状のオンプレミス** | パフォーマンス データを使用せずに推奨を行う評価 | VM の推奨サイズは、オンプレミス サーバーのサイズに基づきます。<br/><br> 推奨されるディスクの種類は、評価用に選択されたストレージの種類に基づきます。

## <a name="how-do-i-run-an-assessment"></a>評価を実行する方法

評価を実行するには、いくつかの方法があります。

- 軽量な Azure Migrate アプライアンスによって収集されたサーバー メタデータを使用してサーバーを評価する。 アプライアンスにより、オンプレミスのサーバーが検出されます。 この後、サーバーのメタデータとパフォーマンス データが Azure Migrate に継続的に送信されます。
- コンマ区切り値 (CSV) 形式でインポートされたサーバー メタデータを使用してサーバーを評価する。

## <a name="how-do-i-assess-with-the-appliance"></a>アプライアンスで評価する方法

オンプレミスのサーバーを検出するために Azure Migrate アプライアンスをデプロイする場合は、次の手順を行います。

1. Azure Migrate と連携するように Azure およびオンプレミス環境を設定します。
1. 最初の評価では、Azure プロジェクトを作成し、それに検出および評価ツールを追加します。
1. 軽量の Azure Migrate アプライアンスをデプロイします。 アプライアンスでオンプレミス サーバーが継続的に検出され、サーバーのメタデータとパフォーマンス データが Azure Migrate に送信されます。 アプライアンスは VM または物理サーバーとしてデプロイします。 評価対象のサーバーには何もインストールする必要はありません。

アプライアンスでサーバーの検出が開始されたら、評価するサーバーをグループにまとめ、評価の種類として **Azure VM** を使用してそのグループに対する評価を実行できます。

[VMware](./tutorial-discover-vmware.md)、[Hyper-V](./tutorial-discover-hyper-v.md)、または[物理サーバー](./tutorial-discover-physical.md)向けのチュートリアルに従って、これらの手順を試すことができます。

## <a name="how-do-i-assess-with-imported-data"></a>インポートされたデータを使用して評価する方法

CSV ファイルを使用してサーバーを評価する場合、アプライアンスは不要です。 代わりに、次の手順を行います。

1. Azure Migrate と連携するように Azure を設定します。
1. 最初の評価では、Azure プロジェクトを作成し、それに検出および評価ツールを追加します。
1. CSV テンプレートをダウンロードし、それにサーバー データを追加します。
1. テンプレートを Azure Migrate にインポートします。
1. インポートによって追加されたサーバーを検出し、それらをグループにまとめて、評価の種類 **Azure VM** でグループに対して評価を実行します。

## <a name="what-data-does-the-appliance-collect"></a>アプライアンスはどのようなデータを収集しますか。

評価に Azure Migrate アプライアンスを使用する場合は、[VMware](migrate-appliance.md#collected-data---vmware) および [Hyper-V](migrate-appliance.md#collected-data---hyper-v) の場合に収集されるメタデータとパフォーマンス データについて理解します。

## <a name="how-does-the-appliance-calculate-performance-data"></a>アプライアンスでのパフォーマンス データの計算方法

アプライアンスを検出に使用すると、コンピューティング設定のパフォーマンス データは、次の手順で収集されます。

1. アプライアンスで、リアルタイムのサンプル ポイントが収集されます。

    - **VMware VM**:サンプル ポイントは、20 秒ごとに収集されます。
    - **Hyper-V VM**:サンプル ポイントは、30 秒ごとに収集されます。
    - **物理サーバー**:サンプル ポイントは、5 分ごとに収集されます。

1. アプライアンスにより、VMware および Hyper-V サーバーでは 10 分ごとに、物理サーバーでは 5 分ごとに、サンプル ポイントをまとめた 1 つのデータ ポイントが作成されます。 データ ポイントを作成するために、アプライアンスではすべてのサンプルからピーク値が選択されます。 その後、そのデータ ポイントが Azure に送信されます。
1. 評価では、過去 1 か月間のすべての 10 分のデータ ポイントが格納されます。
1. 評価を作成すると、その評価により、サイズ設定に使用するために適したデータ ポイントが特定されます。 この特定は、"*パフォーマンス履歴*" の百分位の値と "*百分位の使用率*" に基づきます。

    - たとえば、パフォーマンス履歴が 1 週間で、百分位の使用率が 95 パーセンタイルの場合、評価によって前週の 10 分間のサンプル ポイントが並べ替えられます。 並べ替えは昇順で行われ、サイズ設定の値として 95 パーセンタイルが選択されます。
    - 値 95 パーセンタイルを設定すると、99 パーセンタイルを選択した場合に含まれる可能性のある外れ値はすべて無視されます。
    - 期間中のピーク使用率を選択し、外れ値を見落とさないようにする場合は、パーセンタイル使用率として 99 パーセンタイルを選択します。

1. アプライアンスで収集される次のメトリックの有効なパフォーマンス使用率データを得るために、この値には快適性係数が乗算されます。

    - CPU 使用率
    - RAM 使用率
    - ディスク IOPS (読み取りと書き込み)
    - ディスク スループット (読み取りと書き込み)
    - ネットワーク スループット (入力と出力)

## <a name="how-are-azure-vm-assessments-calculated"></a>Azure VM 評価の計算方法

評価では、オンプレミスのサーバーのメタデータとパフォーマンス データを使用して評価値を計算します。 Azure Migrate アプライアンスをデプロイした場合、評価には、アプライアンスで収集されたデータが使用されます。 しかし、CSV ファイルを使用してインポートされた評価を実行する場合は、計算用のメタデータを指定します。

計算は、次の 3 段階で行われます。

1. **Azure 対応性を計算する**: サーバーが Azure への移行に適しているかどうかを評価します。
1. **サイズ設定に関する推奨事項を計算する**:コンピューティング、ストレージ、ネットワークのサイズ設定を見積もります。
1. **毎月のコストを計算する**: 移行後に Azure でサーバーを実行するためのコンピューティングとストレージの月間推定コストを計算します。

計算は、上記の順序で行われます。 前の段階で合格したサーバーだけが次の段階に進みます。 たとえば、Azure 対応性の段階に合格しなかったサーバーは、Azure に不適合とマークされます。 そのサーバーに対してサイズ設定とコストの計算は行われません。

## <a name="whats-in-an-azure-vm-assessment"></a>Azure VM の評価の内容

Azure VM の評価に含まれる内容は次のとおりです。

**プロパティ** | **詳細**
--- | ---
**ターゲットの場所** | 移行先となる場所。 評価のターゲットの場所として現在サポートされている Azure リージョンは次のとおりです。<br/><br/> オーストラリア東部、オーストラリア南東部、ブラジル南部、カナダ中部、カナダ東部、インド中部、米国中部、中国東部、中国北部、東アジア、米国東部、米国東部 2、ドイツ中部、ドイツ北東部、東日本、西日本、韓国中部、韓国南部、米国中北部、北ヨーロッパ、米国中南部、東南アジア、インド南部、英国南部、英国西部、US Gov アリゾナ、US Gov テキサス、US Gov バージニア、米国中西部、西ヨーロッパ、インド西部、米国西部、米国西部 2。
**ターゲットのストレージ ディスク (現状のサイズ設定)** | Azure のストレージに使用するディスクの種類。 <br/><br/> ターゲットのストレージ ディスクを、Premium マネージド、Standard SSD マネージド、Standard HDD マネージド、または Ultra Disk として指定します。
**ターゲットのストレージ ディスク (パフォーマンスベースのサイズ設定)** | ターゲットのストレージ ディスクの種類を自動、Premium マネージド、Standard HDD マネージド、Standard SSD マネージド、または Ultra Disk として指定します。<br/><br/> **自動**: ディスクに関する推奨事項は、ディスクのパフォーマンス データ (IOPS とスループット) に基づきます。<br/><br/>**Premium、Standard、または Ultra Disk**: この評価では、選択したストレージの種類内のディスク SKU が推奨されます。<br/><br/> 単一インスタンス VM のサービス レベル アグリーメント (SLA) を 99.9% にする場合は、Premium マネージド ディスクの使用を検討してください。 これを使用することにより、評価に含まれるすべてのディスクが Premium マネージド ディスクとして推奨されるようになります。<br/><br/> 高スループット、高 IOPS、一貫して低遅延のディスク ストレージを必要とするデータ集中型のワークロードを実行する場合は、Ultra Disk の使用を検討します。<br/><br/> Azure Migrate の移行評価では、マネージド ディスクのみがサポートされます。
**Azure Reserved VM Instances** | [予約インスタンス](https://azure.microsoft.com/pricing/reserved-vm-instances/)を指定します。これにより、評価でのコスト見積もりで考慮されます。<br/><br/> [予約済みインスタンス] を選択すると、[割引 (%)] および [VM のアップタイム] プロパティは適用されません。<br/><br/> 現在、Azure Migrate では、従量課金制プランについてのみ Azure Reserved VM Instances がサポートされています。
**サイズ変更の設定基準** | Azure VM のサイズ設定に使用されます。<br/><br/> 現状のサイズ設定またはパフォーマンスベースのサイズ設定を使用します。
**パフォーマンス履歴** | パフォーマンスベースのサイズ設定で使用されます。 パフォーマンス履歴では、パフォーマンス データを評価するときに使用する期間を指定します。
**百分位数の使用率** | パフォーマンスベースのサイズ設定で使用されます。 百分位の使用率では、サイズ設定に使用されるパフォーマンス サンプルのパーセンタイル値を指定します。
**VM シリーズ** | サイズ設定を検討する Azure VM シリーズ。 たとえば、Azure 内に A シリーズの VM を必要とする運用環境がない場合、シリーズの一覧から A シリーズを除外することができます。
**快適性係数** | 評価中に使用されるバッファー。 これは、VM の CPU、RAM、ディスク、ネットワーク データに適用されます。 季節ごとの使用量、短期間のパフォーマンス履歴、将来に使用量が増える可能性などの問題に相当します。<br/><br/> たとえば、使用率 20% の 10 コア VM の結果は、通常 2 コア VM になります。 快適性係数を 2.0 とした場合、結果は 4 コア VM になります。
**プラン** | 自分が登録されている [Azure プラン](https://azure.microsoft.com/support/legal/offer-details/)。 評価によって、そのプランのコストが見積もられます。
**通貨** | アカウントの請求通貨。
**割引率 (%)** | Azure プランに適用される任意のサブスクリプション固有の割引。 既定の設定は 0% です。
**VM のアップタイム** | Azure VM が継続して実行されない期間 (1 か月あたりの日数と 1 日あたりの時間数)。 コストの見積もりは、その期間に基づきます。<br/><br/> 既定値は、1 か月あたり 31 日、1 日あたり 24 時間です。
**Azure ハイブリッド特典** | ソフトウェア アシュアランスがあり、かつ [Azure ハイブリッド特典](https://azure.microsoft.com/pricing/hybrid-use-benefit/)を受ける資格があるかどうかを指定します。 既定値の [はい] に設定した場合、Windows VM には、Windows 以外のオペレーティング システムの Azure 価格が考慮されます。
**EA サブスクリプション** | Enterprise Agreement (EA) サブスクリプションをコスト見積もりに使用することを指定します。 このサブスクリプションに適用される割引が考慮されます。 <br/><br/> 予約インスタンスの設定 (割引率 (%) および VM のアップタイムの各プロパティ) は、既定の設定のままにします。


Azure Migrate で評価を作成するための[ベスト プラクティスを確認](best-practices-assessment.md)してください。

## <a name="calculate-readiness"></a>対応性を計算する

すべてのサーバーが Azure での実行に適しているとは限りません。 Azure VM の評価では、オンプレミスのすべてのサーバーを評価し、対応性カテゴリを割り当てます。

- **[Azure に対応]** : サーバーをそのまま変更せずに Azure に移行できます。 Azure で起動し、Azure のフル サポートを受けます。
- **[Azure に条件付きで対応]** : サーバーは Azure で起動する可能性はありますが、Azure サポートの一部を受けられないことがあります。 たとえば、Azure では、古いバージョンの Windows Server を実行しているサーバーはサポートされません。 これらのサーバーを Azure に移行する前に注意する必要があります。 対応性に関する問題を修正するには、評価で提示された修復ガイダンスに従います。
- **[Azure に未対応]** : Azure では、サーバーは起動しません。 たとえば、オンプレミスのサーバーのディスクが 64 TB を超える場合、Azure でこのサーバーをホストすることはできません。 修復ガイダンスに従って、問題を解決してから移行してください。
- **[対応不明]** : メタデータが不十分なため、Azure Migrate はサーバーの対応性を判断できません。

対応性を計算するために、評価では次の表にまとめられているサーバーのプロパティとオペレーティング システムの設定を確認します。

### <a name="server-properties"></a>サーバー プロパティ

Azure VM の評価では、評価によりオンプレミスの VM の次のプロパティが確認され、Azure で実行できるかどうかが判断されます。

プロパティ | 詳細 | Azure 対応性の状態
--- | --- | ---
**ブートの種類** | Azure は、ブートの種類が UEFI ではなく BIOS として VM をサポートします。 | ブートの種類が UEFI の場合は条件付きで対応
**コア** | 各サーバーのコア数は、Azure VM でサポートされる最大コア数の 128 コア以下である必要があります。<br/><br/> パフォーマンス履歴が使用可能な場合、Azure Migrate では、使用されているコアの数が比較で考慮されます。 評価設定で快適性係数が指定されている場合、使用されているコアの数に快適性係数が乗算されます。<br/><br/> パフォーマンス履歴がない場合、Azure Migrate によって割り当てられているコアの数を使用して快適性係数が適用されます。 | コア数が制限内であれば対応
**RAM** | 各サーバーの RAM のサイズは、Azure M シリーズ Standard_M128m&nbsp;<sup>2</sup> VM でサポートされる最大サイズの 3,892 GB 以下である必要があります。 [詳細については、こちらを参照してください](../virtual-machines/sizes.md)。<br/><br/> パフォーマンス履歴が使用可能な場合、Azure Migrate では、使用されている RAM が比較で考慮されます。 快適性係数が指定されている場合、使用されている RAM に快適性係数が乗算されます。<br/><br/> 履歴がない場合、割り当てられている RAM を使用して快適性係数が適用されます。<br/><br/> | RAM の容量が制限内であれば対応
**ストレージ ディスク** | ディスクの割り当てサイズは、64 TB 以下である必要があります。<br/><br/> サーバーに接続されているディスクの数は、OS ディスクを含めて 65 個以下である必要があります。 | ディスクのサイズと数が制限内であれば対応
**ネットワーク** | サーバーに接続されているネットワーク インターフェイス (NIC) の数は 32 個以下である必要があります。 | NIC 数が制限内であれば対応

### <a name="guest-operating-system"></a>ゲスト オペレーティング システム

Azure VM の評価では、VM のプロパティを確認するとともに、評価はサーバーのゲスト オペレーティング システムを調べて Azure で実行できるかどうかを判断します。

> [!NOTE]
> VMware VM のゲスト分析を処理する場合、評価は、vCenter Server で VM に指定されているオペレーティング システムを使用します。 ただし、vCenter Server は、Linux VM オペレーティング システムのカーネル バージョンを提供しません。 バージョンを検出するには、[アプリケーション検出](./how-to-discover-applications.md)を設定する必要があります。 その後、アプライアンスは、アプリ検出の設定時に指定したゲスト資格情報を使用してバージョン情報を検出します。


評価で、オペレーティング システムに基づいて Azure 対応性を判定するには、次のロジックが使用されます。

**オペレーティング システム** | **詳細** | **Azure 対応性の状態**
--- | --- | ---
Windows Server 2016 および全 SP | Azure は完全サポートを提供します。 | Azure に対応。
Windows Server 2012 R2 および全 SP | Azure は完全サポートを提供します。 | Azure に対応。
Windows Server 2012 および全 SP | Azure は完全サポートを提供します。 | Azure に対応。
Windows Server 2008 R2 および全 SP | Azure は完全サポートを提供します。| Azure に対応。
Windows Server 2008 (32 ビットおよび 64 ビット) | Azure は完全サポートを提供します。 | Azure に対応。
Windows Server 2003 および Windows Server 2003 R2 | これらのオペレーティング システムはサポート終了日が過ぎているため、Azure でのサポートには[カスタム サポート契約 (CSA)](/troubleshoot/azure/virtual-machines/server-software-support) が必要です。 | Azure に条件付きで対応。 Azure に移行する前に OS のアップグレードを検討してください。
Windows 2000、Windows 98、Windows 95、Windows NT、Windows 3.1、MS-DOS | これらのオペレーティング システムは、サポート終了日を過ぎています。 サーバーは Azure で起動する場合がありますが、OS は Azure ではサポートされていません。 | Azure に条件付きで対応。 Azure に移行する前に OS をアップグレードすることをお勧めします。
Windows 7、Windows 8、Windows 10 | Azure は、[Visual Studio サブスクリプションにのみ](../virtual-machines/windows/client-images.md)サポートを提供します。 | Azure に条件付きで対応。
Windows 10 Pro | Azure は、[マルチ テナント ホスティング権限](../virtual-machines/windows/windows-desktop-multitenant-hosting-deployment.md)にサポートを提供します。 | Azure に条件付きで対応。
Windows Vista および Windows XP Professional | これらのオペレーティング システムは、サポート終了日を過ぎています。 サーバーは Azure で起動する場合がありますが、OS は Azure ではサポートされていません。 | Azure に条件付きで対応。 Azure に移行する前に OS をアップグレードすることをお勧めします。
Linux | Azure がサポートする [Linux オペレーティング システム](../virtual-machines/linux/endorsed-distros.md)を参照してください。 その他の Linux オペレーティング システムも Azure で起動する可能性があります。 しかし、サポートされているバージョンに OS をアップグレードしてから Azure に移行することをお勧めします。 | Azure に対応 (バージョンがサポートされている場合)。<br/><br/>条件付きで対応 (バージョンがサポートされていない場合)。
Oracle Solaris、Apple macOS、FreeBSD などのその他のオペレーティング システム | Azure では、これらのオペレーティング システムはサポートされません。 サーバーは Azure で起動する場合がありますが、OS は Azure ではサポートされていません。 | Azure に条件付きで対応。 Azure に移行する前に、サポートする OS をインストールすることをお勧めします。  
vCenter Server で **[Other]\(その他\)** と指定された OS | この場合、Azure Migrate は OS を識別できません。 | 対応不明。 VM 内で実行している OS が Azure でサポートされることを確認します。
32 ビット オペレーティング システム | サーバーは Azure で起動できますが、Azure がフル サポートを提供しない可能性があります。 | Azure に条件付きで対応。 Azure に移行する前に 64 ビット OS へのアップグレードを検討してください。

## <a name="calculating-sizing"></a>サイズ設定の計算

サーバーが Azure に対応することが確認されると、評価によって Azure VM の評価で推奨のサイズ設定が作成されます。 これらの推奨事項では、Azure VM とディスク SKU が特定されます。 サイズ設定の計算は、現状のオンプレミスのサイズ設定またはパフォーマンスベースのサイズ設定のどちらを使用するかによって異なります。

### <a name="calculate-sizing-as-is-on-premises"></a>サイズ設定を計算する (現状のオンプレミス)

 現状のオンプレミスのサイズ設定を使用する場合、評価では、Azure VM の評価で VM とディスクのパフォーマンス履歴が考慮されません。

- **[コンピューティングのサイズ設定]** : 評価は、オンプレミスで割り当てられたサイズに基づいて、Azure VM SKU を割り当てます。
- **[ストレージとディスクのサイズ設定]** : 評価は、評価プロパティで指定されたストレージの種類を調べて、それに応じたディスクの種類を推奨します。 推奨される可能性のあるストレージの種類は、Standard HDD、Standard SSD、Premium、Ultra Disk です。 既定のストレージの種類は Premium です。
- **[ネットワークのサイズ設定]** : 評価は、オンプレミスのサーバー上のネットワーク アダプターを考慮します。

### <a name="calculate-sizing-performance-based"></a>サイズを計算する (パフォーマンスベース)

Azure VM の評価でパフォーマンスベースのサイズ設定を使用する場合、評価はサイズ設定の推奨事項を次のように作成します。

- 評価はサーバーのパフォーマンス履歴を考慮して Azure での VM サイズとディスクの種類を特定します。

> [!NOTE] 
> CSV ファイルを利用してサーバーをインポートする場合、指定するパフォーマンス値 (CPU 使用率、メモリ使用率、ディスク IOPS、スループット) はパフォーマンスベースのサイズ設定を選択したときに使用されます。 パフォーマンス履歴とパーセンタイル情報は指定できません。

- この方法は、オンプレミスのサーバーを割り当て過ぎて使用率が低下したときに、Azure VM のサイズを適切に設定してコストを削減する必要がある場合に特に有用です。
- パフォーマンス データを使用しない場合は、前のセクションで説明したように、サイズ設定条件を現状のオンプレミスにリセットします。


#### <a name="calculate-storage-sizing"></a>ストレージのサイズ設定を計算する

Azure VM 評価のストレージのサイズ設定では、Azure Migrate は、サーバーに接続されている各ディスクを Azure ディスクにマップしようとします。 サイズ設定は次のように行われます。

1. 評価では、必要な IOPS の合計を取得するために、ディスクの読み取りと書き込みの IOPS を追加します。 同様に、読み取りと書き込みのスループット値を追加して、各ディスクのスループットの合計を取得します。 インポートベースの評価の場合、インポートされるファイルに、合計 IOPS、合計スループット、合計ディスク数を指定するオプションがあり、個別のディスク設定を指定する必要がありません 。 これを行うと、個々のディスクのサイズ設定はスキップされ、指定されたデータが直接コンピューティングのサイズ設定に使用されて、適切な VM SKU が選択されます。

1. ストレージの種類を自動として指定した場合、選択される種類は、有効な IOPS 値とスループット値に基づきます。 評価では、ディスクを Azure の Standard HDD、Standard SSD、Premium、または Ultra Disk のいずれにマップするかが決定されます。 ストレージの種類がこれらのディスクの種類のいずれかに設定されている場合、評価は、選択されたストレージの種類内でディスク SKU を見つけようとします。
1. ディスクは次のように選択されます。
    - 評価で必要な IOPS とスループットのディスクが見つからなかった場合は、そのサーバーが Azure に不適合とマークされます。
    - 評価は、適合する一連のディスクを見つけると、評価の設定で指定されている場所に対応したディスクを選択します。
    - 対象となるディスクが複数ある場合は、評価は最も低コストのディスクを選択します。
    - どのディスクのパフォーマンス データも使用できない場合、構成用のディスク サイズを使用して Azure で Standard SSD ディスクが検索されます。

##### <a name="ultra-disk-sizing"></a>Ultra Disk のサイズ設定

Ultra Disk の場合、特定のディスク サイズに対して許容される IOPS とスループットの範囲があるため、サイズ設定で使用されるロジックは、Standard および Premium ディスクとは異なります。
1. 次の 3 つの Ultra Disk サイズが計算されます。 
    - 1 つのディスク (ディスク 1) は、ディスク サイズの要件を満たすことができます
    - 1 つのディスク (ディスク 2) は、合計 IOPS の要件を満たすことができます
        - プロビジョニングされる IOPS = (ソース ディスク スループット) * 1024/256
    - 1 つのディスク (ディスク 3) は、合計スループットの要件を満たすことができます
1. 3 つのディスクから、ディスク サイズが最大のものが検出され、次に使用可能な [Ultra Disk オファリング](../virtual-machines/disks-types.md#ultra-disks)に切り上げられます。 これが、プロビジョニングされる Ultra Disk サイズです。
1. プロビジョニングされた IOPS は、次のロジックを使用して計算されます。
    - 検出されたソース スループットが Ultra Disk の許容範囲内である場合、プロビジョニングされる IOPS はソース ディスクの IOPS と等しくなります
    - そうでない場合、プロビジョニングされる IOPS は、"プロビジョニングされる IOPS = (ソース ディスクのスループット) * 1024/256" を使用して計算されます
1. プロビジョニングされるスループットの範囲は、プロビジョニングされる IOPS に依存します


#### <a name="calculate-network-sizing"></a>ネットワークのサイズ設定を計算する

Azure VM の評価では、評価は、オンプレミスのサーバーに接続されたネットワーク アダプターの数と必要なパフォーマンスをサポートする Azure VM を見つけようとします。

- オンプレミス サーバーの有効なネットワーク パフォーマンスを取得するために、評価は、すべてのネットワーク アダプターについてサーバーからのデータ送信速度 (ネットワーク出力) を集計します。 その後、快適性係数を適用します。 算出された数値を使用して、必要なネットワーク パフォーマンスをサポートできる Azure VM を見つけます。
- 評価は、ネットワーク パフォーマンスとともに、Azure VM が必要なネットワーク アダプター数をサポートできるかどうかも考慮します。
- ネットワーク パフォーマンス データが使用できない場合、評価は、VM のサイズ設定でネットワーク アダプター数のみを考慮します。

#### <a name="calculate-compute-sizing"></a>コンピューティングのサイズ設定を計算する

ストレージとネットワークの要件を計算した後、評価は CPU と RAM の要件を考慮して Azure で適切な VM サイズを見つけます。

- Azure Migrate は、有効な使用コア数と RAM を確認して、適切な Azure VM サイズを見つけます。
- 適切なサイズが見つからない場合、そのサーバーは Azure に不適合とマークされます。
- 適切なサイズが見つかった場合は、ストレージとネットワークの計算が適用されます。 その後、場所と価格レベルの設定が適用され、VM サイズに関する最終的な推奨事項が作成されます。
- 条件を満たす Azure VM サイズが複数ある場合、最も低コストのディスクをお勧めします。

## <a name="confidence-ratings-performance-based"></a>信頼度レーティング (パフォーマンスベース)

Azure Migrate でのパフォーマンスベースの Azure VM の各評価には、信頼度が関連付けられます。 信頼度の範囲は、星 1 つ (最も低い) から星 5 つ (最も高い) までです。 評価の信頼度は、Azure Migrate によって提示される推奨サイズの信頼性を評価する目安となります。

- 評価の信頼度は、評価に割り当てられます。 信頼度は、評価の計算に必要なデータ ポイントの可用性に基づいています。
- パフォーマンス ベースのサイズ設定では、評価が以下を必要とします。
    - CPU と RAM の使用率データ。
    - サーバーに接続されているディスクごとの、ディスク IOPS とスループット データ。
    - サーバーに接続したネットワーク アダプターごとの、パフォーマンス ベースのサイズ設定を処理するためのネットワーク I/O。

これらの使用率の数値のいずれかが使用できない場合、推奨サイズは信頼できない可能性があります。

> [!NOTE]
> 評価の信頼度は、インポートされた CSV ファイルを使用して評価されたサーバーには割り当てられません。 また、レーティングは、現状のオンプレミスの評価には適用されません。

### <a name="ratings"></a>Ratings

次の表は、使用可能なデータ ポイントの割合に応じた評価の信頼度を示します。

   **データ ポイントの可用性** | **信頼度レーティング**
   --- | ---
   0-20% | 1 つ星
   21-40% | 2 つ星
   41-60% | 3 つ星
   61-80% | 4 つ星
   81-100% | 5 つ星

### <a name="low-confidence-ratings"></a>信頼度レーティングが低い

次のようないくつかの理由で、評価の信頼度レーティングが低くなることがあります。

- 評価を作成する期間について環境をプロファイルしなかった。 たとえば、パフォーマンス期間を 1 日に設定して評価を作成する場合、すべてのデータ ポイントを収集するために、検出を開始してから少なくとも 1 日待つ必要があります。
- 評価期間内に一部または全部のサーバーのパフォーマンス データを評価で収集できません。 高い信頼度レーティングを得るために、次のことを確認してください。 
    - 評価期間中、サーバーの電源がオンになっている
    - ポート 443 でのアウトバウンド接続が許可されている
    - Hyper-V サーバーで、動的メモリが有効になっている 
    
    評価を "再計算" し、信頼性評価に最新の変更を反映してください。

- 評価の計算対象期間中に作成されたサーバーがある。 たとえば、前月のパフォーマンス履歴で評価を作成する場合に、わずか 1 週間前にその環境で一部のサーバーが作成されていたとします。 この場合、新しいサーバーのパフォーマンス データは期間全体を通しては利用できず、信頼度レーティングが低くなります。

> [!NOTE]
> 評価の信頼度が星 5 つを下回る場合、アプライアンスが環境をプロファイルできるように少なくとも 1 日待ってから、評価を再計算することをお勧めします。 そうしなければ、パフォーマンスベースのサイズ設定は信頼できない可能性があります。 その場合は、評価をオンプレミスのサイズ設定切り替えることをお勧めします。

## <a name="calculate-monthly-costs"></a>毎月のコストを計算する

サイズ設定の推奨が完了すると、Azure Migrate での Azure VM の評価では、移行後のコンピューティングとストレージのコストが計算されます。

### <a name="compute-cost"></a>コンピューティング コスト
Azure Migrate では、推奨される Azure VM サイズと Azure Billing API を使用して、サーバーの月間コストが計算されます。

この計算では、次のものが考慮されます。
- オペレーティング システム
- ソフトウェア アシュアランス
- 予約インスタンス
- VM のアップタイム
- 場所
- 通貨設定

評価は、すべてのサーバーのコストを集計して、月間コンピューティング コストの合計を計算します。

### <a name="storage-cost"></a>Storage コスト
サーバーの月間ストレージ コストは、サーバーに接続されているすべてのディスクの月間コストを集計して計算されます。

#### <a name="standard-and-premium-disk"></a>Standard ディスクと Premium ディスク
Standard または Premium ディスクのコストは、選択された、または推奨されるディスク サイズに基づいて計算されます。 

#### <a name="ultra-disk"></a>Ultra Disk 

Ultra Disk のコストは、プロビジョニングされたサイズ、プロビジョニングされた IOPS、およびプロビジョニングされたスループットに基づいて計算されます。 [詳細情報](https://azure.microsoft.com/pricing/details/managed-disks/)

コストは、次のロジックを使用して計算されます。 
- ディスク サイズのコストは、プロビジョニングされたディスク サイズにディスク容量の時間料金を乗算することで計算されます
- プロビジョニングされた IOPS のコストは、プロビジョニングされた IOPS に 1 時間当たりのプロビジョニング済み IOPS の価格を乗算することで計算されます
- プロビジョニングされたスループットのコストは、プロビジョニングされたスループットに 1 時間当たりのプロビジョニング済みスループットの価格を乗算することで計算されます
- Ultra Disk VM の予約料金は、合計コストでは追加されません。 [詳細情報](https://azure.microsoft.com/pricing/details/managed-disks/)

評価は、すべてのサーバーのストレージ コストを集計して、月間ストレージ コストの合計を計算します。 現在、この計算では、アセスメント設定で指定されたプランは考慮されません。

コストは、アセスメント設定で指定された通貨で表示されます。

## <a name="next-steps"></a>次のステップ

評価作成のベストプラクティスを[確認](best-practices-assessment.md)します。 

- [VMware](./tutorial-discover-vmware.md) と [Hyper-V](./tutorial-discover-hyper-v.md) 環境、および[物理サーバー](./tutorial-discover-physical.md)で実行されているサーバーの評価を実行する方法について説明します。
- [CSV ファイルでインポート](./tutorial-discover-import.md)されたサーバーを評価する方法について説明します。
- [依存関係の視覚化](concepts-dependency-visualization.md)について説明します。