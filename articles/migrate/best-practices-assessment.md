---
title: Azure Migrate Discovery and Assessment ツール
description: Azure Migrate Discovery and Assessment ツールを使用した評価の作成に関するヒント。
author: rashi-ms
ms.author: rajosh
ms.manager: abhemraj
ms.topic: conceptual
ms.date: 07/28/2021
ms.openlocfilehash: cf8f4adabf07ec349c2b5890d0f3a6cfd6bbb192
ms.sourcegitcommit: 0046757af1da267fc2f0e88617c633524883795f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/13/2021
ms.locfileid: "121732661"
---
# <a name="best-practices-for-creating-assessments"></a>評価を作成するためのベスト プラクティス

[Azure Migrate](./migrate-services-overview.md) では、アプリ、インフラストラクチャ、およびワークロードを検出、評価、および Microsoft Azure に移行するために役立つツールのハブが提供されます。 このハブには、Azure Migrate ツールと、サードパーティ製の独立系ソフトウェア ベンダー (ISV) オファリングが含まれています。

この記事では、Azure Migrate Discovery and Assessment ツールを使用して評価を作成する際のベスト プラクティスについて説明します。

Azure Migrate: Discovery and Assessment ツールを使用して作成した評価は、特定の時点におけるデータのスナップショットです。 Azure Migrate: Discovery and Assessment を使用して作成できる評価には、次の 4 種類があります。

**評価の種類** | **詳細**
--- | ---
**Azure VM** | オンプレミスのサーバーを Azure 仮想マシンに移行するための評価。 <br/><br/> この評価の種類を使用すると、[VMware](how-to-set-up-appliance-vmware.md) と [Hyper-V](how-to-set-up-appliance-hyper-v.md) の環境にあるオンプレミスのサーバー、および[物理サーバー](how-to-set-up-appliance-physical.md)を Azure に移行するために評価できます。 [詳細情報](concepts-assessment-calculation.md)
**Azure SQL** | オンプレミスの SQL サーバーを VMware 環境から Azure SQL Database または Azure SQL Managed Instance に移行するための評価。 [詳細情報](concepts-azure-sql-assessment-calculation.md)
**Azure App Service** | IIS Web サーバー上で実行されているオンプレミスの ASP.NET Web アプリを、VMware 環境から Azure App Service に移行するための評価。 [詳細情報](concepts-azure-webapps-assessment-calculation.md)
**Azure VMware Solution (AVS)** | オンプレミスのサーバーを [Azure VMware Solution (AVS)](../azure-vmware/introduction.md) に移行するための評価。 <br/><br/> このタイプの評価を使用すると、Azure VMware Solution (AVS) への移行について、オンプレミスの [VMware VM](how-to-set-up-appliance-vmware.md) を評価できます。 [詳細情報](concepts-azure-vmware-solution-assessment-calculation.md)

> [!NOTE]
> 検出と評価ツールで Azure VM または AVS 評価の数が正しくない場合は、評価の合計数をクリックしてすべての評価に移動し、Azure VM または AVS の評価を計算し直します。 その後、検出と評価ツールには、その評価の種類の正しい数が表示されます。 

### <a name="sizing-criteria"></a>サイズ変更の設定基準
Azure Migrate の評価におけるサイズ変更の設定基準のオプションは、次のとおりです。

**サイズ変更の設定基準** | **詳細** | **データ**
--- | --- | ---
**パフォーマンスベース** | 収集されたパフォーマンス データに基づいて推奨を行う評価 | **Azure VM の評価**: VM サイズの推奨値は、CPU とメモリの使用率データに基づきます。<br/><br/> ディスクの種類に関する推奨事項 (標準 HDD/SSD、プレミアム マネージド ディスクまたは Ultra ディスク) は、オンプレミス ディスクの IOPS とスループットに基づきます。<br/><br/>**Azure SQL の評価**: Azure SQL 構成は、CPU 使用率、メモリ使用率、IOPS (データおよびログ ファイル)、スループット、IO 操作の待機時間など、SQL インスタンスとデータベースのパフォーマンス データに基づきます<br/><br/>**Azure VMware Solution (AVS) の評価**: AVS ノードに関する推奨事項は、CPU とメモリの使用率データに基づきます。
**現状のオンプレミス** | パフォーマンス データを使用せずに推奨を行う評価。 | **Azure VM の評価**: VM サイズに関する推奨事項は、オンプレミスの VM サイズに基づきます<br/><br> 推奨されるディスクの種類は、評価の [ストレージの種類] 設定で選択した内容に基づきます。<br/><br/> **Azure App Service の評価**: 評価の推奨事項は、オンプレミスの Web アプリ構成データに基づきます。<br/><br/> **Azure VMware Solution (AVS) の評価**: AVS ノードに関する推奨事項は、オンプレミスの VM サイズに基づきます。

#### <a name="example"></a>例
たとえば、オンプレミスの VM で 4 コア CPU の使用率が 20%、8 GB メモリの使用率が 10% の場合、Azure VM の評価は次のようになります。

- **パフォーマンスベースの評価**:
    - コア (4 x 0.20 = 0.8) とメモリ (8 GB x 0.10 = 0.8) の使用率に基づいて、有効なコアとメモリを識別します。
    - 評価のプロパティで指定された快適性係数 (たとえば 1.3 x) を適用して、サイズ変更に使用する値を取得します。 
    - 最大 1.04 コア (0.8 x 1.3) の CPU と最大 1.04 GB (0.8 x 1.3) のメモリをサポートできる、直近の VM サイズが推奨されます。

- **現状 (オンプレミス) での評価**:
    -  4 コア、8 GB メモリの VM を推奨します。


## <a name="best-practices-for-creating-assessments"></a>評価を作成するためのベスト プラクティス

Azure Migrate アプライアンスは、オンプレミス環境のプロファイリングを継続的に行い、メタデータとパフォーマンスデータを Azure に送信します。 アプライアンスを使用して検出されたサーバーの評価については、次のベスト プラクティスに従ってください。

- **現状評価の作成**:現状評価は、Azure Migrate ポータルにサーバーが表示されたらすぐに作成できます。 サイズ変更の設定基準として "オンプレミス" を使用して、Azure SQL の評価を作成することはできません。 Azure App Service の評価は、既定では "オンプレミス" です。
- **パフォーマンスベース評価の作成**:パフォーマンスベースの評価は、検出を設定した後、少なくとも 1 日待機してから実行することをお勧めします。
    - パフォーマンス データの収集には時間がかかります。 少なくとも 1 日待機することで、評価を実行する前に十分なパフォーマンス データ ポイントを確保できます。
    - パフォーマンスベースの評価を実行する場合は、評価期間に合わせて環境をプロファイリングするようにしてください。 たとえば、パフォーマンス期間を 1 週間に設定して評価を作成する場合は、すべてのデータ ポイントを収集するために、検出を開始してから少なくとも 1 週間待つ必要があります。 そうしないと、5 つ星の評価は得られません。
- **評価の再計算**:評価は特定の時点のスナップショットであるため、最新のデータで自動的に更新されることはありません。 最新のデータを使用して評価を更新するには、評価を再計算する必要があります。

CSV ファイル経由で Azure Migrate にインポートされたサーバーの評価については、次のベスト プラクティスに従ってください。

- **現状評価の作成**:現状評価は、Azure Migrate ポータルにサーバーが表示されたらすぐに作成できます。
- **パフォーマンスベース評価の作成**:これにより、特にオンプレミスのサーバー容量が過剰にプロビジョニングされている場合に、コストをより正確に見積もることができます。 ただし、パフォーマンスに基づく評価の精度は、サーバーに対して指定されたパフォーマンス データによって決まります。 
- **評価の再計算**:評価は特定の時点のスナップショットであるため、最新のデータで自動的に更新されることはありません。 最後にインポートされたデータを使用して評価を更新するには、それを再計算する必要があります。
 
### <a name="ftt-sizing-parameters-for-avs-assessments"></a>AVS 評価に対する FTT サイズ設定パラメーター

AVS で使用されるストレージ エンジンは vSAN です。 vSAN ストレージ ポリシーには、仮想マシンのストレージ要件が定義されています。 これらのポリシーによって、ストレージを VM に割り当てる方法が決まるため、VM に必要なサービス レベルを確保できます。 使用できる FTT-Raid の組み合わせを次に示します。 

**許容エラー (FTT)** | **RAID 構成** | **最小ホスト要件** | **サイズ設定の考慮事項**
--- | --- | --- | ---
1 | RAID-1 (ミラーリング) | 3 | 100 GB の VM に 200 GB が使用されます。
1 | RAID-5 (イレイジャー コーディング) | 4 | 100 GB の VM に 133.33 GB が使用されます
2 | RAID-1 (ミラーリング) | 5 | 100 GB の VM に 300 GB が使用されます。
2 | RAID-6 (イレイジャー コーディング) | 6 | 100 GB の VM に 150 GB が使用されます。
3 | RAID-1 (ミラーリング) | 7 | 100 GB の VM に 400 GB が使用されます。

## <a name="best-practices-for-confidence-ratings"></a>信頼度レーティングのベスト プラクティス

パフォーマンスベースの評価を実行すると、評価に 1 つ星 (最低) から 5 つ星 (最高) までの信頼度レーティングが割り当てられます。 信頼度レーティングを効果的に使用するには、次の条件を満たす必要があります。

- Azure VM と AVS の評価には以下が必要です。
    - 各サーバーの CPU とメモリの使用率データ
    - オンプレミス サーバーに接続されている各ディスクの読み取り/書き込みの IOPS/スループット データ
    - サーバーに接続されている各ネットワーク アダプターのネットワークの入出力データ。
     
- Azure SQL の評価には、評価する SQL インスタンスとデータベースのパフォーマンス データが必要です。これには以下が含まれます。
    - CPU とメモリの使用率データ
    - データとログのファイルの、読み取り/書き込みの IOPS/スループット データ
    - IO 操作の待機時間

評価の信頼度レーティングは、選択された期間に使用可能なデータ ポイントの割合に応じて、次の表のように判定されます。

   **データ ポイントの可用性** | **信頼度レーティング**
   --- | ---
   0% - 20% | 1 つ星
   21% - 40% | 2 つ星
   41% - 60% | 3 つ星
   61% - 80% | 4 つ星
   81% - 100% | 5 つ星

## <a name="common-assessment-issues"></a>評価に関する一般的な問題

ここでは、評価に影響を与える一般的な環境の問題に対処する方法について説明します。

###  <a name="out-of-sync-assessments"></a>評価が同期されていない

評価を作成した後にグループのサーバーを追加または削除した場合、作成した評価は **同期されていない** ものとしてマークされます。グループの変更を反映するには、評価を再度実行 (**再計算**) してください。

### <a name="outdated-assessments"></a>評価が古い

#### <a name="azure-vm-assessment-and-avs-assessment"></a>Azure VM の評価と AVS の評価

評価されたグループ内のオンプレミス サーバーに変更があった場合、その評価は **古い** 評価としてマークされます。 次のプロパティに 1 つ以上の変更があるため、評価は "古い" としてマークされている可能性があります。

- プロセッサ コアの数
- 割り当て済みメモリ
- ブートの種類またはファームウェア
- オペレーティング システムの名前、バージョン、アーキテクチャ
- ディスクの数
- ネットワーク アダプターの数
- ディスク サイズの変更 (割り当てられた GB)
- NIC プロパティの更新。 例:MAC アドレスの変更、IP アドレスの追加など。

変更を反映するには、評価を再度実行します ( **[再計算]** )。

#### <a name="azure-sql-assessment"></a>Azure SQL の評価

評価されたグループに含まれるオンプレミスの SQL インスタンスおよびデータベースに変更があった場合、その評価は **期限切れ** とマークされます。 下に示す 1 つ以上の理由により、評価は "古い" としてマークされる場合があります。

- SQL インスタンスがサーバーに追加された、またはサーバーから削除された
- SQL データベースが SQL インスタンスに追加された、または削除された
- SQL インスタンスのデータベースの合計サイズが、20% より大きく変化した
- プロセッサ コアの数が変更された
- 割り当てられたメモリが変更された
  
    変更を反映するには、評価を再度実行します ( **[再計算]** )。

#### <a name="azure-app-service-assessment"></a>Azure App Service の評価

評価されたグループ内のオンプレミス Web アプリに変更があった場合、その評価は **古い** 評価としてマークされます。 下に示す 1 つ以上の理由により、評価は "古い" としてマークされる場合があります。

- Web アプリがサーバーに追加された、またはサーバーから削除された
- 既存の Web アプリに対して構成の変更が行われた。
  
    変更を反映するには、評価を再度実行します ( **[再計算]** )。

### <a name="low-confidence-rating"></a>信頼度レーティングが低い

さまざまな理由により、評価で一部のデータ ポイントを使用できない場合があります。

- 評価を作成するための期間用の環境をプロファイルしませんでした。 たとえば、パフォーマンス期間を 1 週間に設定した評価を作成する場合は、すべてのデータポイントが収集されるまで、検出を始めてから少なくとも 1 週間待つ必要があります。 その期間待つことができない場合は、パフォーマンス期間を短くし、評価を "再計算" してください。
 
- 評価期間内に一部または全部のサーバーのパフォーマンス データを評価で収集できません。 高い信頼度レーティングを得るために、次のことを確認してください。 
    - 評価期間中、サーバーの電源がオンになっている
    - ポート 443 でのアウトバウンド接続が許可されている
    - Hyper-V サーバーで、動的メモリが有効になっている 
    - Azure Migrate のエージェントの接続状態が "接続済み" である、また、最後のハートビートも確認します
    - Azure SQL 評価において、検出された SQL インスタンス ブレードで、すべての SQL インスタンスの Azure Migrate の接続状態が "接続済み" である

    評価を "再計算" し、信頼性評価に最新の変更を反映してください。

- Azure VM および AVS の評価では、検出の開始後に作成されたサーバーはほとんどありませんでした。 たとえば、過去 1 か月間のパフォーマンス履歴の評価を作成しているのに、ほんの 1 週間前にいくつかのサーバーが環境内に作成されたとします。 この場合、新しいサーバーのパフォーマンス データは期間全体を通しては利用できず、信頼度レーティングが低くなります。

- Azure SQL の評価の場合、検出が開始された後で、いくつかの SQL インスタンスまたはデータベースが作成されました。 たとえば、過去 1 か月間のパフォーマンス履歴の評価を作成しているのに、ほんの 1 週間前にいくつかの SQL インスタンスまたはデータベースが環境内に作成されたとします。 この場合、新しいサーバーのパフォーマンス データは期間全体を通しては利用できず、信頼度レーティングが低くなります。

### <a name="migration-tool-guidance-for-avs-assessments"></a>AVS 評価に関する移行ツールのガイダンス

Azure VMware Solution (AVS) 評価の Azure 対応性レポートでは、次の推奨ツールを確認できます。 
- **VMware HCX または Enterprise**: VMware サーバーの場合、オンプレミスのワークロードを Azure VMware Solution (AVS) プライベート クラウドに移行するために推奨される移行ツールは、VMware Hybrid Cloud Extension (HCX) ソリューションです。 [詳細については、こちらを参照してください](../azure-vmware/install-vmware-hcx.md)。
- **不明**: CSV ファイルを介してインポートされたサーバーの場合、既定の移行ツールは不明です。 ただし VMware 環境内のサーバーの場合は、VMware Hybrid Cloud Extension (HCX) ソリューションを使用することをお勧めします。


## <a name="next-steps"></a>次のステップ

- 評価の計算方法を[確認](concepts-assessment-calculation.md)します。
- 評価のカスタマイズ方法を[確認](how-to-modify-assessment.md)します。
