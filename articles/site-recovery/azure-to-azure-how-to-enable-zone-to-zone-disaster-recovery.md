---
title: Azure 仮想マシンのゾーン間ディザスター リカバリーを有効にする
description: この記事では、Azure 仮想マシンのゾーン間ディザスター リカバリーを使用するタイミングとその方法について説明します。
author: sideeksh
manager: gaggupta
ms.service: site-recovery
ms.topic: article
ms.date: 04/28/2020
ms.author: sideeksh
ms.openlocfilehash: 263548b8f19c7cad8a27ec605bf9191478a65408
ms.sourcegitcommit: 1a0fe16ad7befc51c6a8dc5ea1fe9987f33611a1
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/05/2021
ms.locfileid: "131867211"
---
# <a name="enable-azure-vm-disaster-recovery-between-availability-zones"></a>可用性ゾーン間で Azure VM のディザスター リカバリーを有効にする

この記事では、同じ Azure リージョン内の可用性ゾーン間で Azure 仮想マシンをレプリケート、フェールオーバー、およびフェールバックする方法について説明します。

>[!NOTE]
>
>- ゾーン間ディザスター リカバリーのサポートは、現在、東南アジア、東アジア、東日本、韓国中部、オーストラリア東部、インド中部、英国南部、西ヨーロッパ、北ヨーロッパ、ノルウェー東部、フランス中部、スウェーデン中部 (マネージド アクセス)、カナダ中部、米国中部、米国中南部、米国東部、米国東部 2、米国西部 2、ブラジル南部、米国西部 3 の各リージョンに制限されています。  
>- Site Recovery では、ゾーン間ディザスター リカバリーが使用されている場合、顧客データがデプロイされているリージョンからそのデータが移動または保存されることはありません。 お客様は、別のリージョンから Recovery Services コンテナーを選択することもできます。 Recovery Services コンテナーにはメタデータが含まれますが、実際の顧客データは含まれません。

Site Recovery サービスは、計画された停止や計画外の停止の際にビジネス アプリの稼働状態を維持することで、事業継続とディザスター リカバリー戦略に貢献します。 リージョン障害が発生した場合にアプリケーションの稼働状態を維持するために、ディザスター リカバリー オプションとして推奨されています。

Availability Zones は、Azure リージョン内の一意の物理的な場所です。 各ゾーンには、1 つまたは複数のデータセンターがあります。 

VM を別のリージョン内の可用性ゾーンに移動する場合は、[この記事をレビュー](../resource-mover/move-region-availability-zone.md)してください。

## <a name="using-availability-zones-for-disaster-recovery"></a>ディザスター リカバリーへの可用性ゾーン の使用 

通常、可用性ゾーンは VM を高可用性構成でデプロイするために使用されます。 可用性ゾーンは、ゾーン間の間隔が狭すぎて、自然災害が発生した場合にディザスター リカバリー ソリューションとしての役割を果たせないことがあります。

ただし、一部のシナリオでは、ディザスター リカバリーに可用性ゾーンを活用できます。

- オンプレミスでアプリケーションをホストしているときに metro ディザスター リカバリー戦略を採用した多くの顧客は、アプリケーションを Azure に移行した後で、この戦略を模倣しようとすることがあります。 こうした顧客は、大規模な物理的災害が発生した場合に metro ディザスター リカバリー戦略が機能しない可能性があるという事実を認め、このリスクを受け入れます。 このような顧客であれば、ディザスター リカバリー オプションとしてゾーン間ディザスター リカバリーを使用できます。

- 他の多くの顧客は、複雑なネットワーク インフラストラクチャを備えており、関連コストと複雑さのせいで、セカンダリ リージョンにそれを再作成することを望みません。 ゾーン間ディザスター リカバリーでは、可用性ゾーン全体に冗長ネットワークの概念を活用して構成をより一層簡単なものにするため、複雑さが軽減されます。 このような顧客はシンプルさを好むため、ディザスター リカバリーに可用性ゾーンを使用することもできます。

- 同じ法務管轄内でペアになっているリージョンを持たない一部のリージョン (東南アジアなど) では、アプリケーションとデータが国境を越えて移動しないため、ゾーン間ディザスター リカバリーは法的なコンプライアンスの確保に役立つので、事実上ディザスター リカバリー ソリューションとしての役割を果たすことができます。 

- ゾーン間ディザスター リカバリーは、Azure 間のディザスター リカバリーに比べて、より短い距離間でのデータのレプリケーションを意味するため、待機時間が短縮され、結果として RPO が低くなるように見えることがあります。

これらは強力な利点ですが、リージョン全体の自然災害が発生した場合、ゾーン間ディザスター リカバリーは回復力の要件を満たさない可能性があります。

## <a name="networking-for-zone-to-zone-disaster-recovery"></a>ゾーン間ディザスター リカバリーのネットワーク

前述のように、ゾーン間ディザスター リカバリーでは、可用性ゾーン全体に冗長ネットワークの概念を活用して構成をより一層簡単なものにするため、複雑さが軽減されます。 ゾーン間ディザスター リカバリー シナリオにおけるネットワーク コンポーネントの動作を次に示します。 

- 仮想ネットワーク:実際のフェールオーバーでは、ソース ネットワークと同じ仮想ネットワークを使用できます。 テスト フェールオーバーでは、ソース仮想ネットワークに別の仮想ネットワークを使用します。

- サブネット:同じサブネットへのフェールオーバーがサポートされています。

- プライベート IP アドレス:静的 IP アドレスを使用している場合は、ターゲット ゾーンで同じ IP アドレスを使用できます (そのように構成した場合)。

- 高速ネットワーク:Azure 間のディザスター リカバリーと同様に、高速ネットワークを有効にすることができます (VM SKU でサポートされている場合)。

- パブリック IP アドレス:同じリージョン内に以前作成した標準パブリック IP アドレスをターゲット VM に割り当てることができます。 基本パブリック IP アドレスでは、可用性ゾーンに関連するシナリオをサポートしていません。

- ロード バランサー:Standard Load Balancer はリージョン リソースであるため、同じロード バランサーのバックエンド プールにターゲット VM をアタッチできます。 新しいロード バランサーは必要ありません。

- ネットワーク セキュリティ グループ:ソース VM に適用されているものと同じネットワーク セキュリティ グループを使用できます。

## <a name="pre-requisites"></a>前提条件

お使いの VM にゾーン間ディザスター リカバリーをデプロイする前に、その VM で有効になっている他の機能がゾーン間のディザスター リカバリーと相互運用可能であるようにすることが重要です。

|特徴量  | サポートに関する声明  |
|---------|---------|
|クラシック VM   |     サポートされていません    |
|ARM VM    |    サポートされています    |
|Azure Disk Encryption v1 (デュアル パス、Azure Active Directory (Azure AD) あり)     |     サポートされています   |
|Azure Disk Encryption v2 (シングル パス、Azure AD なし)    |    サポートされています    |
|非管理対象ディスク    |    サポートされていません    |
|マネージド ディスク    |    サポートされています    |
|カスタマー マネージド キー    |    サポートされています    |
|近接通信配置グループ    |    サポートされています    |
|バックアップの相互運用性    |    ファイル レベルのバックアップと復元がサポートされています。 ディスクおよび VM レベルのバックアップと復元はサポートされていません。    |
|ホット アド/削除    |    ゾーン間のレプリケーションを有効にした後で、ディスクを追加できます。 ゾーン間のレプリケーションを有効にした後のディスクの削除はサポートされていません。    | 

## <a name="set-up-site-recovery-zone-to-zone-disaster-recovery"></a>Site Recovery のゾーン間ディザスター リカバリーの設定

### <a name="log-in"></a>ログイン

Azure ポータルにログインします。

### <a name="enable-replication-for-the-zonal-azure-virtual-machine"></a>ゾーン ベースの Azure 仮想マシンのレプリケーションを有効にする

1. Azure portal のメニューで [仮想マシン] を選択するか、任意のページ上で "仮想マシン" を検索して選択します。 レプリケーションする VM を選択します。 ゾーン間のディザスター リカバリーの場合、この VM は可用性ゾーンに既に存在する必要があります。

2. [操作] で、[ディザスター リカバリー] を選択します。

3. 次に示すように、[基本] タブの [Disaster Recovery between Availability Zones?] (可用性ゾーン間のディザスター リカバリーを行いますか?) で、[はい] を選択します。

    ![基本設定ページ](./media/azure-to-azure-how-to-enable-zone-to-zone-disaster-recovery/zonal-disaster-recovery-basic-settings-blade.png)

4. すべての既定値をそのまま使用する場合は、[レプリケーションの確認と開始]、[レプリケーションを開始する] の順にクリックします。

5. レプリケーションの設定を変更する場合は、[次:詳細設定] をクリックします。

6. 必要に応じて、既定値の設定を変更します。 Azure 間のディザスター リカバリーのユーザーにとって、このページは使い慣れたように見えるかもしれません。 このブレードに表示されるオプションについて詳しくは、[こちら](./azure-to-azure-tutorial-enable-replication.md)をご覧ください

    ![詳細設定ページ](./media/azure-to-azure-how-to-enable-zone-to-zone-disaster-recovery/zonal-disaster-recovery-advanced-settings-blade.png)

7. [次へ:レプリケーションの確認と開始]、[レプリケーションを開始する] の順にクリックします。

## <a name="faqs"></a>FAQ

**1.ゾーン間ディザスター リカバリーの価格体系はどのようになっていますか?**
ゾーン間ディザスター リカバリーの価格は、Azure 間ディザスター リカバリーの価格と同じです。 詳しくは、価格に関する[こちら](https://azure.microsoft.com/pricing/details/site-recovery/)と[こちら](https://azure.microsoft.com/blog/know-exactly-how-much-it-will-cost-for-enabling-dr-to-your-azure-vm/)のページをご覧ください。 ゾーン間のディザスター リカバリーに表示されるエグレス料金は、リージョン間のディザスター リカバリーよりも低くなることに注意してください。

**2.RTO と RPO の SLA とは何ですか?**
RTO の SLA は、Site Recovery 全体のそれと同じです。 最大 2 時間の RTO をお約束します。 RPO には定義された SLA がありません。

**3.セカンダリ ゾーンでは容量が保証されていますか?**
十分なインフラストラクチャ容量が確保されるよう、Site Recovery チームと Azure 容量管理チームが計画を立てます。 フェールオーバーを開始するとき、Site Recovery によって保護される VM インスタンスがターゲット ゾーンにデプロイされるよう、チームも支援します。

**4.サポート対象のオペレーティング システムはどれですか?**
ゾーン間のディザスター リカバリーでは、Azure 間のディザスター リカバリーと同じオペレーティング システムがサポートされています。 [こちら](./azure-to-azure-support-matrix.md)のサポート マトリックスを参照してください。

**5.ソースとターゲットのリソース グループを同じにすることはできますか?**
いいえ。別のリソース グループにフェールオーバーする必要があります。

## <a name="next-steps"></a>次のステップ

ディザスター リカバリーの訓練、フェールオーバー、再保護、フェールバックを実行するために従う必要がある手順は、Azure 間のディザスター リカバリー シナリオの手順と同じです。

ディザスター リカバリーの訓練を実施するには、[こちら](./azure-to-azure-tutorial-dr-drill.md)に記載されている手順に従ってください。

セカンダリ ゾーンでフェールオーバーと再保護を行うには、[こちら](./azure-to-azure-tutorial-failover-failback.md)に記載されている手順に従ってください。

プライマリ ゾーンにフェールバックするには、[こちら](./azure-to-azure-tutorial-failback.md)に記載されている手順に従ってください。
