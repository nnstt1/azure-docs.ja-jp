---
title: Azure オーストラリアでの Azure Key Vault
description: オーストラリア リージョン内でオーストラリア政府のポリシー、規制、および法律に固有の要件を満たすキー管理を行うために Azure Key Vault を構成および使用する方法について説明します。
author: emilyre
ms.service: azure-australia
ms.topic: conceptual
ms.date: 07/22/2019
ms.author: yvettep
ms.openlocfilehash: f14a2264769e1bb1fca8e4372ba1359e1b99e560
ms.sourcegitcommit: 0046757af1da267fc2f0e88617c633524883795f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/13/2021
ms.locfileid: "121727286"
---
# <a name="azure-key-vault-in-azure-australia"></a>Azure オーストラリアでの Azure Key Vault

暗号キーの安全な保管および暗号キーのライフサイクルの管理は、暗号システムにおいて非常に重要な要素です。  Azure 内でこの機能を提供しているサービスは、Azure Key Vault です。 Key Vault は、IRAP によってセキュリティ アクセスが検証され、ACSC から PROTECTED の認定を受けています。  この記事では、Key Vault を使用する際に、オーストラリア通信電子局 (ASD) の [Information Security Manual Controls](https://acsc.gov.au/infosec/ism/) (ISM) に準拠するための主要な考慮事項について概説します。

Azure Key Vault は、暗号化キーとシークレットを保護するクラウド サービスです。 このデータは機密性が高く、ビジネス上重要であるため、Key Vault では、キー コンテナーへのアクセスのセキュリティ保護が有効にされ、承認されたユーザーとアプリケーションのみが許可されます。 Key Vault によって管理および制御される成果物は主に次の 3 つです。

- キー
- secrets
- certificates

この記事では、Key Vault を使用したキーの管理に重点を置いて説明します。

![Azure Key Vault](media/azure-key-vault-overview.png)

*図 1 – Azure Key Vault*

## <a name="key-design-considerations"></a>設計上の主な考慮事項

### <a name="deployment-options"></a>デプロイ オプション

Azure Key Vault を作成するには 2 つのオプションを使用できます。 どちらのオプションでも Hardware Security Modules (HSM) の nCipher nShield ファミリが使用されます。さらに両方とも、Federal Information Processing Standards (FIPS) への準拠が検証済みであり、保護された環境内へのキーの格納が承認されています。 オプションは次のとおりです。

- **ソフトウェアで保護されているコンテナー**: FIPS 140-2 レベル 1 への準拠が検証済み。 HSM に格納されているキー。 暗号化および暗号化の解除の操作は、Azure 上のコンピューティング リソースで実行されます。
- **HSM で保護されたコンテナー**: FIPS 140-2 レベル 2 への準拠が検証済み。 HSM に格納されているキー。 暗号化および暗号化の解除の操作は、HSM 上で実行されます。

Key Vault では、Rivest-Shamir-Adleman (RSA) キーと楕円曲線暗号 (ECC) キーがサポートされています。 既定値は RSA 2048 ビット キーですが、RSA 3072 ビット キー、RSA 4096 ビット キー、および ECC キーに対応する高度なオプションもあります。  すべてのキーが ISM コントロールを満たしていますが、楕円曲線キーの使用をお勧めします。

### <a name="resource-operations"></a>リソース操作

Azure Key Vault にはいくつかのペルソナが関与しています。

- **Key Vault 管理者:** コンテナーのライフサイクルを管理します
- **キー管理者:** コンテナー内のキーのライフサイクルを管理します
- **開発者/オペレーター:** コンテナーからのキーをアプリケーションとサービスに統合します
- **監査担当者:** キーの使用状況とアクセスを監視します
- **アプリケーション:** キーを使用して情報をセキュリティで保護します

Azure Key Vault は、次の 2 つの異なるインターフェイスによってセキュリティが保護されます。

- **管理プレーン:** このプレーンではコンテナーの管理が行われ、Azure RBAC によってセキュリティで保護されています。
- **データ プレーン:** このプレーンでは、コンテナー内の成果物が管理され、その成果物に対するアクセスが処理されます。  Key Vault アクセス ポリシーを使用したセキュリティ保護。

ISM で要件とされているように、呼び出し元 (ユーザーまたはアプリケーション) がいずれかのプレーンによってキー コンテナーにアクセスするには、事前に適切な認証と承認が必要です。

Azure RBAC には、Key Vault の管理を行うために、Key Vault 用に組み込みロールが 1 つ ([Key Vault の共同作成者](../role-based-access-control/built-in-roles.md#key-vault-contributor)) 用意されています。 ご利用の Key Vault を管理する場合は、よりきめ細かいロールに対応するカスタム ロールを作成することをお勧めします。

>[!WARNING]
>Key Vault アクセス ポリシーを介してキーへのアクセスを有効にした場合、ユーザーまたはアプリケーションはキー コンテナー内のすべてのキーに対して該当するアクセス権を有します (たとえば、ユーザーは、"削除" アクセス権を持っている場合、すべてのキーを削除できます)。  したがって、セキュリティ ドメイン/境界に合わせて複数のキー コンテナーをデプロイする必要があります。

### <a name="networking"></a>ネットワーク

Key Vault ファイアウォールと仮想ネットワークを構成することで、データプレーンへのアクセスを制御することができます。  指定したネットワーク上のユーザーまたはアプリケーションへのアクセスを許可すると同時に、他のすべてのネットワーク上のユーザーまたはアプリケーションへのアクセスを拒否することができます。 [信頼できるサービスを許可する] を有効にした場合、[信頼できるサービス](../key-vault/general/overview-vnet-service-endpoints.md#trusted-services)はこの制御の例外となります。  仮想ネットワーク制御は、管理プレーンには適用されません。

キー コンテナーへのアクセスは、キーへのアクセスを必要とするユーザーまたはアプリケーションを含むネットワークの最小セットに明示的に制限する必要があります。

### <a name="bring-your-own-key-byok"></a>Bring Your Own Key (BYOK)

Key Vault では BYOK がサポートされています。  BYOK を使用することで、ユーザーは既存のキー インフラストラクチャからキーをインポートすることができます。 BYOK ツールセットは、外部の HSM からのキー (オフラインのワークステーションで生成されたキーなど) を Key Vault に安全に転送およびインポートできるようにサポートします。

Microsoft ダウンロード センターにアクセスし、オーストラリアの [Azure Key Vault BYOK ツールセットをダウンロード](https://www.microsoft.com/download/details.aspx?id=45345)します。 ダウンロードするパッケージの名前とそれに対応する SHA-256 パッケージ ハッシュは、次のとおりです。

|パッケージ名|Sha-256 ハッシュ|
|---|---|
|KeyVault-BYOK-Tools-Australia.zip|CD0FB7365053DEF8C35116D7C92D203C64A3D3EE2452A025223EEB166901C40A|
|

### <a name="key-vault-auditing-and-logging"></a>Key Vault の監査とログ

ACSC では、オーストラリア連邦のエンティティに対して、適切な Azure サービスを使用して、Azure ワークロードに関するリアルタイムの監視およびレポートを実施することが必須です。

ログ記録を有効にするには、Key Value に対して **_"AuditEvent"_** 診断設定を有効にします。  監査イベントは、指定したストレージ アカウントに記録されます。  **_"RetentionInDays"_** 期間は、データ保持ポリシーに従って設定する必要があります。  管理プレーンとデータ プレーンの両方に対する[操作](../key-vault/general/logging.md#interpret-your-key-vault-logs)が監査され、ログに記録されます。 [Azure Monitor 内の Azure Key Vault ソリューション](../azure-monitor/insights/key-vault-insights-overview.md)を使用することで、Key Vault の AuditEvent ログを確認することができます。  Key Vault の AuditEvent の処理と配布には、他にも複数の Azure サービスを使用できます。

### <a name="key-rotation"></a>キーの交換

Key Vault にキーを格納することで、アプリケーションの外部にキーを維持するための単一の場所が提供され、これにより、アプリケーションの動作に影響を与えることなくキーを更新することができました。 Azure Key Vault にキーを格納すれば、キーの交換をサポートするためのさまざまな戦略が可能になります。

- 手動
- API を介してプログラムを使用
- オートメーション スクリプト (たとえば、PowerShell や Azure Automation を使用)

これらのオプションを使用すると、コンプライアンス要件を満たすように定期的にキーを交換することも、キーが侵害された可能性がある場合に臨時的にキーを交換することもできます。

#### <a name="key-rotation-strategies"></a>キーの交換の戦略

KeyVault に格納されているキーに合わせて適切なキー交換戦略を開発することが重要です。  間違ったキーを使用すると、情報の暗号化解除が正確に行われません。さらに、キーを紛失すると、情報へのアクセスが完全に失われる可能性があります。  さまざまなシナリオでのキー交換戦略の例を次に示します。

- **配信中データ:** 2 つのパーティ間で揮発性の情報が送信されます。  キーを交換する場合、両方のパーティは、キー コンテナーからの更新済みキーの取得を同期して行うためのメカニズムを備えている必要があります。
- **保存中のデータ:** パーティは、暗号化されたデータを格納し、将来使用する場合に暗号化を解除します。  キーを交換する場合、古いキーを使用してデータを暗号化解除してから、交換された新しいキーを使用してデータを暗号化する必要があります。  キー暗号化キーを使用した暗号化の解除/暗号化プロセスの影響を最小限に抑えるためのアプローチが複数あります (例を参照)。  Microsoft では、Azure Storage 用のキーの交換に関連するプロセスの大部分を管理しています (...を参照)。
- **アクセス キー:** 複数の Azure サービスでは、Key Vault に格納できるアクセス キーが用意されています (たとえば、CosmosDB)。  Azure サービスには、プライマリ アクセスキーとセカンダリ アクセスキーがあります。  両方のキーを同時に交換しないことが重要です。  したがって、1 つ目のキーを交換したら、一定期間後にそのキー操作を確認してから、2 番目のキーを交換できるようになります。

### <a name="high-availability"></a>高可用性

ISM には、ビジネス継続性に関連するコントロールがいくつかあります。
Azure Key Vault には、複数層の冗長性があり、コンテンツはリージョン内に、およびセカンダリの[ペア リージョン](../best-practices-availability-paired-regions.md)にレプリケートされます。

キー コンテナーは、フェールオーバー状態の場合には読み取り専用モードになっていて、プライマリ サービスが復元されると、読み取り/書き込みモードに戻ります。

ISM には、バックアップに関連するいくつかのコントロールがあります。  資格情報コンテナーとそのキーに合わせて適切なバックアップ/復元プランを開発して実行することが重要です。

## <a name="key-lifecycle"></a>キーのライフサイクル

### <a name="key-operations"></a>キーの操作

Key Vault では、キーに対して次の操作がサポートされます。

- **作成:** クライアントは、Key Vault にキーを作成できます。 キーの値は、Key Vault によって生成されて格納され、クライアントにはリリースされません。 Key Vault では非対称キーを作成できます。
- **インポート:** クライアントは、既存のキーを Key Vault にインポートできます。 JWK コンストラクト内の複数のパッケージング方法を使用して、非対称キーを Key Vault にインポートできます。
- **更新:** 十分なアクセス許可を持つクライアントは、以前に Key Vault に格納されたキーに関連付けられているメタデータ (キー属性) を変更できます。
- **削除:** 十分なアクセス許可を持つクライアントは、Key Vault からキーを削除できます。
- **一覧表示:** クライアントは、特定の Key Vault 内のすべてのキーを一覧表示できます。
- **バージョンの一覧表示:** クライアントは、特定の Key Vault 内の特定のキーのすべてのバージョンを一覧表示できます。
- **取得:** クライアントは、Key Vault 内の特定のキーの公開部分を取得できます。
- **バックアップ:** 保護された形式でキーをエクスポートします。
- **復元:** 以前にバックアップしたキーをインポートします。

ユーザー、サービス プリンシパル、またはアプリケーションがキー操作を実行できるようにするために、Key Vault アクセス制御エントリを使用してそれらに付与できる対応する一連のアクセス権があります。

Key Vault には論理的な削除機能が用意されており、これを使用すると、削除された資格情報コンテナーとキーを復旧できます。 既定では、**_"論理的な削除"_** は有効になっていませんが、これを有効にすると、オブジェクトは削除されたように見えるものの、90 日間 (保持期間) は保持されます。  追加のアクセス許可である **_"消去"_** を使用すると、**_[消去保護]_** オプションが無効になっている場合に、キーを永久的に削除することができます。

既存のキーを作成またはインポートすると、新しいバージョンのキーが作成されます。

### <a name="cryptographic-operations"></a>暗号化操作

Key Vault ではまた、キーを使用した暗号化操作もサポートされています。

- **署名と検証:** この操作は、"ハッシュの署名" または "ハッシュの検証" です。 Key Vault では、署名作成の一環として行われるコンテンツのハッシュはサポートされていません。
- **キーの暗号化/ラップ:** この操作は、別のキーを保護するために使用されます。
- **暗号化と暗号化の解除**: 格納されているキーを使用して、データの単一のブロックを暗号化または暗号化解除することができます。

ユーザー、サービス プリンシパル、またはアプリケーションが暗号化操作を実行できるようにするために、Key Vault アクセス制御エントリを使用してそれらに付与できる対応する一連のアクセス権があります。

キーを有効にして暗号操作に使用できるようにするかどうかを制御する場合に設定できる 3 つのキー属性があります。

- **有効**
- **nbf:** 指定した日付より前に、事前に有効化されていません
- **exp:** 有効期限

## <a name="storage-and-keys"></a>ストレージとキー

カスタマー マネージド キーは柔軟性がより高く、これを使用することで、制御対象のキーを評価および管理することができます。 また、それによって、データを保護するために使用される暗号化キーの監査が可能になります。
Key Vault に格納されるストレージとキーには、次の 3 つの側面があります。

- Key Vault マネージド ストレージ アカウント キー
- 保存データ向けの Azure Storage Service Encryption (SSE)
- マネージド ディスクと Azure Disk Encryption

Key Vault の Azure Storage アカウント キー管理は Key Vault のキー サービスに追加された拡張機能であり、ストレージ アカウント キーの同期と再生成 (交換) がサポートされます。  [Azure Storage と Azure Active Directory の統合](../storage/blobs/authorize-access-azure-active-directory.md) (プレビュー) では、優れたセキュリティと使いやすさが実現されているので、リリース時にお勧めします。
SSE では、次の 2 つのキーを使用して保存データの暗号化が管理されます。

- キーの暗号化キー (KEK)
- データ暗号化キー (DEK)

Microsoft は DEK を管理する一方で、SSE には、Key Vault に格納できるカスタマー マネージド KEK を使用するためのオプションが用意されています。 これにより、適切なコンプライアンス ポリシーに従って Azure Key Vault 内でキーを交換することができます。 キーの交換を行うと、そのストレージ アカウント用のアカウント暗号化キーが Azure Storage によって再暗号化されます。 これで全データが再暗号化されるわけではなく、またこれ以上の操作を行う必要はありません。

マネージド ディスクには SSE が使用されますが、カスタマー マネージド キーはサポートされていません。  カスタマー マネージド KEK キーが Key Vault にある場合は、Azure Disk Encryption を使用してマネージド ディスクの暗号化を行うことができます。

## <a name="next-steps"></a>次の手順

[ID フェデレーション](identity-federation.md)に関する記事を確認する

[リファレンス ライブラリ](reference-library.md)にある Azure Key Vault に関する他のドキュメントとチュートリアルを確認する