---
title: 高可用性とディザスター リカバリー
description: リージョン障害に対処できるように Batch アプリケーションを設計する方法について説明します。
ms.topic: how-to
ms.date: 09/08/2021
ms.openlocfilehash: 5ba56d769344b930cdc3c6500d42456214b32a71
ms.sourcegitcommit: 0770a7d91278043a83ccc597af25934854605e8b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/13/2021
ms.locfileid: "124799151"
---
# <a name="design-your-batch-application-for-high-availability"></a>高可用性を実現するように Batch アプリケーションを設計する

Azure Batch はすべての Azure リージョンで使用できますが、Batch アカウントを作成したら、それを 1 つの特定のリージョンに関連付ける必要があります。 それにより、Batch アカウントのすべての操作がそのリージョンに適用されます。 たとえば、プールや関連付けられている仮想マシン (VM) は、Batch アカウントと同じリージョン内に作成されます。

Batch を使用するアプリケーションを設計するときは、Batch がリージョン内で使用できなくなっている可能性を考慮する必要があります。 まれな状況として、リージョン全体、リージョン内の Batch サービス全体、または特定の Batch アカウントに関する問題が発生する場合があります。

Batch を使用するアプリケーションまたはソリューションが常に使用可能である必要がある場合は、別のリージョンにフェールオーバーするか、またはワークロードが常に 2 つ以上のリージョン間で分割されるように設計する必要があります。 どちらのアプローチにも、それぞれが異なるリージョンに配置された、少なくとも 2 つの Batch アカウントが必要です。

## <a name="multiple-batch-accounts-in-multiple-regions"></a>複数のリージョン内の複数の Batch アカウント

さまざまなリージョンで複数の Batch アカウントを使用すると、1 つのリージョンで Batch アカウントが使用できなくなった場合でも、アプリケーションの実行を継続できます。 アプリケーションを高可用性にする必要がある場合、複数のアカウントを使用することが特に重要です。

場合によっては、複数のリージョンを意図的に使用するようにアプリケーションが設計することができます。 たとえば、膨大な容量が必要な場合は、大規模なアプリケーションを処理するか、または将来の拡張要求に応えるために複数のリージョンの使用が必要になることがあります。 このようなアプリケーションには、複数の Batch アカウント (使用するリージョンごとに 1 つ) も必要です。

## <a name="design-considerations-for-providing-failover"></a>フェールオーバーを実現するための設計上の考慮事項

代替リージョンにフェールオーバーする機能を実現する場合、ソリューション内のすべてのコンポーネントを検討する必要があることです。2 つ目の Batch アカウントを作成するだけでは不十分です。 たとえば、ほとんどの Batch アプリケーションでは Azure ストレージ アカウントが必要であり、許容されるパフォーマンスを得るにはストレージ アカウントと Batch アカウントを同じリージョンに配置する必要があります。

フェールオーバー可能なソリューションを設計するときは、次の点を考慮してください。

- 各リージョン内に必要なすべてのサービス (Batch アカウントやストレージ アカウントなど) を事前に作成します。 多くの場合、アカウントの作成は無料であり、アカウントが使用されたとき、またはデータが格納されたときにのみ料金が発生します。
- Batch アカウントを使用して必要な数のコアを割り当てることができるように、事前にすべてのサブスクリプションに適切な[クォータ](batch-quota-limit.md)が設定されていることを確認してください。
- テンプレートまたはスクリプト、あるいはその両方を使用して、リージョンへのアプリケーションのデプロイを自動化します。
- すべてのリージョンでアプリケーション バイナリや参照データを最新の状態に維持します。 最新の状態に維持することにより、ファイルのアップロードやデプロイを待つことなく、リージョンをすばやくオンラインにできるようになります。 たとえば、プール ノードにインストールするカスタム アプリケーションが Batch アプリケーション パッケージを使用して格納および参照されている場合は、アプリケーションの新しいバージョンが生成されると、それを各 Batch アカウントにアップロードし、プール構成で参照する (または、新しいバージョンを既定のバージョンにする) 必要があります。
- Batch、ストレージ、およびその他のサービスを呼び出すアプリケーションで、クライアントまたは負荷を別のリージョンに簡単に切り替えることができます。
- 可能な場合は、[Availability Zones 間でプールを作成する](create-pool-availability-zones.md)ことを検討してください。
- 通常の操作の一環として、代替リージョンに頻繁に切り替えることを検討してください。 たとえば、個別のリージョンに 2 つのデプロイがある場合は、毎月代替リージョンに切り替えます。

## <a name="next-steps"></a>次のステップ

- [Azure portal](batch-account-create-portal.md)、[Azure CLI](./scripts/batch-cli-sample-create-account.md)、[PowerShell](batch-powershell-cmdlets-get-started.md)、または [Batch Management API](batch-management-dotnet.md) を使用して Batch アカウントを作成する方法の詳細について説明します。
- [Batch アカウントに関連付けられている既定のクォータ](batch-quota-limit.md)とクォータを増やす方法について説明します。
