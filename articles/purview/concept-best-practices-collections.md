---
title: Purview コレクションのアーキテクチャとベスト プラクティス
description: この記事では、Azure Purview コレクションのアーキテクチャの例を提供し、ベスト プラクティスについて説明します。
author: zeinam
ms.author: zeinam
ms.service: purview
ms.subservice: purview-data-map
ms.topic: conceptual
ms.date: 09/27/2021
ms.openlocfilehash: 838730453f5d49efd756abce40faec74513d52b2
ms.sourcegitcommit: 7bd48cdf50509174714ecb69848a222314e06ef6
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/02/2021
ms.locfileid: "129390332"
---
# <a name="azure-purview-collections-architectures-and-best-practices"></a>Azure Purview コレクションのアーキテクチャとベスト プラクティス  

Azure Purview の中核となるデータ マップは、データ資産全体の資産とそのメタデータの最新のマップを保持するサービスとしてのプラットフォーム (PaaS) コンポーネントです。 データ マップをハイドレートするには、データ ソースを登録してスキャンする必要があります。 組織には、一元化された、または分散チームによって管理およびガバナンスされる、何千ものデータ ソースが存在する場合があります。  

メタデータの組織のマッピングは、Azure Purview の[コレクション](./how-to-create-and-manage-collections.md)によってサポートされます。 コレクションを使用することで、フラット構造ではなく階層内のデータ ソース、スキャン、資産を管理および維持できます。 コレクションを使用すると、組織で Azure Purview を使用してランドスケープを管理する方法に基づいて、データ ランドスケープのカスタム階層モデルを構築できます。

また、コレクションによって、データ マップ内のメタデータに対してセキュリティ境界も提供されます。 コレクション、データ ソース、メタデータへのアクセスは、最小特権モデルに従って、Azure Purview のコレクション階層に基づいて設定および管理されます。 
- ユーザーには、ジョブを実行するために必要な最小限のアクセス権が付与されます。 
- ユーザーは、必要のない機密データにはアクセスできません。

## <a name="intended-audience"></a>対象ユーザー

- データ アーキテクチャ チーム 
- データ ガバナンスおよび管理チーム
- データ セキュリティ チーム

## <a name="why-do-you-need-to-define-collections-and-an-authorization-model-for-your-azure-purview-account"></a>Azure Purview アカウント用にコレクションと承認モデルを定義する必要がある理由 

次の要件を満たすには、Azure Purview にコレクションをデプロイすることを検討します。 

- ビジネス要件、データの地理的な分散、データ管理チーム、部門、またはビジネス機能に基づいて、データ ソースを整理し、資産を分散させ、スキャンを実行します。 

- 対応するコレクションにロールを割り当てることにより、データ ソースと資産の所有権を対応するチームに委任します。 

- コレクションごとに資産を検索してフィルター処理します。 
 

## <a name="define-a-collection-hierarchy"></a>コレクションの階層を定義する  

### <a name="design-considerations"></a>設計上の考慮事項  

- 各 Purview アカウントは、既定の "_ルート コレクション_" を使用して作成されます。 ルート コレクションの名前は、お使いの Azure Purview アカウントの名前と同じです。 ルート コレクションを削除することはできません。 ルート コレクションのフレンドリ名を変更するには、Purview 管理センターから Purview アカウントのフレンドリ名を変更します。   

- コレクションには、データ ソース、スキャン、資産、ロールの割り当てを保持できます。

- コレクションには、必要に応じていくつでも子コレクションを作成できます。 ただし、各コレクションが持つことのできる親コレクションは 1 つだけです。 ルート コレクションの上にコレクションをデプロイすることはできません。

- データ ソース、スキャン、資産は、1 つのコレクションにのみ属することができます。 

- Azure Purview のコレクション階層では、最大 8 レベルの深さで、最大 256 個のコレクションをサポートできます。 これにはルート コレクションは含まれません。 

- 設計上、1 つの Purview アカウントにデータ ソースを複数回登録することはできません。 このアーキテクチャは、1 つのデータ ソースに異なるレベルのアクセス制御を割り当てるリスクを回避するのに役立ちます。 複数のチームで 1 つのデータ ソースのメタデータを使用する場合は、親コレクションにデータ ソースを登録して管理できます。 その場合、各サブコレクションの下に対応するスキャンを作成して、関連する資産が各子コレクションの下に表示されるようにすることができます。

- データ ソースが下位レベルのコレクションに登録されている場合でも、系列の接続と成果物はルート コレクションにアタッチされます。

- 既定では、新しいスキャンを実行すると、スキャンはデータ ソースと同じコレクションにデプロイされます。 必要に応じて、異なるサブコレクションを選択してスキャンを実行できます。 その結果、資産はサブコレクションの下に属します。 

- 現在、コレクション間でデータ ソースを移動することはできません。 データ ソースを別のコレクションの下に移動する必要がある場合は、すべての資産を削除し、元のコレクションからデータ ソースを削除して、移動先のコレクションにデータ ソースを再登録する必要があります。

- 移動元と移動先のコレクションのデータ キュレーター ロールがユーザーに付与されている場合は、コレクション間で資産を移動できます。 

- 現在、コレクションの移動や名前変更などの特定の操作は許可されていません。 

- アセット、関連付けられたスキャン、データ ソース、または子コレクションがない場合は、そのコレクションを削除できます。

- Azure Purview データ マップにデータ ソース、スキャン、資産が存在する場合、コレクションに属している必要があります。    

<!-- 
- Moving data sources across collections is allowed if the user is granted the Data Source Admin role for the source and destination collections. 

- Moving assets across collections is allowed if the user is granted the Data Curator role for the source and destination collections. 

-->

### <a name="design-recommendations"></a>設計の推奨事項 

- コレクションの構造を計画する前に、[Azure Purview アカウントのベスト プラクティス](./deployment-best-practices.md#determine-the-number-of-purview-instances)に関するページを確認して、組織で必要な適切な数の Purview アカウントを定義します。  

- 組織のセキュリティ要件およびデータ管理とガバナンスの構造に基づいて、コレクションのアーキテクチャを設計することをお勧めします。 この記事で推奨される[コレクションのアーキタイプ](#collections-archetypes)を確認してください。

- 将来のスケーラビリティのため、ルート コレクションの下に組織の最上位のコレクションを作成することをお勧めします。 ルート コレクションではなく、最上位のコレクションに関連するロールを割り当てます。  

- Azure Purview でコレクションを構築するときは、設計の意思決定プロセスの一部としてセキュリティとアクセス管理を検討します。 

- 各コレクションには、名前属性とフレンドリ名属性があります。 Azure [Purview Studio](https://web.purview.azure.com/resource/) を使用してコレクションをデプロイする場合は、重複を避けるため、ランダムな 6 文字の名前がシステムによって自動的にコレクションに割り当てられます。 複雑さを軽減するには、コレクション間で重複するフレンドリ名を使用しないようにします (特に同じレベルで)。  

- 可能な場合は、組織の構造を深い入れ子になったコレクション階層に複製しないようにします。 これを回避できない場合は、コレクションを区別しやすくするため、階層内のすべてのコレクションに異なる名前を使用してください。

- コレクションとロールの割り当てを一括でデプロイする予定の場合は、API を使用してコレクションのデプロイを自動化します。

- 専用のサービス プリンシパル名 (SPN) を使用し、API を使用してコレクションとロールの割り当てに対する操作を実行します。 SPN を使用することは、昇格された権利を持つユーザーの数が減り、最小特権ガイドラインに従うということになります。

## <a name="define-an-authorization-model"></a>承認モデルを定義する

Azure Purview のデータ プレーンのロールは、Azure Purview で管理されます。 Purview アカウントをデプロイすると、Purview アカウントの作成者に、ルート コレクションに対する次のロールが自動的に割り当てられます。 [Purview Studio](https://web.purview.azure.com/resource/) またはプログラムによる方法を使用し、Azure Purview でロールを直接割り当てて管理できます。

  - **コレクション管理者** は、Purview コレクションとその詳細を編集し、サブコレクションを追加できます。 自分が管理者であるコレクションの他の Purview ロールに、ユーザーを追加することもできます。
  - **データ ソース管理者** は、データ ソースとデータ スキャンを管理できます。
  - **データ キュレーター** は、カタログ データ資産の作成、読み取り、変更、削除を行い、資産間のリレーションシップを確立することができます。
  - **データ閲覧者** は、カタログ データ資産にアクセスできますが、変更はできません。

### <a name="design-considerations"></a>設計上の考慮事項  

- Azure Purview のアクセス管理はデータ プレーンに移動しました。 Azure Resource Manager のロールは使用されなくなったので、Azure Purview を使用してロールを割り当てる必要があります。 

- Azure Purview では、Purview アカウントがデプロイされているのと同じ Azure AD テナント上の Azure Active Directory (Azure AD) から、ユーザー、セキュリティ グループ、サービス プリンシパル (マネージド ID を含む) にロールを割り当てることができます。
  
- Purview のロールを外部ユーザーに割り当てるには、その前にまず、ゲスト アカウントを Azure AD テナントに B2B ユーザーとして追加する必要があります。 

- 既定では、コレクション管理者には、資産の読み取りまたは変更を行うためのアクセス権はありません。 ただし、自分のアクセス権を昇格させて、さらに多くのロールに自分自身を追加することはできます。

- 既定では、すべてのロールの割り当ては、すべての子コレクションによって自動的に継承されます。 ただし、ルート コレクションを除く任意のコレクションで、 **[Restrict inherited permissions]\(継承されたアクセス許可を制限する\)** を有効にできます。 **[Restrict inherited permissions]\(継承されたアクセス許可を制限する\)** を有効にすると、コレクション管理者ロールを除く、すべての親コレクションから継承されたロールが、削除されます。 

- Azure Data Factory の接続の場合: Azure Data Factory に接続するには、ルート コレクションのコレクション管理者である必要があります。

- 系列のために Azure Data Factory に接続する必要がある場合は、Purview のルート コレクションのレベルで、データ ファクトリのマネージド ID にデータ キュレーター ロールを付与します。 オーサリング UI で Data Factory を Purview に接続すると、Data Factory によってこれらのロール割り当ての追加が自動的に試みられます。 Purview ルート コレクションに対するコレクション管理者ロールを持っている場合、この操作は機能します。 

### <a name="design-recommendations"></a>設計の推奨事項 

- Purview アカウント レベルのロックアウトを回避するため、Azure Purview のルート コレクション レベルで、コレクション管理者ロールの[緊急アクセス](/azure/active-directory/users-groups-roles/directory-emergency-access)または非常用戦略を実装することを検討します。 緊急アカウントを使用するプロセスを文書化します。 

    > [!NOTE]
    > 特定のシナリオでは、緊急アカウントを使用して Azure Purview にサインインすることが必要になる場合があります。 他の誰も Purview にサインインできないとき、または会社の認証の問題のために他の管理者が特定の操作を実行できないときに、組織レベルのアクセスの問題を解決するため、この種類のアカウントが必要になることがあります。 クラウド専用ユーザーを使用した[緊急アクセス アカウント](/azure/active-directory/users-groups-roles/directory-emergency-access)の実装に関する Microsoft のベスト プラクティスに従うことを強くお勧めします。
    >
    > 前のコレクション管理者を使用できない場合は、[こちらの記事](./concept-account-upgrade.md#what-happens-when-your-upgraded-account-doesnt-have-a-collection-admin)の手順に従って、Purview ルート コレクションへのアクセスを回復します。

- ルート コレクション管理者の数を最小限に抑えます。 ルート コレクションに最大 3 人のコレクション管理者ユーザーを割り当てます (SPN と非常用アカウントを含む)。 代わりに、コレクション管理者ロールを最上位のコレクションまたはサブコレクションに割り当てます。

- 個々のユーザーではなくグループにロールを割り当て、個々のロールを管理する場合の管理オーバーヘッドとエラーを減らします。 

- 自動化のためには、ルート コレクションにサービス プリンシパルを割り当てます。

- セキュリティを強化するには、少なくともコレクション管理者、データ ソース管理者、データ キュレーターに対して、Azure AD 条件付きアクセスと多要素認証を有効にします。 緊急アカウントが条件付きアクセス ポリシーから除外されていることを確認します。
 
## <a name="collections-archetypes"></a>コレクションのアーキタイプ

集中型、分散型、またはハイブリッド型のデータ管理およびガバナンス モデルに基づいて、Azure Purview コレクションをデプロイできます。 ビジネスおよびセキュリティ要件に基づいてこれを決定します。

### <a name="example-1-single-region-organization"></a>例 1: 単一リージョンの組織 

この構造は、次のような組織に適しています。 
- 主に 1 つの地理的な場所に基づいている。 
- 次のレベルのデータ管理が部門、チーム、またはプロジェクトに分類される、集中型のデータ管理およびガバナンス チームがある。  

コレクション階層は、次の垂直要素で構成されます。 

- ルート コレクション (既定)
- Contoso (最上位コレクション)
- 部署 (各部門のデリゲートされたコレクション) 
- チームまたはプロジェクト (プロジェクトに基づいてさらに分離)

各データ ソースは、対応するコレクションで登録およびスキャンされます。 そのため、資産も同じコレクションに表示されます。 

組織レベルの共有データ ソースは、ハブ共有コレクションで登録およびスキャンされます。 

部署レベルの共有データ ソースは、部署コレクションで登録およびスキャンされます。 

:::image type="content" source="media/concept-best-practices/collections-example-1.png" alt-text="1 番目の Azure Purview コレクションの例を示すスクリーンショット。"lightbox="media/concept-best-practices/collections-example-1.png":::

### <a name="example-2-multiregion-organization"></a>例 2: 複数リージョンの組織

このシナリオは、次のような組織に適しています。 
- 複数のリージョンに存在する。 
- データ ガバナンス チームが集中しているか、またはリージョンごとに分散されている。
- データ管理チームが、地理的な場所ごとに分散されている。 

コレクション階層は、次の垂直要素で構成されます。 

- ルート コレクション (既定)
- FourthCoffee (最上位コレクション)
- 地理的な場所 (データ ソースとデータ所有者が配置されている地理的な場所に基づく中間レベルのコレクション)
- 部署 (各部門のデリゲートされたコレクション) 
- チームまたはプロジェクト (チームまたはプロジェクトに基づいてさらに分離)

このシナリオでは、Purview アカウントの最上位コレクションの下に、リージョンごとの独自のサブコレクションがあります。 データ ソースは、独自の地理的な場所の対応するサブコレクションで登録およびスキャンされます。 そのため、資産もそのリージョンのサブコレクション階層に表示されます。 

集中型のデータ管理およびガバナンス チームがある場合は、最上位コレクションからアクセス権をそれらに付与できます。 それを行うと、データ マップ内のデータ資産全体を監視できます。 必要に応じて、集中型チームで共有データ ソースの登録とスキャンを行うことができます。

リージョン ベースのデータ管理およびガバナンス チームは、下位レベルの対応するコレクションからアクセス権を取得できます。

部署レベルの共有データ ソースは、部署コレクションで登録およびスキャンされます。 

:::image type="content" source="media/concept-best-practices/collections-example-2.png" alt-text="2 番目の Azure Purview コレクションの例を示すスクリーンショット。"lightbox="media/concept-best-practices/collections-example-2.png":::

### <a name="example-3-multiregion-data-transformation"></a>例 3: 複数リージョン、データ変換

このシナリオは、地理的な場所とデータ変換の状態に基づいてメタデータのアクセス管理を分散させる場合に便利です。 より意味のあるものにするためにデータを変換できるデータ科学者やデータ エンジニアは、生ゾーンと調整ゾーンを管理できます。 その後、データを生成ゾーンまたはキュレーション ゾーンに移動できます。  

コレクション階層は、次の垂直要素で構成されます。 

- ルート コレクション (既定)
- Fabrikam (最上位コレクション)
- 地理的な場所 (データ ソースとデータ所有者が配置されている地理的な場所に基づく中間レベルのコレクション)
- データ変換ステージ (生、調整、生成、キュレーション) 

データ科学者とデータ エンジニアは、対応するゾーンにデータ キュレーター ロールを作成して、メタデータをキュレーションできます。 キュレーション ゾーンへのデータ閲覧者のアクセス権は、データ ペルソナとビジネス ユーザー全体に付与できます。 

:::image type="content" source="media/concept-best-practices/collections-example-3.png" alt-text="3 番目の Azure Purview コレクションの例を示すスクリーンショット。"lightbox="media/concept-best-practices/collections-example-3.png":::

### <a name="example-4-multiregion-business-functions"></a>例 4: 複数リージョン、ビジネス機能 

このオプションは、ビジネス機能に基づいてメタデータとアクセス管理を整理する必要がある組織によって使用できます。

コレクション階層は、次の垂直要素で構成されます。 

- ルート コレクション (既定)
- AdventureWorks (最上位コレクション)
- 地理的な場所 (データ ソースとデータ所有者が配置されている地理的な場所に基づく中間レベルのコレクション)
- 主要なビジネス機能またはクライアント (機能またはクライアントに基づいてさらに分離)

Purview アカウントの最上位コレクションの下に、リージョンごとの独自のサブコレクションがあります。 データ ソースは、独自の地理的な場所の対応するサブコレクションで登録およびスキャンされます。 そのため、資産はそのリージョンのサブコレクション階層に追加されます。 

集中型のデータ管理およびガバナンス チームがある場合は、最上位コレクションからアクセス権をそれらに付与できます。 それを行うと、データ マップ内のデータ資産全体を監視できます。 必要に応じて、集中型チームで共有データ ソースの登録とスキャンを行うことができます。

リージョン ベースのデータ管理およびガバナンス チームは、下位レベルの対応するコレクションからアクセス権を取得できます。
各事業単位には、独自のサブコレクションがあります。

:::image type="content" source="media/concept-best-practices/collections-example-4.png" alt-text="4 番目の Azure Purview コレクションの例を示すスクリーンショット。"lightbox="media/concept-best-practices/collections-example-4.png":::

## <a name="access-management-options"></a>アクセス管理のオプション

組織全体にデータの民主化を実装する場合は、最上位コレクションのデータ閲覧者ロールをデータ管理、ガバナンス、およびビジネス ユーザーに割り当てます。 サブコレクション レベルのデータ ソース管理者とデータ キュレーターのロールを、対応するデータ管理およびガバナンス チームに割り当てます。

組織内でメタデータの検索と探索へのアクセスを制限する必要がある場合は、特定のコレクション レベルでデータ閲覧者とデータ キュレーターのロールを割り当てます。 たとえば、米国の従業員は US コレクション レベルでのみデータを読み取ることができ、LATAM コレクションではできないように、制限することができます。 

一部のコレクションに対するいくつかの例外を除き、全体のデータ民主化が必要な場合は、これら 2 つのシナリオの組み合わせを Purview データ マップで適用できます。 最上位コレクションで Purview ロールを割り当てて、特定の子コレクションに継承を制限できます。

最上位コレクションで集中型のデータ セキュリティおよび管理チームにコレクション管理者ロールを割り当てます。 下位レベルのコレクションのコレクション管理を、対応するチームにさらにデリゲートします。

## <a name="next-steps"></a>次のステップ
-  [Purview でコレクションを作成してアクセス許可を割り当てる](./quickstart-create-collection.md)
-  [Azure Purview でコレクションを作成および管理する](./how-to-create-and-manage-collections.md)
-  [Azure Purview でのアクセスの制御](./catalog-permissions.md)
