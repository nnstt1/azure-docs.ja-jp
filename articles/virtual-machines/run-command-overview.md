---
title: 実行コマンドを使用して Azure の Windows または Linux VM でスクリプトを実行する
description: このトピックでは、実行コマンド機能を使用して Azure 仮想マシン内でスクリプトを実行する方法の概要を説明します
ms.service: virtual-machines
author: cynthn
ms.author: cynthn
ms.date: 10/27/2021
ms.topic: how-to
ms.reviewer: jushiman
ms.custom: devx-track-azurepowershell
ms.openlocfilehash: 0442c97e07e89238bed6b670c1529a862ddb1ab0
ms.sourcegitcommit: 702df701fff4ec6cc39134aa607d023c766adec3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/03/2021
ms.locfileid: "131477956"
---
# <a name="run-scripts-in-your-vm-by-using-run-command"></a>実行コマンドを使用してお使いの VM でスクリプトを実行する

実行コマンドでは、仮想マシン (VM) エージェントを使用して、Azure Windows または Linux VM 内でスクリプトを実行します。 これらのスクリプトは、マシンやアプリケーションの一般的な管理に使用できます。 これらを使用すれば、VM のアクセスおよびネットワークの問題を迅速に診断して修正し、VM を良好な状態に戻すことができます。 スクリプトは、プロパティに埋め込むことができます。また、事前に公開されたギャラリー スクリプトを参照することもできます。 


元のコマンドのセットは、アクション指向です。 現在パブリック プレビュー段階にある更新されたコマンドのセットは管理指向であり、これを使用して複数のスクリプトを実行でき、制限も少なくなっています。 この記事では、2 つの実行コマンドのセットの違いについて説明し、実際のシナリオで使用するのに適切なセットを決定するのを支援します。  

> [!IMPORTANT]
> **マネージド実行コマンド** は、現在パブリック プレビュー段階にあります。
> このプレビュー バージョンはサービス レベル アグリーメントなしで提供されており、運用環境のワークロードに使用することは推奨されません。 特定の機能はサポート対象ではなく、機能が制限されることがあります。 詳しくは、[Microsoft Azure プレビューの追加使用条件](https://azure.microsoft.com/support/legal/preview-supplemental-terms/)に関するページをご覧ください。


## <a name="when-to-use-action-or-managed-commands"></a>アクション コマンドまたはマネージド コマンドを使用する状況

元のコマンドのセットは、アクション指向です。 以下を実行する必要がある状況では、このコマンドのセットの使用を検討する必要があります。
- VM からコンテンツを取得するための小さなスクリプト 
- VM を構成するためのスクリプト (レジストリ キーの設定、構成の変更) 
- 診断用の 1 回限りのスクリプト

使用可能なアクション コマンドとその適用方法については、[Linux 用のアクション実行コマンド](./linux/run-command.md)および [Windows 用のアクション実行コマンド](./windows/run-command.md)に関するページを参照してください。 

現在パブリック プレビュー段階にある更新されたコマンドのセットは、管理指向です。 ニーズが次の例に一致する場合は、マネージド実行コマンドの使用を検討してください。
- スクリプトを VM デプロイの一部として実行する必要がある 
- スクリプトを繰り返し実行する必要がある 
- 複数のスクリプトを順番に実行する必要がある 
- インストール スクリプトを実行して VM をブートストラップする 
- 共有および再利用するカスタム スクリプトを公開する 

これらの使用方法については、[Linux 用のマネージド実行コマンド](./linux/run-command-managed.md)および [Windows 用のマネージド実行コマンド](./windows/run-command-managed.md)に関するページを参照してください。


## <a name="compare-feature-support"></a>機能のサポートを比較する

| 機能サポート  | アクション RunCommand  | マネージド RunCommand  |
|---|---|---|
| ARM テンプレート  | なし。POST アクションです  | あり。リソースの種類です  |
| 長時間実行  | 90 分の制限  | 顧客が指定したタイムアウト  |
| 実行アカウント  | システム アカウントまたはルート  | 顧客が指定したユーザー  |
| 複数の実行コマンド  | 1 つだけアクティブ  | 並列または順序付けされた複数  |
| 大きな出力  | 4k に制限 (状態 BLOB 内)  | 顧客が追加した BLOB にアップロード  |
| 進行状況の追跡  | 最終的な状態のみを報告  | 実行中の進行状況と最後の 4k 出力を報告  |
| 非同期実行  | 目標の状態またはプロビジョニングは、スクリプトが完了するまで待機  | 顧客が指定した非同期フラグにより、プロビジョニングがスクリプトを待機するかどうかを示す  |
| 仮想マシン スケール セットのサポート  | VM インスタンスでのみ  | 仮想マシンのスケール セット モデルとスケールアウトをサポート  |
| SAS の生成  | BLOB のサポートなし  | 自動化された CRP により、顧客 BLOB 用に SAS が生成および管理される  |
| ギャラリー (カスタム コマンド)  | 組み込みの commandId のみ  | 顧客がスクリプトを公開して共有できる  |


## <a name="next-steps"></a>次の手順

[Linux 用のマネージド実行コマンド](./linux/run-command-managed.md)または [Windows 用のマネージド実行コマンド](./windows/run-command-managed.md)から始めましょう。 