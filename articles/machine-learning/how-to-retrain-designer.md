---
title: パイプライン パラメーターを使用し、デザイナーのモデルを再トレーニングする
titleSuffix: Azure Machine Learning
description: 発行されたパイプラインとパイプライン パラメーターを使用して Azure Machine Learning デザイナーでモデルを再トレーニングします。
services: machine-learning
ms.service: machine-learning
ms.subservice: mlops
ms.author: keli19
author: likebupt
ms.date: 10/21/2021
ms.topic: how-to
ms.custom: designer
ms.openlocfilehash: 6b79b80f666019cb5a8a59901bf12e9277287a12
ms.sourcegitcommit: e41827d894a4aa12cbff62c51393dfc236297e10
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/04/2021
ms.locfileid: "131557416"
---
# <a name="use-pipeline-parameters-to-retrain-models-in-the-designer"></a>パイプライン パラメーターを使用し、デザイナーのモデルを再トレーニングする


このハウツー記事では、Azure Machine Learning デザイナーでパイプライン パラメーターを使用して機械学習モデルを再トレーニングする方法について説明します。 発行されたパイプラインを使用してワークフローを自動化し、パラメーターを設定して新しいデータに対してモデルをトレーニングします。 パイプライン パラメーターを使用すると、異なるジョブに対して既存のパイプラインを再利用できます。  

この記事では、次のことについて説明します。

> [!div class="checklist"]
> * 機械学習モデルをトレーニングする。
> * パイプライン パラメーターを作成する。
> * トレーニング パイプラインを発行する。
> * 新しいパラメーターを使用してモデルを再トレーニングします。

## <a name="prerequisites"></a>前提条件

* Azure Machine Learning ワークスペース
* この操作方法シリーズのパート 1、[デザイナーでのデータの変換](how-to-designer-transform-data.md)に関する記事を完了してください

[!INCLUDE [machine-learning-missing-ui](../../includes/machine-learning-missing-ui.md)]

また、この記事では、デザイナーでのパイプラインの構築に関する知識を持っていることも前提としています。 ガイド付きの概要については、[チュートリアル](tutorial-designer-automobile-price-train-score.md)を完了してください。 

### <a name="sample-pipeline"></a>サンプル パイプライン

この記事で使用されているパイプラインは、デザイナーのホームページにある、サンプル パイプライン「[収入の予測](samples-designer.md#classification)」の変更されたバージョンです。 サンプル データセットではなく[データのインポート](algorithm-module-reference/import-data.md) コンポーネントをパイプラインに使用して、独自のデータを利用してモデルをトレーニングする方法を示します。

![データのインポート コンポーネントが強調表示されているボックスがある、変更されたサンプル パイプラインを示すスクリーンショット](./media/how-to-retrain-designer/modified-sample-pipeline.png)

## <a name="create-a-pipeline-parameter"></a>パイプライン パラメーターを作成する

パイプライン パラメーターは、後でさまざまなパラメーター値を使用して再送信できる汎用性のあるパイプラインを作成するために使用します。 いくつかの一般的なシナリオでは、再トレーニング用にデータセットまたは一部のハイパーパラメーターを更新します。 パイプライン パラメーターを作成して実行時に変数を動的に設定します。 

パイプライン パラメーターは、パイプラインのデータ ソースまたはコンポーネント パラメーターに追加できます。 パイプラインを再送信するときに、これらのパラメーターの値を指定できます。

この例では、トレーニング データ パスを固定値からパラメーターに変更し、別のデータに対してモデルを再トレーニングできるようにします。 ユースケースに応じて、パイプライン パラメーターとして他のコンポーネント パラメーターを追加することもできます。

1. **[データのインポート]** コンポーネントを選択します。

    > [!NOTE]
    > この例では、[データのインポート] コンポーネントを使用して、登録済みデータストアのデータにアクセスします。 ただし、代替のデータ アクセス パターンを使用する場合は、同様の手順を実行できます。

1. コンポーネントの詳細ペインで、キャンバスの右側にあるデータ ソースを選択します。

1. データのパスを入力します。 また、 **[パスの参照]** を選択してファイル ツリーを参照することもできます。 

1. **[パス]** フィールドにマウスを置き、表示される **[パス]** フィールドの上にある省略記号 (...) を選択します。

1. **[Add to pipeline parameter]\(パイプライン パラメーターに追加する\)** を選択します。

1. パラメーター名と既定値を指定します。

   ![パイプライン パラメーターの作成方法を示すスクリーンショット](media/how-to-retrain-designer/add-pipeline-parameter.png)

1. **[保存]** を選択します。

   > [!NOTE]
   > また、コンポーネントの詳細ペインでパイプライン パラメーターからコンポーネント パラメーターをデタッチすることもできます。これは、パイプライン パラメーターの追加と似ています。
   >
   > パイプライン ドラフトのタイトルの横にある **[設定]** の歯車アイコンを選択すると、パイプライン パラメーターを調べて編集することができます。 
   >    - デタッチした後、 **[設定]** ペインでパイプライン パラメーターを削除できます。
   >    - また、 **[設定]** ペインでパイプライン パラメーターを追加し、一部のコンポーネント パラメーターに適用することもできます。

1. パイプラインの実行を送信します。

## <a name="publish-a-training-pipeline"></a>トレーニング パイプラインを発行する

パイプラインをパイプライン エンドポイントに発行して、後で簡単にパイプラインを再利用できるようにします。 後でパイプラインを呼び出すことができるように、パイプライン エンドポイントを使用して REST エンドポイントを作成することができます。 この例では、パイプライン エンドポイントを使用して、パイプラインを再利用し、異なるデータに対してモデルを再トレーニングできます。

1. デザイナー キャンバス上の **[Publish] (発行)** を選択します。
1. パイプライン エンドポイントを選択するか作成します。

   > [!NOTE]
   > 複数のパイプラインを単一のエンドポイントに発行できます。 特定のエンドポイント内の各パイプラインにはバージョン番号が付けられます。パイプライン エンドポイントを呼び出すときに、この番号を指定できます。

1. **[発行]** を選択します。

## <a name="retrain-your-model"></a>モデルを再トレーニングする

これでトレーニング パイプラインが発行されたので、それを利用し、新しいデータに対してモデルを再トレーニングできます。 パイプライン エンドポイントから実行を送信するには、studio ワークスペースまたはプログラムを使用します。

### <a name="submit-runs-by-using-the-studio-portal"></a>Studio ポータルを使用した実行の送信

以下の手順を使用して、Studio ポータルからパラメーター化されたパイプライン エンドポイントの実行を送信します。

1. studio ワークスペースの **[エンドポイント]** ページに移動します。
1. **[パイプライン エンドポイント]** タブを選択します。次に、パイプライン エンドポイントを選択します。
1. **[Published pipelines] (公開済みパイプライン)** タブを選択します。次に、実行するパイプラインのバージョンを選択します。
1. **[Submit]\(送信\)** をクリックします。
1. 設定ダイアログ ボックスで、実行のパラメーター値を指定できます。 この例では、データ パスを更新して、米国以外のデータセットを使用してモデルをトレーニングします。

![パラメーター化されたパイプラインの実行をデザイナーで設定する方法を示すスクリーンショット](./media/how-to-retrain-designer/published-pipeline-run.png)

### <a name="submit-runs-by-using-code"></a>コードを使用して実行を送信する

概要パネルには、発行されたパイプラインの REST エンドポイントが表示されます。 エンドポイントを呼び出すことにより、発行されたパイプラインを再トレーニングできます。

REST 呼び出しを行うには、OAuth 2.0 ベアラー型認証ヘッダーが必要です。 ワークスペースへの認証を設定し、パラメーター化された REST 呼び出しを行う方法の詳細については、「[バッチ スコアリング用の Azure Machine Learning パイプラインを作成する](tutorial-pipeline-batch-scoring-classification.md#publish-and-run-from-a-rest-endpoint)」を参照してください。

## <a name="next-steps"></a>次のステップ

この記事では、デザイナーを使用してパラメーター化されたトレーニング パイプライン エンドポイントを作成する方法について説明しました。

モデルをデプロイして予測を行う方法の詳細なチュートリアルについては、[デザイナーのチュートリアル](tutorial-designer-automobile-price-train-score.md)を参照して回帰モデルをトレーニングおよびデプロイしてください。

SDK を使用してパイプライン エンドポイントを発行し、それに対して実行を送信する方法については、[こちらの記事](how-to-deploy-pipelines.md)を参照してください。
