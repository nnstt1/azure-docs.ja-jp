---
title: Oracle BareMetal インフラストラクチャ サーバーのオプション
description: Oracle BareMetal インフラストラクチャ サーバーのオプションと考慮事項について説明します。
ms.topic: reference
ms.subservice: baremetal-oracle
ms.date: 10/12/2021
ms.openlocfilehash: 0c4442910ed40ece8147bca919039a7c4564a4f7
ms.sourcegitcommit: 611b35ce0f667913105ab82b23aab05a67e89fb7
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/14/2021
ms.locfileid: "129999589"
---
# <a name="options-for-oracle-baremetal-infrastructure-servers"></a>Oracle BareMetal インフラストラクチャ サーバーのオプション

この記事では、BareMetal インフラストラクチャ サーバーで Oracle を実行する際に最高レベルの保護とパフォーマンスを実現するためのオプションと推奨事項について説明します。 

## <a name="data-guard-protection-modes"></a>Data Guard の保護モード

Data Guard は、Oracle Real Applications Cluster (RAC)、論理レプリケーション (GoldenGate など)、およびストレージベースのレプリケーションのみでは実現できない保護を提供します。 

| 保護モード | 説明 |
| --- | --- |
| **最大パフォーマンス** | 既定の保護モードです。 プライマリ データベースのパフォーマンスに影響を与えることなく、最高レベルの保護を提供します。 データは、プライマリ データベースの再実行ストリームに書き込まれるとすぐにコミットされたと見なされます。 その後、スタンバイ データベースに非同期でレプリケートされます。 通常、スタンバイ データベースは数秒以内にそれを受信しますが、それが保証されている訳ではありません。 このモードは通常、プライマリとスタンバイのサイト間に低待機時間のネットワーク接続を必要とせずに、ビジネス要件を (遅延監視と同時に) 満たします。<br /><br />これにより、運用上の最適な持続性が実現されますが、データ消失をゼロに抑えることは保証されません。   |
| **最大可用性** | プライマリ データベースの可用性に影響を与えることなく、最高レベルの保護を提供します。 データは、少なくとも 1 つのスタンバイ データベースにコミットされるまで、プライマリ データベースでコミットされたとは見なされません。 プライマリ データベースで、少なくとも 1 つのスタンバイ データベースに再実行の変更を書き込むことができない場合は、使用できなくなるのではなく、最大パフォーマンス モードに戻ります。 <br /><br />これにより、スタンバイ サイトが使用できなくなった場合でもサービスを続行できます。 1 つのサイトのみが動作している場合、2 つ目のサイトがオンラインになり、同期が再確立されるまで、データのコピーは 1 つのみ保持されます。 |
| **最大保護** | 最大可用性と同様の保護レベルを提供します。 少なくとも 1 つのスタンバイ データベースに再実行の変更を書き込むことができない場合、プライマリ データベースは追加された機能を使用してシャットダウンします。 これにより、データの損失を防ぐことができますが、可用性が低下します。 |

>[!IMPORTANT]
>回復ポイントの目標 (RPO) をゼロにする必要がある場合は、最大可用性の構成をお勧めします。 そうすれば、複数の障害が発生した場合でも RPO を保証できます。 たとえば、プライマリ データベースのネットワークが停止した後、しばらくしてから、まだネットワーク障害が続いている間にプライマリ データベースが失われる場合などです。

### <a name="data-guard-deployment-patterns"></a>Data Guard のデプロイ パターン

Oracle では、複数のスタンバイ データベースを使用できるように、再実行の生成で複数の宛先を構成することができます。 最も一般的な構成は、次の図に示すように、異なるリージョンの 1 つのスタンバイ データベースです。

:::image type="content" source="media/oracle-high-availability/default-data-guard-deployment.png" alt-text="Oracle の既定の Data Guard デプロイを示す図。":::

Data Guard は、既定のデプロイでは最大パフォーマンス モードで構成されています。 この構成は、非同期の再実行転送を使用して、ほぼリアルタイムのデータ レプリケーションを提供します。 スタンバイ データベースは、RAC のデプロイ内で実行する必要はありません。 ただし、スタンバイ データベースではプライマリ サイトのパフォーマンス要求を満たすようにすることをお勧めします。

厳密なアップタイムや RPO ゼロを要求される環境では、次の図に示すようなデプロイをお勧めします。 最大可用性の構成は、次で構成されます。
- 同期モードで再実行を適用するローカル スタンバイ データベース。
- リモート リージョンで実行されている 2 つ目のスタンバイ データベース。

:::image type="content" source="media/oracle-high-availability/max-availability-data-guard-deployment.png" alt-text="最大可用性の Data Guard デプロイを示す図。":::

データベースとアプリケーション サーバーを別々のリージョンで実行することでアプリケーションのパフォーマンスが低下する場合に、ローカル スタンバイ データベースを作成できます。 プライマリ クラスターで計画済みまたは計画外のメンテナンスが必要な場合に、ローカル スタンバイ データベースが使用されます。 これらのデータベースは同じリージョンにあるため、同期レプリケーションを使用して実行することで、データが失われないようにすることができます。

### <a name="data-guard-configuration-considerations"></a>Data Guard の構成に関する考慮事項

Data Guard Broker を実装する必要があります。これにより、Data Guard の構成の実装が簡略化され、ベスト プラクティスに確実に準拠できます。 パフォーマンスの監視機能が提供され、またスイッチオーバー、フェールオーバー、および再インスタンス化の手順が大幅に簡略化されます。

Data Guard では、データガード構成内のすべてのデータベースを監視するオブザーバー プロセスを実行して、データベースの可用性を判断できます。 プライマリ データベースで障害が発生した場合、Data Guard オブザーバーは、構成内のスタンバイ データベースへのフェールオーバーを自動的に開始できます。 Data Guard オブザーバーは、物理サイトの数に基づいて複数のオブザーバーで実装できます (最大 3 つ)。 

このオブザーバーは、アプリケーション層をサポートするインフラストラクチャに配置する必要があります。 プライマリ オブザーバーは、常にプライマリ データベースが配置されていない物理サイトに存在している必要があります。 Data Guard オブザーバーによってトリガーされるフェールオーバー操作の自動化には注意が必要です。 まず、データベースが別の場所で実行されている場合に、アプリケーションが適切なサービスを提供するように設計およびテストされていることを確認します。

アプリケーションがローカルでしか動作できない場合は、セカンダリ サイトへのフェールオーバーを手動で行う必要があります。 高可用性レベル (99.99% または99.999% のアップタイム) を必要とする環境では、前の図に示すように、ローカルとリモートの両方のスタンバイデータベースを使用する必要があります。 このような場合、FastStartFailoverTarget パラメーターはローカル スタンバイ データベースにのみ設定されます。

クロスサイト アプリケーションまたはデータベースへのアクセスをサポートするすべてのアプリケーションについては、FastStartFailoverTarget は Data Guard 構成内のすべてのスタンバイ データベースに設定されます。

### <a name="active-data-guard"></a>Active Data Guard

Oracle Active Data Guard (ADG) は、Oracle Database Enterprise Edition に含まれる基本的な Data Guard 機能のスーパーセットです。 Oracle Exadata のデプロイ全体で使用される次の機能が追加されています。

- 独自の破損検出と自動修復。
- 実稼働環境の同期されたレプリカへの迅速なフェールオーバー (手動または自動)。
- 同期されたスタンバイ オープン読み取り専用への実稼働ワークロードのオフロード。
- データベースのローリング アップグレードとスタンバイ。 物理スタンバイを使用した最初のパッチ適用。
- 増分バックアップをスタンバイにオフロード。
- パフォーマンスに影響を与えない、任意の距離でのデータ損失ゼロのデータ復旧保護。

[https://www.oracle.com/technetwork/database/availability/dg-adg-technical-overview-wp-5347548.pdf](https://www.oracle.com/technetwork/database/availability/dg-adg-technical-overview-wp-5347548.pdf) から入手できるホワイトペーパーに、次の図に示す前述の機能の概要が示されています。

:::image type="content" source="media/oracle-high-availability/active-data-guard-features.png" alt-text="Oracle の Active Data Guard 機能の概要を示す図。":::

## <a name="backup-recommendations"></a>バックアップに関する推奨事項

データベースは必ずバックアップしてください。 復元と復旧の機能を使用して、データベースを同じまたは別のシステムに復元するか、データベース ファイルを復旧します。

Oracle Database Appliance データベースをデータ損失から保護するために、バックアップ復旧戦略を策定することが重要です。 このような損失は、データベースの実行に必要なディスク ファイルの読み取りまたは書き込みの失敗につながるディスクの物理的な問題が原因で発生する可能性があります。 ユーザー エラーによってデータが失われることもあります。 バックアップ機能を使用すると、**ポイントインタイム リストア (PITR) によるデータベースの復元、システム変更番号 (SCN) 復元、および最新の復元** を行うことができます。 バックアップ ポリシーは、ブラウザーのユーザー インターフェイスまたはコマンドライン インターフェイスで作成できます。

次のバックアップ オプションを使用できます。

- NFS ストレージ ボリューム (高速リカバリ領域 (FRA) /u98) へのバックアップ。
- Azure NetApp Files SnapCenter の使用 – スナップショット。

次のプロセスを考慮してください。

- 手動または自動のバックアップ。
- 自動バックアップは、NFS ストレージボリューム (たとえば、/u98) に書き込まれます。
- バックアップは、データベース システムのタイム ゾーンで午前 12 時から午前 6 時の間に実行されます。
- 保有期間 (7、15、30、45、および 60 日) を提示します。

- オブジェクト ストレージに格納されているバックアップからデータベースを復旧します。
  - データ損失の可能性が最も低い最後の正常な状態まで。
  - 指定されたタイムスタンプを使用。
  - 指定された SCN を使用。
  - BackupReport – _指定された SCN ではなく、バックアップ レポートの SCN を使用_。

:::image type="content" source="media/oracle-high-availability/customer-db-backup-to-fra.png" alt-text="顧客データベースの FRA (/u98) と非 FRA (/u95) へのバックアップを示す図。":::

### <a name="backup-policy"></a>バックアップ ポリシー

バックアップ ポリシーには、バックアップの詳細が定義されます。 バックアップ ポリシーを作成するときに、データベース バックアップのコピー先 FRA (NFS の場所) を定義し、復旧ウィンドウを定義します。

既定では、BASIC 圧縮アルゴリズムが使用されます。 ディスクまたは NFS のバックアップ ポリシーに LOW、MEDIUM、または HIGH の高圧縮アルゴリズムを使用する場合は、ライセンスに関する考慮事項があります。

### <a name="backup-levels"></a>バックアップ レベル

バックアップを作成するときに、バックアップ レベルを指定します。

- レベル 0 - 完全
- レベル 1 – 増分
- LongTerm/Archievelog - バックアップの保持ポリシーを除き、FRA 以外の場所 (たとえば、/u95) を使用します。

## <a name="next-steps"></a>次のステップ

障害が発生したときに Oracle データベースを復旧する方法について確認します。

> [!div class="nextstepaction"]
> [Azure BareMetal インフラストラクチャで Oracle データベースを復旧する](oracle-high-availability-recovery.md)
