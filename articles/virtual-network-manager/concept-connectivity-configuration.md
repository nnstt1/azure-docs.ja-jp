---
title: Azure Virtual Network Manager の接続構成 (プレビュー)
description: Azure Virtual Network Manager の接続設定で作成できる、さまざまな種類のネットワーク トポロジについて説明します。
author: duongau
ms.author: duau
ms.service: virtual-network-manager
ms.topic: conceptual
ms.date: 11/02/2021
ms.custom: template-concept, ignite-fall-2021
ms.openlocfilehash: bf7adbb0fd54243e71f6e313892f3f418071c217
ms.sourcegitcommit: 0415f4d064530e0d7799fe295f1d8dc003f17202
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/17/2021
ms.locfileid: "132719170"
---
# <a name="connectivity-configuration-in-azure-virtual-network-manager-preview"></a>Azure Virtual Network Manager の接続構成 (プレビュー)

このアーティクルでは、Azure Virtual Network Manager を使用して作成しデプロイできるさまざまな種類の構成について説明します。 現在使用できる構成には、*接続性* と *セキュリティ管理者* の 2 種類があります。 

> [!IMPORTANT]
> 現在、Azure Virtual Network Manager は、パブリック プレビュー段階です。
> このプレビュー バージョンはサービス レベル アグリーメントなしで提供されています。運用環境のワークロードに使用することはお勧めできません。 特定の機能はサポート対象ではなく、機能が制限されることがあります。
> 詳しくは、[Microsoft Azure プレビューの追加使用条件](https://azure.microsoft.com/support/legal/preview-supplemental-terms/)に関するページをご覧ください。

## <a name="connectivity-configuration"></a>接続性の構成

*接続性* を使用すると、ネットワークのニーズに応じてさまざまなネットワーク トポロジを作成できます。 トポロジは *メッシュ ネットワーク* と *ハブ アンド スポーク* の 2 種類から選択できます。 仮想ネットワーク間の接続性は、構成設定内で定義されます。

## <a name="mesh-network-topology"></a>メッシュ ネットワーク トポロジ

メッシュ ネットワークは、[ネットワーク グループ](concept-network-groups.md)のすべての仮想ネットワークが互いに接続されているトポロジです。 すべての仮想ネットワークが接続され、双方向にトラフィックを渡す可能性があります。 既定では、メッシュはリージョン メッシュであるため、同じリージョン内の仮想ネットワークだけが相互に通信できます。 **グローバル メッシュ** を有効にすると、すべての Azure リージョン間で仮想ネットワークの接続を確立できます。 仮想ネットワークは、最大で 5 つの接続されたグループに属することができます。 仮想ネットワーク アドレス空間が構成内で重複できないか、ネットワークの競合のためにリソースが相互に通信できません。

:::image type="content" source="./media/concept-configuration-types/mesh-topology.png" alt-text="ネットワーク トポロジの図。":::

### <a name="connected-group"></a><a name="connectedgroup"></a> 接続されているグループ

メッシュ トポロジを作成すると、*接続されているグループ* という新しい接続構造が作成されます。 接続されたグループ内の仮想ネットワークは、仮想ネットワークを手動で接続する場合と同様に、相互に通信できます。 ネットワーク インターフェイスの有効なルートを確認すると、ネクスト ホップの種類として **ConnectedGroup** が表示されます。 接続されたグループ内で接続されている仮想ネットワークには、*ピアリング* に仮想ネットワークのピアリング設定が記載されていません。

> [!NOTE]
> * 2 つ以上の仮想ネットワークでサブネットが競合している場合、それらのサブネットのリソースは、同じメッシュ ネットワークに属していても相互に通信 *できません*。
> * 仮想ネットワークは、最大で **2 つ** のメッシュ構成に属することができます。

## <a name="hub-and-spoke-topology"></a>ハブとスポークのトポロジ

ハブ アンド スポークは、仮想ネットワークがハブ仮想ネットワークとして選択されているネットワーク トポロジです。 この仮想ネットワークは、構成内のすべてのスポーク仮想ネットワークと双方向にピアリングされます。 このトポロジは、仮想ネットワークを分離し、ハブ仮想ネットワーク内の共通リソースに接続する必要がある場合に便利です。 

この構成では、スポーク仮想ネットワーク間の *直接接続* など、有効にできる設定があります。 既定では、この接続性は同じリージョン内の仮想ネットワークにのみ適用されます。 異なる Azure リージョン間の接続を許可するには、*グローバル メッシュ* を有効にする必要があります。 また、*ゲートウェイ* 転送を有効にすると、スポーク仮想ネットワークがハブに導入された VPN または ExpressRoute のゲートウェイを使用できるようになります。

### <a name="direct-connectivity"></a>直接接続

*直接接続* を有効にすると、同じリージョンのスポーク仮想ネットワークを含む [*接続グループ*](#connectedgroup)が作成されます。 この接続は、同じネットワーク グループ内の仮想ネットワークに対してのみ確立されます。 

たとえば、2 つのネットワーク グループを作成します。 *Production* ネットワーク グループでは直接接続を有効にしますが、*Test* ネットワーク グループでは有効にしません。 この設定では、*Production* ネットワーク グループの仮想ネットワークは相互に通信できますが、*Test* ネットワーク グループの仮想ネットワークは通信できません。 

下の図の例を参照してください。

:::image type="content" source="./media/concept-configuration-types/hub-and-spoke.png" alt-text="2 つのネットワーク グループを含むハブ アンド スポーク トポロジの図。":::

VM 上の有効なルートを確認すると、ハブ アンド スポーク仮想ネットワーク間のルートは、ネクスト ホップの種類が *VNetPeering* または *GlobalVNetPeering* となっています。 スポーク仮想ネットワーク間のルートは、*ConnectedGroup* のネクスト ホップの種類で表示されます。 上記の例では、*Production* ネットワーク グループのみが *直接接続* を有効にしているため、*ConnectedGroup* を持ちます。

> [!NOTE]
> *直接接続* が **有効** である場合、*ConnectedGroup* にハブのネットワーク アドレス空間が追加されます。 そのため、ハブ アンド スポーク仮想ネットワークの間の仮想ネットワーク ピアリングが失敗した場合でも *ConnectedGroup* によって通信できます。

#### <a name="use-cases"></a>ユース ケース

スポーク仮想ネットワーク間の直接接続を有効にすると、ハブ仮想ネットワークに NVA または共通のサービスを使用するが、ハブに常にアクセスする必要はない場合に役立ちます。 ただし、ネットワーク グループ内のスポーク仮想ネットワークが相互に通信する必要があります。 このトポロジは、従来のハブ アンド スポーク ネットワークと比較して、ハブ仮想ネットワーク経由の余分なホップを排除することでパフォーマンスを向上させます。

### <a name="global-mesh"></a>グローバル メッシュ

グローバル メッシュは、スポーク仮想ネットワークがリージョンを超えて相互に通信する場合に必要です。 この接続は、同じネットワーク グループ内の仮想ネットワークに限定されます。 リージョン間の仮想ネットワークの接続を有効にするには、ネットワーク グループの **リージョン間のメッシュ接続を有効にする** 必要があります。 スポーク仮想ネットワーク間に作成された接続は、[*接続グループ*](#connectedgroup)内に含まれます。 

### <a name="use-hub-as-a-gateway"></a>ハブをゲートウェイとして使用する

ハブアンドスポーク構成で有効にできるもう 1 つのオプションは、ハブをゲートウェイとして使用する方法です。 この設定により、ネットワーク グループ内のすべての仮想ネットワークが、ハブ仮想ネットワーク内の VPN または ExpressRoute ゲートウェイを介してトラフィックを渡すことを許可します。 [ゲートウェイとオンプレミスの接続](../virtual-network/virtual-network-peering-overview.md#gateways-and-on-premises-connectivity)を参照してください。

Azure portal からハブ アンド スポーク トポロジをデプロイすると、ネットワーク グループ内のスポーク仮想ネットワークに対して、**ハブをゲートウェイとして使用する** が規定で有効になります。 Azure Virtual Network Manager は、リソース グループ内のハブ アンド スポーク仮想ネットワークの間に仮想ネットワーク ピアリング接続を作成します。 ゲートウェイがハブ仮想ネットワークに存在しない場合、スポーク仮想ネットワークからハブへのピアリング作成は失敗します。 ハブからスポークへのピアリング接続は、確立された接続なしで作成されます。 

> [!NOTE]
> スポーク ネットワーク グループに対して *直接接続* を有効にした場合、ハブも接続グループに含まれます。 そのため、スポークからハブへのピアリング接続が作成されていない場合でも、スポーク仮想ネットワークは接続グループを介してハブ仮想ネットワークと通信できます。
>

## <a name="next-steps"></a>次のステップ

- [Azure Virtual Network Manager](create-virtual-network-manager-portal.md) インスタンスを作成します。
- Azure Virtual Network Manager での[構成のデプロイ](concept-deployments.md)について説明します。
- [SecurityAdmin 構成](how-to-block-network-traffic-portal.md)を使用してネットワーク トラフィックをブロックする方法を学びます。