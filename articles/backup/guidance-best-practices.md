---
title: ガイダンスとベスト プラクティス
description: クラウドとオンプレミスのワークロードをクラウドにバックアップするためのベストプラクティスとガイダンスについて説明します
ms.topic: conceptual
ms.date: 07/22/2020
ms.openlocfilehash: 462b71170bbd0534a15a54f0eacc53ff08e09f69
ms.sourcegitcommit: 702df701fff4ec6cc39134aa607d023c766adec3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/03/2021
ms.locfileid: "131439388"
---
# <a name="backup-cloud-and-on-premises-workloads-to-cloud"></a>クラウドとオンプレミスのワークロードをクラウドにバックアップする

## <a name="introduction"></a>はじめに

Azure Backup では、インフラストラクチャのデプロイと管理を必要としないシンプルで安全かつコスト効率に優れたソリューションを通じて、Azure のデータ資産を包括的に保護します。 これは、さまざまなワークロードに対応した Azure の組み込みデータ保護ソリューションです。 これにより、クラウドで実行されているミッション クリティカルなワークロードを保護し、常にバックアップ資産全体にわたって大規模にバックアップを使用および管理できるようになります。

### <a name="intended-audience"></a>対象ユーザー

この記事の主な対象読者は、Azure の組み込みデータ保護テクノロジの機能、Azure Backup、デプロイをより厳重に保護するソリューションの効率的な実装方法などについて学習したい IT 管理者やアプリケーション管理者、および大規模企業や中小企業の実装者を対象としています。 この記事は、Azure のコア テクノロジとデータ保護の概念について熟知しており、バックアップ ソリューションの使用経験があることを前提としています。 この記事で説明されているガイダンスは、確立されたパターンを使用して Azure でのバックアップ ソリューションの設計を容易にし、既知の落とし穴を回避できるようにするものです。

### <a name="how-this-article-is-organized"></a>この記事の構成

Azure 上でインフラストラクチャとアプリケーションの保護を開始するのは簡単ですが、基になる Azure リソースが正しく設定され、最適に使用されていることを確認すると、価値実現までの時間を短縮できます。 この記事では、Azure Backup のデプロイを最適に構成するための設計上の考慮事項とガイダンスの概要について説明します。 コア コンポーネント (Recovery Services コンテナー、バックアップ ポリシーなど) と概念 (ガバナンスなど)、および詳細な製品ドキュメントへのリンクを使用してそれらやそれらの機能を評価する方法について詳しく見ていきます。

## <a name="architecture"></a>アーキテクチャ

![Azure Backup のアーキテクチャ](./media/guidance-best-practices/azure-backup-architecture.png)

### <a name="workloads"></a>ワークロード

Azure Backup では、さまざまなワークロード (オンプレミスとクラウド) のデータ保護が可能になります。 これは、Azure の安全で信頼性の高い組み込みのデータ保護メカニズムです。 管理のオーバーヘッドを発生させることなく、複数のワークロードにシームレスに保護を拡大できます。 これを有効にする自動化チャネルも複数あります (PowerShell、CLI、Azure Resource Manager テンプレート、REST API などを使用)。

* **スケーラブルで永続的な、セキュリティで保護されたストレージ -** Azure Backup では、組み込みのセキュリティおよび高可用性機能を備えた信頼性の高い BLOB ストレージを使用します。 バックアップ データとして、LRS、GRS、または RA-GRS ストレージを選択できます。  

* **ワークロードのネイティブ統合 -** Azure Backup では、エージェントのデプロイ、新しいスクリプトの作成、ストレージのプロビジョニングを行うための自動化やインフラストラクチャの管理を必要とせずに、Azure ワークロード (VM、SAP HANA、Azure VM 内の SQL、Azure Files など) とのネイティブ統合を実現します。

### <a name="data-plane"></a>データ プレーン

* **ストレージの自動管理** – Azure Backup では、バックアップ データのストレージ アカウントのプロビジョニングと管理を自動化することで、バックアップ データの増加に伴って規模を拡大できるようにします。

* **悪意のある削除からの保護 –** バックアップの論理的な削除によって、バックアップの誤削除や悪意のある削除の企てから保護します。 削除されたバックアップ データは 14 日間無料で保存され、この状態から復旧することができます。

* **セキュリティで保護された暗号化バックアップ -** Azure Backup を使用すると、Azure RBAC や暗号化などの Azure プラットフォームの組み込みのセキュリティ機能を活用して、バックアップ データを安全な方法で確実に格納できます。

* **バックアップ データのライフサイクル管理 -** Azure Backup では、保有期間ポリシーに準拠するように古いバックアップ データを自動的にクリーンアップします。 オペレーション ストレージからコンテナー ストレージにデータを階層化することもできます。

### <a name="management-plane"></a>管理プレーン

* **アクセスの制御** – コンテナー (Recovery Services コンテナーとバックアップ コンテナー) により、管理機能が提供されます。これには、Azure portal、バックアップ センター、コンテナー ダッシュボード、SDK、CLI、さらに REST API を使用してアクセスできます。 これは Azure RBAC の境界でもあり、バックアップへのアクセスを、承認されたバックアップ管理者のみに制限するオプションも用意されています。

* **ポリシー管理** – 各コンテナー内の Azure Backup ポリシーでは、バックアップをトリガーすべきタイミングやバックアップを保持する必要がある期間を定義します。 また、これらのポリシーを管理して、複数の項目に適用することもできます。

* **監視とレポート** – Azure Backup は Log Analytics と統合されており、Workbooks を使用してレポートを表示する機能も提供します。

* **スナップショット管理** – Azure Backup では、一部の Azure ネイティブ ワークロード (VM と Azure Files) のスナップショットを取得して管理し、それらのスナップショットからの高速復元を可能にします。 このオプションを使用すると、元のストレージにデータを回復する時間を大幅に短縮できます。

## <a name="vault-considerations"></a>コンテナーに関する考慮事項

Azure Backup では、コンテナー (Recovery Services コンテナーとバックアップ コンテナー) を使用して、バックアップを調整および管理しています。 また、コンテナーを使用してバックアップ データを格納しています。 有効なコンテナー設計によって、組織はビジネスの優先順位が維持されるように Azure のバックアップ資産を整理および管理するための構造を確立できます。 コンテナーを作成する場合は、次のガイドラインを考慮してください。  

### <a name="align-to-subscription-design-strategy"></a>サブスクリプションの設計戦略に合わせる

コンテナーはサブスクリプションにスコープ指定されているので、特定のアプリケーションやサービスに基づいて、またはアプリケーション アーキタイプに沿ってサブスクリプションが分けられる *アプリケーション カテゴリ戦略* などのサブスクリプション設計戦略を満たすように、コンテナーの設計を調整します。 詳細については、[こちらの記事](/azure/cloud-adoption-framework/decision-guides/subscriptions/)を参照してください。

### <a name="single-or-multiple-vault"></a>1 つまたは複数のコンテナー

1 つのコンテナーまたは複数のコンテナーを使用して、バックアップを整理および管理できます。 次のガイドラインを考慮してください。

* ワークロードがすべて 1 つのサブスクリプションと 1 つのリソースで管理されている場合は、1 つのコンテナーを使用してバックアップ資産を監視および管理できます。

* ワークロードが複数のサブスクリプションに分散している場合は、複数のコンテナー (サブスクリプションごとに 1 つまたは複数) を作成できます。
  * バックアップ センターでは、Backup に関連するすべてのタスクを 1 つのウィンドウで管理できます。 [こちら]()を参照してください。
  * ブック テンプレートを使用して、ビューをカスタマイズできます。 バックアップ エクスプローラーは、Azure VM 用のそのようなテンプレートの 1 つです。 [こちら](monitor-azure-backup-with-backup-explorer.md)を参照してください。
  * コンテナー間で一貫したポリシーが必要な場合は、Azure Policy を使用して、複数のコンテナーにバックアップ ポリシーを伝達できます。 ['deployifnotexists'](../governance/policy/concepts/effects.md#deployifnotexists) 効果を使用して複数のコンテナーにバックアップ ポリシーを伝達するカスタムの [Azure Policy 定義](../governance/policy/concepts/definition-structure.md)を作成できます。 この Azure Policy 定義を特定のスコープ (サブスクリプションまたは RG) に[割り当てる](../governance/policy/assign-policy-portal.md)こともでき、それによって Azure Policy 割り当てのスコープ内にあるすべての Recovery Services コンテナーに "バックアップ ポリシー" リソースがデプロイされます。 バックアップ ポリシーの設定 (バックアップ頻度、保有期間など) は、Azure Policy 割り当てのパラメーターとしてユーザーが指定する必要があります。

* 組織のフットプリントが増加するにつれ、次のような理由により、サブスクリプション間でワークロードを移動することが必要になる場合があります。バックアップ ポリシー別の配置、コンテナーの統合、コスト削減のための低い冗長性に基づいたトレードオフ (GRS から LRS への移行) です。  Azure Backup では、Recovery Services コンテナーを Azure のサブスクリプション間で移動することも、同じサブスクリプション内の別のリソース グループに移動することもできます。 [こちら](backup-azure-move-recovery-services-vault.md)を参照してください。

### <a name="review-default-settings"></a>既定の設定を確認する

コンテナーでバックアップを構成する前に、要件に合わせて [ストレージ レプリケーションの種類] と [セキュリティ設定] の既定の設定を確認してください。

* 既定では、 *[ストレージ レプリケーションの種類]* は geo 冗長 (GRS) に設定されています。 バックアップを構成すると、変更オプションは無効になります。 設定を確認および変更するには、[こちら](backup-create-rs-vault.md#set-storage-redundancy)の手順に従ってください。

* *[論理的な削除]* は、誤削除や悪意のある削除からバックアップ データを保護するために、新しく作成されたコンテナーでは既定で [有効] になっています。 設定を確認および変更するには、[こちら](backup-azure-security-feature-cloud.md#enabling-and-disabling-soft-delete)の手順に従ってください。

* *[リージョンをまたがる復元]* では、Azure VM をセカンダリ リージョン (Azure のペアになっているリージョン) に復元できます。 このオプションを使用すると、監査またはコンプライアンスの要件を満たす訓練や、プライマリ リージョンで障害が発生した場合に VM またはそのディスクを復元する訓練を実施できます。 CRR は、任意の GRS コンテナーのオプトイン機能です。 [こちら](backup-create-rs-vault.md#set-cross-region-restore)を参照してください。

* コンテナーの設計を終了する前に、[コンテナーのサポート マトリックス](backup-support-matrix.md#vault-support)を確認して、設計の選択肢に影響を与えたり、選択肢を制限したりする可能性のある要因を理解します。

## <a name="backup-policy-considerations"></a>バックアップ ポリシーに関する考慮事項

Azure バックアップ ポリシーには、次の 2 つのコンポーネントがあります。*スケジュール* (バックアップを作成するタイミング) と *保有期間* (バックアップを保持する期間) です。 このポリシーは、バックアップされるデータの種類、RTO/RPO の要件、運用または規制コンプライアンスのニーズ、ワークロードの種類 (VM、データベース、ファイルなど) に基づいて定義できます。 [こちら](backup-architecture.md#backup-policy-essentials)を参照してください。

バックアップ ポリシーを作成する場合は、次のガイドラインを考慮してください。

### <a name="schedule-considerations"></a>スケジュールに関する考慮事項

* 1 つのポリシー内でスケジュールの開始時刻、頻度、および保有期間の設定を同じにする必要がある VM をグループ化することを検討します。

* スケジュールされたバックアップ開始時刻がピーク時以外の実稼働アプリケーション時間内であることを確認します。

* バックアップ トラフィックを分散するには、異なる VM を一日の異なる時間帯にバックアップし、時間帯が重ならないようにすることを検討します。

### <a name="retention-considerations"></a>保有期間に関する考慮事項

* 短期保有には、"分" または "毎日" を使用できます。 "毎週"、"毎月"、または "毎年" のバックアップ ポイントに対するデータ保持は、長期保有と呼ばれます。

* 長期保有:
  * 計画済み (コンプライアンス要件) - 現在の時刻から数年後もデータが必要であることが事前にわかっている場合は、長期保有を使用します。
  * 計画外 (オンデマンド要件) - 事前にわからない場合は、特定のカスタム保有期間設定でオンデマンドを使用します (これらのカスタム保有期間設定は、ポリシー設定の影響を受けません)。

* カスタム保有期間によるオンデマンド バックアップ - バックアップ ポリシーでスケジュールされていないバックアップを作成する必要がある場合は、オンデマンド バックアップを使用できます。 これは、スケジュールされたバックアップに適合しないバックアップや、きめ細かいバックアップ (スケジュールされたバックアップでは 1 日に 1 回のバックアップしか許可されていないため、1 日に複数回行われる IaaS VM のバックアップなど) を作成する場合に役立つことがあります。 スケジュールされたポリシーで定義されている保有期間ポリシーは、オンデマンド バックアップには適用されないことに注意してください。

### <a name="optimize-backup-policy"></a>バックアップ ポリシーを最適化する

* ビジネス要件の変化に応じて、保有期間の延長または短縮が必要になる場合があります。 その場合、次のことが予想されます。  
  * リテンション期間が延長された場合、既存の復旧ポイントは、新しいポリシーに従ってマーキングおよび保持されます。
  * 保有期間が短縮された場合、復旧ポイントは、次回のクリーンアップ ジョブで排除対象としてマーキングされて、その後削除されます。
  * 保有期間の最新の規則は、すべての保有ポイント (オンデマンドの保有ポイントを除く) に適用されます。 そのため、保有期間が延長された場合 (100 日間など)、バックアップが作成され、その後に保有期間が短縮されると (100 日間から 7 日間に短縮されるなど)、すべてのバックアップ データは、最後に指定された保有期間 (つまり 7 日間) に従って保持されます。

* Azure Backup には、"*バックアップの保護と管理を停止する*" 柔軟性があります。
  * *保護を停止してバックアップ データを保持します*。 データ ソース (VM、アプリケーション) を廃止または使用停止にしていても、監査またはコンプライアンスのためにデータを保持する必要がある場合は、このオプションを使用して、今後のすべてのバックアップ ジョブによるデータ ソースの保護を停止し、バックアップ済みの復旧ポイントを保持できます。 その後、VM の保護を復元または再開できます。
  * *保護を停止してバックアップ データを削除します*。 このオプションでは、将来のすべてのバックアップ ジョブによる VM の保護を停止し、すべての復元ポイントを削除します。 VM を復元することも、[バックアップの再開] オプションを使用することもできなくなります。

  * (データを保持した状態で停止されたデータ ソースの) 保護を再開した場合は、保持ルールが適用されます。 期限切れの復旧ポイントは、(スケジュールされた時刻に) 削除されます。

* ポリシーの設計を完了する前に、設計の選択に影響する可能性がある次の要因に注意することが重要です。
  * バックアップ ポリシーのスコープはコンテナーです。
  * ポリシーあたりの項目数には制限があります (100 VM など)。 規模を拡大するには、同じスケジュールまたは異なるスケジュールで重複するポリシーを作成します。
  * 特定の復旧ポイントを選択して削除することはできません。
  * スケジュールされたバックアップを完全に無効にして、データ ソースを保護された状態に保つことはできません。 ポリシーを使用して構成できる最も頻度の低いバックアップは、週単位でスケジュールされたバックアップを 1 つ持つことです。 別の方法としては、データを保持して保護を停止し、バックアップを作成するたびに保護を有効にして、オンデマンド バックアップを作成した後で、保護をオフにしますが、バックアップ データは保持します。 [こちら](backup-azure-manage-vms.md#stop-protecting-a-vm)を参照してください。

## <a name="security-considerations"></a>セキュリティに関する考慮事項

バックアップ データを保護し、ビジネスのセキュリティ ニーズを満たせるように、Azure Backup では重要なデータやシステムの意図的な攻撃と悪用に備えて、機密性、整合性、および可用性を保証しています。 Azure Backup ソリューションのセキュリティに関する次のガイドラインを考慮してください。

### <a name="authentication-and-authorization"></a>認証と権限承認

* Azure のロールベースのアクセス制御 (Azure RBAC) を使用すると、アクセスをきめ細かく管理し、チーム内の職務を分離し、それぞれのジョブの実行に必要なアクセス権のみをユーザーに付与することができます。 [こちら](backup-rbac-rs-vault.md)を参照してください。

* Azure Backup では、バックアップの管理操作を制御する 3 つの組み込みロールが提供されます。バックアップ共同作成者、バックアップ オペレーター、およびバックアップ リーダーです。 [こちら](backup-rbac-rs-vault.md#mapping-backup-built-in-roles-to-backup-management-actions)を参照してください。

* Azure Backup には、セキュリティの脆弱性の防止、検出、および対処を行うための、サービスに組み込まれたセキュリティ コントロールがいくつかあります (詳細を表示)

* Recovery Services コンテナーによって使用されるストレージ アカウントは分離されており、悪意のある目的でユーザーがアクセスすることはできません。 アクセスが許可されるのは、復元などの Azure Backup 管理操作だけです。

### <a name="encryption-of-data-in-transit-and-at-rest"></a>転送中および保存中のデータの暗号化

暗号化によりお使いのデータが保護され、組織のセキュリティとコンプライアンスのコミットメントを満たすのに役立ちます。

* Azure 内では、Azure ストレージとコンテナー間を転送中のデータは HTTPS によって保護されます。 このデータは、Azure ネットワーク内に残されます。

* バックアップ データは、Microsoft マネージド キーを使用して自動的に暗号化されます。 あるいは、独自のキー ([カスタマー マネージド キー](encryption-at-rest-with-cmk.md)とも呼ばれる) を使用することもできます。

* Azure Backup では、OS またはデータ ディスクを Azure Disk Encryption (ADE) で暗号化している Azure VM のバックアップと復元をサポートしています。 [こちら](backup-azure-vms-encryption.md)を参照してください。

### <a name="protection-of-backup-data-from-unintentional-deletes"></a>意図しない削除からのバックアップ データの保護

Azure Backup には、削除後もバックアップ データを保護するためのセキュリティ機能が用意されています。 論理的な削除では、ユーザーが (VM、SQL Server データベース、Azure ファイル共有、SAP HANA データベースの) バックアップを削除した場合、バックアップ データは追加で 14 日間保持されるので、データを失うことなくそのバックアップ項目を回復できます。 バックアップ データが "論理的な削除" 状態にあるこの追加の 14 日間の保有期間中は、ユーザーへのコストは発生しません。 [こちら](backup-azure-security-feature-cloud.md)を参照してください。

### <a name="monitoring-and-alerts-of-suspicious-activity"></a>疑わしいアクティビティの監視とアラート

Azure Backup には、Azure Backup に関連するイベントのアクションを表示および構成する組み込みの監視とアラートの機能が用意されています。 [こちら](security-overview.md#monitoring-and-alerts-of-suspicious-activity)を参照してください。

### <a name="security-features-to-help-protect-hybrid-backups"></a>ハイブリッド バックアップを保護するためのセキュリティ機能

Azure Backup サービスは、Microsoft Azure Recovery Services (MARS) エージェントを使用して、ファイル、フォルダー、およびボリュームまたはシステム状態をオンプレミスのコンピューターから Azure にバックアップおよび復元します。 MARS では、次のようなセキュリティ機能が提供されるようになりました。Azure Backup にアップロードする前に暗号化され、Azure Backup からダウンロードした後に暗号化解除されるようにするためにパスフレーズを使用し、削除されたバックアップ データは削除日から追加で 14 日間保持され、重要な操作 ( パスフレーズの変更など) は有効な Azure 資格情報を持つユーザーのみが実行できます。 [こちら](backup-azure-security-feature.md)を参照してください。

## <a name="network-considerations"></a>ネットワークに関する考慮事項

Azure Backup では、ワークロードのデータを Recovery Services コンテナーに移動する必要があります。 Azure Backup には、バックアップ データの漏洩 (ネットワーク上での中間者攻撃など) を防ぐ機能がいくつか用意されています。 次のガイドラインを考慮してください。

### <a name="internet-connectivity"></a>インターネット接続

* *Azure VM バックアップ* - ストレージと Azure Backup サービス間の必要な通信やデータ転送はすべて Azure ネットワーク内で行われ、仮想ネットワークにアクセスする必要はありません。 そのため、セキュリティで保護されたネットワーク内に配置された Azure VM のバックアップでは、IP や FQDN へのアクセスを許可する必要がありません。

* *Azure VM 上の SAP HANA データベース、Azure VM 上の SQL Server データベース* - Azure Backup サービス、Azure Storage、Azure Active Directory への接続が必要です。 これは、プライベート エンドポイントを使用するか、必要なパブリック IP アドレスまたは FQDN へのアクセスを許可することによって実現できます。 必要な Azure サービスへの適切な接続を許可しないと、データベースの検出、バックアップの構成、バックアップの実行、データの復元などの操作の失敗につながる可能性があります。 NSG タグ、Azure Firewall、HTTP プロキシを使用しているときのネットワークの完全なガイダンスについては、これらの [SQL](backup-sql-server-database-azure-vms.md#establish-network-connectivity) と [SAP HANA](./backup-azure-sap-hana-database.md#establish-network-connectivity) の記事をご覧ください。

* *ハイブリッド* - MARS (Microsoft Azure Recovery Services) エージェントでは、すべての重要な操作 (インストール、構成、バックアップ、復元) にネットワーク アクセスが必要です。 MARS エージェントは、パブリック ピアリング (古い回線で使用可能) と Microsoft ピアリングを使用して [Azure ExpressRoute](install-mars-agent.md#azure-expressroute-support) 経由で、[プライベート エンドポイント](install-mars-agent.md#private-endpoint-support)を使用して、または[適切なアクセス制御によるプロキシ/ファイアウォール](install-mars-agent.md#verify-internet-access)経由で、Azure Backup サービスに接続できます。

### <a name="private-endpoints-for-azure-backup"></a>Azure Backup のプライベート エンドポイント

Azure [プライベート エンドポイント](../private-link/private-endpoint-overview.md)は、Azure Private Link を使用するサービスにプライベートかつ安全に接続するネットワーク インターフェイスです。 Azure Backup でプライベート エンドポイントを使用して、Recovery Services コンテナーから安全にデータをバックアップおよび復元できます。

* プライベート エンドポイントは、コンテナーに対して有効にした場合、Azure VM と MARS エージェントのバックアップにおける SQL および SAP HANA ワークロードのバックアップと復元にのみ使用されます。  コンテナーは、他のワークロードのバックアップにも使用できます (ただし、プライベート エンドポイントは必要ありません)。 SQL および SAP HANA ワークロードのバックアップと、MARS エージェントを使用したバックアップに加えて、Azure VM バックアップの場合に、プライベート エンドポイントを使用してファイルの復旧を実行することもできます。 [こちら](private-endpoints-overview.md#recommended-and-supported-scenarios)を参照してください。

* Azure Active Directory では、現在、プライベート エンドポイントがサポートされていません。 したがって、Azure Active Directory に必要な IP と FQDN には、Azure VM でのデータベースのバックアップおよび MARS エージェントを使用したバックアップを実行するときに、セキュリティで保護されたネットワークからの発信アクセスが許可される必要があります。 また、必要に応じて、NSG タグと Azure Firewall タグを使用して、Azure AD へのアクセスを許可することもできます。 前提条件の詳細については[こちら](./private-endpoints.md#before-you-start)を参照してください。

## <a name="governance-considerations"></a>ガバナンスに関する考慮事項

Azure におけるガバナンスは、主に [Azure Policy](../governance/policy/overview.md) と [Azure Cost Management](../cost-management-billing/cost-management-billing-overview.md) で実装されます。 [Azure Policy](../governance/policy/overview.md) を使用すると、ポリシーの定義を作成、割り当て、および管理して、お使いのリソースに規則を適用できます。 この機能によって、リソースを継続的に企業の標準に準拠させることができます。 [Azure Cost Management](../cost-management-billing/cost-management-billing-overview.md) では、クラウドの使用状況と、Azure リソースおよび他のクラウド プロバイダーに対する支出を追跡することができます。 また、[Azure Price Calculator](https://azure.microsoft.com/pricing/calculator/) や [Azure Advisor](../advisor/advisor-overview.md) などのツールは、コスト管理プロセスで重要な役割を果たします。

### <a name="azure-backup-support-two-key-scenarios-via-built-in-azure-policy"></a>Azure Backup で組み込みの Azure Policy を使用してサポートされる 2 つの主要なシナリオ

* 新しく作成されたビジネスに不可欠なマシンが、適切な保有期間設定で自動的にバックアップされるようにします。 Azure Backup には、サブスクリプションまたはリソース グループ内の指定された場所にあるすべての Azure VM に割り当てることができる組み込みのポリシー (Azure Policy を使用) が用意されています。 このポリシーが特定のスコープに割り当てられると、そのスコープ内に作成されたすべての新しい VM は、同じ場所およびサブスクリプション内の既存のコンテナーにバックアップするように自動的に構成されます。 ユーザーは、バックアップされた VM を関連付けるコンテナーと保有期間ポリシーを指定できます。 [こちら](backup-azure-auto-enable-backup.md)を参照してください。

* 新しく作成したコンテナーで、レポートをサポートするための診断が有効になっているようにします。 多くの場合、コンテナーごとに手動で診断設定を追加することは面倒な作業です。 また、作成された新しいコンテナーで、そのコンテナーのレポートを表示できるように診断設定を有効にする必要もあります。 (送信先として Log Analytics を指定した) 大規模な診断設定の作成を簡略化するために、組み込みの Azure Policy が Azure Backup に備わっています。 このポリシーにより、各サブスクリプションまたはリソース グループ内のすべてのコンテナーに LA の診断設定が追加されます。 次のセクションでは、このポリシーの使用方法について説明します。 [こちら](azure-policy-configure-diagnostics.md)を参照してください。

### <a name="azure-backup-cost-considerations"></a>Azure Backup のコストに関する考慮事項

Azure Backup サービスの機能には、コストを効果的に管理しながら、BCDR (事業継続とディザスター リカバリー) ビジネス要件も満たすことができる柔軟性が備わっています。 次のガイドラインを考慮してください。

* 料金計算ツールを使用すると、さまざまな手段を調整してコストを評価および最適化することができます。 [詳しくはこちらをご覧ください](azure-backup-pricing.md)

* バックアップ エクスプローラー:バックアップ エクスプローラーまたはバックアップ レポートを使用すると、バックアップ ストレージの拡大を把握し、最適化して、重要ではないワークロードや削除された VM のバックアップを停止できます。 バックアップの観点から、資産全体の集約ビューを取得できます。 これには、バックアップ項目に関する情報だけでなく、バックアップ用に構成されていないリソースも含まれています。 これにより、増大する資産に含まれている重要なデータの保護を欠かさずに実行できるようになり、バックアップは重要ではないワークロードや削除されたワークロードに合わせて最適化されます。

* バックアップ ポリシーを最適化する
  * ワークロード アーキタイプ (ミッション クリティカル、重要ではない、など) に基づいてスケジュールと保有期間の設定を最適化します
  * インスタント リストアの保有期間設定を最適化します
  * Azure Backup でワークロード別にサポートされているバックアップの種類 (完全、増分、ログ、差分) を考慮に入れながら、要件を満たすために適切なバックアップの種類を選択します。

* ディスクの選択的なバックアップ:ディスクの除外 (プレビュー機能) では、効果的かつコスト効率に優れた方法で重要なデータを選択的にバックアップできます。 たとえば、VM に接続されている残りのディスクをバックアップする必要がない場合は、1 つのディスクのみをバックアップします。 これは、バックアップ ソリューションが複数ある場合にも役立ちます。 たとえば、ワークロードのバックアップ ソリューション (Azure VM バックアップでは SQL Server データベース) を使用してデータベースまたはデータをバックアップし、選択したディスクに対して Azure VM レベルのバックアップを使用する場合に役立ちます。

* Azure Backup では、Azure VM のスナップショットを取得し、それらをディスクと共に格納することで、復旧ポイントの作成を促進し、復元操作を高速化します。 これはインスタント リストアと呼ばれます。 既定では、インスタント リストアのスナップショットは 2 日間保持されます。 この機能では、復元時間を削減して、これらのスナップショットから復元操作を行うことができます。 それにより、コンテナーからデータを変換して元の場所にコピーするために必要な時間が削減されます。 結果として、ストレージのコストはこの期間に取得されたスナップショットに対応したものになります。 [こちら](backup-instant-restore-capability.md#configure-snapshot-retention)を参照してください。

* 既定では、Azure Backup コンテナーの [ストレージ レプリケーションの種類] は geo 冗長 (GRS) に設定されています。 項目を保護した後にこのオプションを変更することはできません。 geo 冗長ストレージ (GRS) は、ローカル冗長ストレージ (LRS) よりもデータの持続性レベルが高いため、リージョンをまたがる復元の使用を選択でき、コストは高くなります。 低コストと高いデータ持続性とのトレードオフを確認し、シナリオに最適なものを決定します。 [詳しくはこちらをご覧ください](backup-create-rs-vault.md#set-storage-redundancy)

* VM 内で実行されているワークロードと VM 自体の両方を保護している場合は、この二重保護が必要かどうかを確認してください。

## <a name="monitoring-and-alerting-considerations"></a>監視とアラートに関する考慮事項

バックアップ ユーザーまたは管理者は、すべてのバックアップ ソリューションを監視し、重要なシナリオについて通知を受け取ることができます。 このセクションでは、Azure Backup サービスによって提供される監視と通知の機能について詳しく説明します。

### <a name="monitoring"></a>監視

* Azure Backup では、バックアップの構成、バックアップ、復元、バックアップの削除などの操作について、**組み込みのジョブ監視** を提供しています。 これはコンテナーを対象としており、1 つのコンテナーの監視に最適です。 [こちら](backup-azure-monitoring-built-in-monitor.md#backup-jobs-in-backup-center)を参照してください。

* 操作アクティビティを大規模に監視する必要がある場合は、**バックアップ エクスプローラー** によってバックアップ資産全体の集約ビューが提供され、詳細なドリルダウン分析やトラブルシューティングが可能になります。 これは、単一の一元化された場所を提供する組み込み型の Azure Monitor ブックであり、テナント、場所、サブスクリプション、リソース グループ、コンテナーにわたる Azure 上のバックアップ資産全体で操作アクティビティを監視するのに役立ちます。 [こちら](monitor-azure-backup-with-backup-explorer.md)を参照してください。
  * これを使用すると、バックアップ用に構成されていないリソースを特定し、増大する資産に含まれている重要なデータの保護を欠かさずに実行できるようになります。
  * ダッシュボードには、過去 7 日間 (最長) の操作アクティビティが表示されます。 このデータを保持する必要がある場合は、Excel ファイルとしてエクスポートして保持することができます。
  * Azure Lighthouse を使用している場合は、複数のテナントの情報を表示して、境界のない監視を有効にすることができます。

* 長期間にわたる操作アクティビティを保持して表示する必要がある場合は、**レポート** を使用します。 バックアップ管理者が一般的に求めるものは、長期間にわたるデータに基づいてバックアップに関する分析情報を得ることです。 このようなソリューションのユース ケースには、次のようなものがあります。
  * 使用されるクラウド ストレージの割り当てと予測。
  * バックアップおよび復元の監査。
  * さまざまな細分性レベルで主要な傾向を特定する。

* さらに、次の点も考慮する必要があります。
  * データ (ジョブ、ポリシーなど) を **Log Analytics** ワークスペースに送信できます。 これにより、Azure Monitor ログの機能が有効になり、データを Azure Monitor で収集されたその他の監視データと関連付けたり、複数の Azure サブスクリプションおよびテナントのログ エントリを 1 か所に統合して、まとめて分析できるようにしたり、ログ クエリを使用して複雑な分析を実行したり、ログ エントリに関する詳細な分析情報を取得したりすることができます。 [こちら](../azure-monitor/essentials/activity-log.md#send-to-log-analytics-workspace)を参照してください。
  * イベント ハブにデータを送信して、サードパーティの SIEM (セキュリティ情報イベント管理) やその他のログ分析ソリューションなど、Azure の外部にエントリを送信できます。 [こちら](../azure-monitor/essentials/activity-log.md#send-to-azure-event-hubs)を参照してください。
  * 監査、静的分析、またはバックアップのためにログ データを 90 日より長く保持する場合は、Azure ストレージ アカウントにデータを送信できます。 90 日以内でイベントを保持する必要があるだけの場合は、ストレージ アカウントへのアーカイブを設定する必要はありません (アクティビティ ログのイベントは Azure プラットフォームに 90 日間保持されるため)。 [詳細については、こちらを参照してください](../azure-monitor/essentials/activity-log.md#send-to-azure-storage)。

### <a name="alerting"></a>アラート

* アラートは主に、通知を受け取って関連アクションを実行するための方法です。 [バックアップ アラート] セクションに、Azure Backup サービスによって生成されたアラートが表示されます。

* Azure Backup には、エラー、警告、および重要な操作に対応した、電子メール経由での **組み込みのアラート** 通知メカニズムが備わっています。 アラートの生成時に通知を受け取る個別のメール アドレスや配布リストを指定できます。 また、それぞれのアラートについて個別に通知を受け取るか、アラートをまとめて 1 時間ごとのダイジェストとして通知を受け取るかを選択することもできます。
  * これらのアラートは、サービスによって定義され、制限付きのシナリオ (バックアップ/復元エラー、データを保持して保護を停止、データを削除して保護を停止など) のサポートを提供します。 [こちら](backup-azure-monitoring-built-in-monitor.md#alert-scenarios)を参照してください。
  * 破壊的な操作 (データを削除して保護を停止など) が実行されると、アラートが生成され、Recovery Services コンテナー用に通知が構成されて **いない** 場合でも、サブスクリプションの所有者、管理者、共同管理者にメールが送信されます。
  * 一部のワークロードでは、高頻度でエラーが発生することがあります (SQL Server では 15 分ごとなど)。 エラーが発生するたびに生成されるアラートに打ちのめされないようにするために、アラートは統合されます。 [こちら](backup-azure-monitoring-built-in-monitor.md#consolidated-alerts)を参照してください。
  * 組み込みのアラートはカスタマイズできず、Azure portal で定義されている電子メールに制限されます。

* (成功したジョブのアラートなど) **カスタム アラートを作成** する必要がある場合は、Log Analytics を使用します。 Azure Monitor では、Log Analytics ワークスペースで独自のアラートを作成できます。 ハイブリッド ワークロード (DPM/MABS) では、データを LA に送信し、LA を使用して、Azure Backup でサポートされているワークロード間で共通のアラートを提供することもできます。

* 組み込みの Recovery Services コンテナーの **アクティビティ ログ** を使用して通知を受け取ることもできます。 ただし、これは制限付きのシナリオをサポートしており、スケジュールされたバックアップなどの操作には適していません。この操作には、アクティビティ ログよりもリソース ログが適しています。 これらの制限事項と、Azure Backup で保護されているすべてのワークロードの大規模な監視とアラートに Log Analytics ワークスペースを使用する方法について詳しくは、こちらの[記事](backup-azure-monitoring-use-azuremonitor.md#using-log-analytics-to-monitor-at-scale)をご覧ください。

## <a name="next-steps"></a>次のステップ

Azure Backup を使用するための出発点として、次の記事を読むことをお勧めします。

* [Azure Backup の概要](backup-overview.md)
* [よく寄せられる質問](backup-azure-backup-faq.yml)
